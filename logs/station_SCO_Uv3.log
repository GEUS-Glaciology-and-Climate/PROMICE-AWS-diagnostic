2025-09-30 09:25:50,301 [INFO] AWS(config_file=../aws-l0//tx/config/SCO_Uv3.toml, inpath=../aws-l0//tx/, data_issues_repository=../PROMICE-AWS-data-issues, var_file=None, meta_file=None)
2025-09-30 09:25:50,756 [DEBUG] Source information: {'pypromice': '1.5.1', 'l0_config_file': 'SCO_Uv3.toml:016a28db7b1c6dc223642f5fa4e0a0249a3cdac3', 'l0_data_root': '016a28db7b1c6dc223642f5fa4e0a0249a3cdac3', 'data_issues': 'd1389d62adb1864056bb11f559d4785105b56943'}
2025-09-30 09:25:50,769 [INFO] Detected L0 file type 'csv_default' for ../aws-l0/tx/SCO_Uv3_300534063117350_1.txt
2025-09-30 09:25:50,862 [INFO] L0 data successfully loaded from SCO_Uv3_300534063117350_1.txt
2025-09-30 09:25:50,863 [INFO] Detected L0 file type 'csv_default' for ../aws-l0/tx/SCO_Uv3_300534063117350_2.txt
2025-09-30 09:25:50,902 [INFO] L0 data successfully loaded from SCO_Uv3_300534063117350_2.txt
2025-09-30 09:25:50,913 [INFO] Level 1 processing...
2025-09-30 09:25:51,064 [WARNING] bedrock attribute is not set
2025-09-30 09:25:51,350 [WARNING] bedrock attribute is not set
2025-09-30 09:25:51,612 [INFO] Level 2 processing...
2025-09-30 09:25:51,613 [INFO] Using file: ../PROMICE-AWS-data-issues/adjustments/SCO_Uv3.csv
2025-09-30 09:25:51,617 [INFO] Using file: ../PROMICE-AWS-data-issues/flags/SCO_Uv3.csv
2025-09-30 09:25:51,617 [INFO] No ../PROMICE-AWS-data-issues/flags/SCO_Uv3.csv file to read.
2025-09-30 09:25:51,619 [INFO] Using file: ../PROMICE-AWS-data-issues/adjustments/SCO_Uv3.csv
2025-09-30 09:25:51,642 [DEBUG] ---> None None p_u min_filter 750.0
2025-09-30 09:25:51,644 [DEBUG] ---> None None t_i_1 min_filter -30.0
2025-09-30 09:25:51,647 [DEBUG] ---> None None t_i_2 min_filter -30.0
2025-09-30 09:25:51,650 [DEBUG] ---> None None t_i_3 min_filter -30.0
2025-09-30 09:25:51,652 [DEBUG] ---> None None t_i_4 min_filter -30.0
2025-09-30 09:25:51,653 [DEBUG] ---> None None t_i_5 min_filter -30.0
2025-09-30 09:25:51,655 [DEBUG] ---> None None t_i_6 min_filter -30.0
2025-09-30 09:25:51,657 [DEBUG] ---> None None t_i_7 min_filter -30.0
2025-09-30 09:25:51,660 [DEBUG] ---> None None t_i_8 min_filter -30.0
2025-09-30 09:25:51,661 [DEBUG] ---> None None z_boom_u max_filter 2.46
2025-09-30 09:25:51,663 [DEBUG] ---> None None z_boom_u min_filter 1.8
2025-09-30 09:25:51,672 [DEBUG] Running persistence_qc using {'t_i': {'max_diff': 0.0001, 'period': 2}, 't_u': {'max_diff': 0.0001, 'period': 2}, 't_l': {'max_diff': 0.0001, 'period': 2}, 'p_i': {'max_diff': 0.0001, 'period': 3}, 'p_u': {'max_diff': 0.0001, 'period': 150}, 'p_l': {'max_diff': 0.0001, 'period': 150}, 'gps_lat_lon': {'max_diff': 1e-06, 'period': 6}, 'gps_alt': {'max_diff': 0.0001, 'period': 6}, 't_rad': {'max_diff': 0.0001, 'period': 2}, 'rh_i': {'max_diff': 0.0001, 'period': 2}, 'rh_u': {'max_diff': 0.0001, 'period': 2}, 'rh_l': {'max_diff': 0.0001, 'period': 2}, 'wspd_i': {'max_diff': 0.0001, 'period': 6}, 'wspd_u': {'max_diff': 0.0001, 'period': 6}, 'wspd_l': {'max_diff': 0.0001, 'period': 6}}
2025-09-30 09:25:51,675 [DEBUG] Applying persistent QC in t_i. Filtering 81/9837 samples
2025-09-30 09:25:51,678 [DEBUG] Applying persistent QC in t_u. Filtering 5/9837 samples
2025-09-30 09:25:51,686 [DEBUG] Applying persistent QC in p_i. Filtering 72/9837 samples
2025-09-30 09:25:51,769 [DEBUG] Applying persistent QC in p_u. Filtering 0/9837 samples
2025-09-30 09:25:51,784 [DEBUG] Applying persistent QC in gps_lat_lon. Filtering 0/9837 samples
2025-09-30 09:25:51,790 [DEBUG] Applying persistent QC in gps_alt. Filtering 0/9837 samples
2025-09-30 09:25:51,795 [DEBUG] Applying persistent QC in t_rad. Filtering 0/9837 samples
2025-09-30 09:25:51,799 [DEBUG] Applying persistent QC in rh_i. Filtering 18/9837 samples
2025-09-30 09:25:51,802 [DEBUG] Applying persistent QC in rh_u. Filtering 10/9837 samples
2025-09-30 09:25:51,811 [DEBUG] Applying persistent QC in wspd_i. Filtering 0/9837 samples
2025-09-30 09:25:51,821 [DEBUG] Applying persistent QC in wspd_u. Filtering 0/9837 samples
2025-09-30 09:25:52,275 [INFO] Resampling to 60min
2025-09-30 09:25:52,354 [INFO] Writing to files...
2025-09-30 09:25:52,923 [INFO] Written to L2_test/tx/SCO_Uv3/SCO_Uv3_hour.csv
2025-09-30 09:25:52,923 [INFO] Written to L2_test/tx/SCO_Uv3/SCO_Uv3_hour.nc
2025-09-30 09:25:52,923 [INFO] AWS(config_file=../aws-l0//raw/config/SCO_Uv3.toml, inpath=../aws-l0//raw/SCO_Uv3/, data_issues_repository=../PROMICE-AWS-data-issues, var_file=None, meta_file=None)
2025-09-30 09:25:53,266 [DEBUG] Source information: {'pypromice': '1.5.1', 'l0_config_file': 'SCO_Uv3.toml:016a28db7b1c6dc223642f5fa4e0a0249a3cdac3', 'l0_data_root': '016a28db7b1c6dc223642f5fa4e0a0249a3cdac3', 'data_issues': 'd1389d62adb1864056bb11f559d4785105b56943'}
2025-09-30 09:25:53,274 [INFO] Detected L0 file type 'toa5' for ../aws-l0/raw/SCO_Uv3/SCO_Uv3_2025_raw.dat
2025-09-30 09:25:53,387 [INFO] Detected L0 file type 'toa5' for ../aws-l0/raw/SCO_Uv3/SCO_Uv3_2025_raw.dat
2025-09-30 09:25:53,559 [INFO] L0 data successfully loaded from SCO_Uv3_2025_raw.dat
2025-09-30 09:25:53,569 [INFO] Level 1 processing...
2025-09-30 09:25:53,692 [WARNING] bedrock attribute is not set
2025-09-30 09:25:53,830 [INFO] Level 2 processing...
2025-09-30 09:25:53,833 [INFO] Using file: ../PROMICE-AWS-data-issues/adjustments/SCO_Uv3.csv
2025-09-30 09:25:53,836 [INFO] Using file: ../PROMICE-AWS-data-issues/flags/SCO_Uv3.csv
2025-09-30 09:25:53,836 [INFO] No ../PROMICE-AWS-data-issues/flags/SCO_Uv3.csv file to read.
2025-09-30 09:25:53,839 [INFO] Using file: ../PROMICE-AWS-data-issues/adjustments/SCO_Uv3.csv
2025-09-30 09:25:53,853 [DEBUG] ---> None None p_u min_filter 750.0
2025-09-30 09:25:53,855 [DEBUG] ---> None None t_i_1 min_filter -30.0
2025-09-30 09:25:53,857 [DEBUG] ---> None None t_i_2 min_filter -30.0
2025-09-30 09:25:53,858 [DEBUG] ---> None None t_i_3 min_filter -30.0
2025-09-30 09:25:53,859 [DEBUG] ---> None None t_i_4 min_filter -30.0
2025-09-30 09:25:53,861 [DEBUG] ---> None None t_i_5 min_filter -30.0
2025-09-30 09:25:53,862 [DEBUG] ---> None None t_i_6 min_filter -30.0
2025-09-30 09:25:53,863 [DEBUG] ---> None None t_i_7 min_filter -30.0
2025-09-30 09:25:53,865 [DEBUG] ---> None None t_i_8 min_filter -30.0
2025-09-30 09:25:53,866 [DEBUG] ---> None None z_boom_u max_filter 2.46
2025-09-30 09:25:53,867 [DEBUG] ---> None None z_boom_u min_filter 1.8
2025-09-30 09:25:53,874 [DEBUG] Running persistence_qc using {'t_i': {'max_diff': 0.0001, 'period': 2}, 't_u': {'max_diff': 0.0001, 'period': 2}, 't_l': {'max_diff': 0.0001, 'period': 2}, 'p_i': {'max_diff': 0.0001, 'period': 3}, 'p_u': {'max_diff': 0.0001, 'period': 150}, 'p_l': {'max_diff': 0.0001, 'period': 150}, 'gps_lat_lon': {'max_diff': 1e-06, 'period': 6}, 'gps_alt': {'max_diff': 0.0001, 'period': 6}, 't_rad': {'max_diff': 0.0001, 'period': 2}, 'rh_i': {'max_diff': 0.0001, 'period': 2}, 'rh_u': {'max_diff': 0.0001, 'period': 2}, 'rh_l': {'max_diff': 0.0001, 'period': 2}, 'wspd_i': {'max_diff': 0.0001, 'period': 6}, 'wspd_u': {'max_diff': 0.0001, 'period': 6}, 'wspd_l': {'max_diff': 0.0001, 'period': 6}}
2025-09-30 09:25:53,877 [DEBUG] Applying persistent QC in t_i. Filtering 0/44059 samples
2025-09-30 09:25:53,881 [DEBUG] Applying persistent QC in t_u. Filtering 7/44059 samples
2025-09-30 09:25:53,885 [DEBUG] Applying persistent QC in p_i. Filtering 0/44059 samples
2025-09-30 09:25:53,954 [DEBUG] Applying persistent QC in p_u. Filtering 0/44059 samples
2025-09-30 09:25:53,965 [DEBUG] Applying persistent QC in gps_lat_lon. Filtering 0/44059 samples
2025-09-30 09:25:53,972 [DEBUG] Applying persistent QC in gps_alt. Filtering 0/44059 samples
2025-09-30 09:25:53,975 [DEBUG] Applying persistent QC in t_rad. Filtering 0/44059 samples
2025-09-30 09:25:53,979 [DEBUG] Applying persistent QC in rh_i. Filtering 0/44059 samples
2025-09-30 09:25:53,983 [DEBUG] Applying persistent QC in rh_u. Filtering 0/44059 samples
2025-09-30 09:25:53,989 [DEBUG] Applying persistent QC in wspd_i. Filtering 0/44059 samples
2025-09-30 09:25:53,995 [DEBUG] Applying persistent QC in wspd_u. Filtering 0/44059 samples
2025-09-30 09:25:54,389 [INFO] Resampling to 10min
2025-09-30 09:25:54,480 [INFO] Writing to files...
2025-09-30 09:25:55,508 [INFO] Written to L2_test/raw/SCO_Uv3/SCO_Uv3_10min.csv
2025-09-30 09:25:55,508 [INFO] Written to L2_test/raw/SCO_Uv3/SCO_Uv3_10min.nc
2025-09-30 09:25:55,629 [INFO] Resampling to 60min
2025-09-30 09:25:55,694 [INFO] Writing to files...
2025-09-30 09:25:55,988 [INFO] Written to L2_test/raw/SCO_Uv3/SCO_Uv3_hour.csv
2025-09-30 09:25:55,988 [INFO] Written to L2_test/raw/SCO_Uv3/SCO_Uv3_hour.nc
2025-09-30 09:25:56,033 [DEBUG] Could not import boto3, continuing with reduced functionality.
2025-09-30 09:25:56,034 [DEBUG] GDAL data found in package: path='/home/bav/miniforge3/lib/python3.12/site-packages/rasterio/gdal_data'.
2025-09-30 09:25:56,034 [DEBUG] PROJ data found in package: path='/home/bav/miniforge3/lib/python3.12/site-packages/rasterio/proj_data'.
2025-09-30 09:25:56,114 [INFO] SCO_Uv3 array loaded from L2_test/raw/SCO_Uv3/SCO_Uv3_hour.nc
2025-09-30 09:25:56,147 [INFO] SCO_Uv3 array loaded from L2_test/tx/SCO_Uv3/SCO_Uv3_hour.nc
2025-09-30 09:25:56,147 [INFO] Combining L2_test/raw/SCO_Uv3/SCO_Uv3_hour.nc with L2_test/tx/SCO_Uv3/SCO_Uv3_hour.nc...
2025-09-30 09:25:56,234 [INFO] Writing to files...
2025-09-30 09:25:56,617 [INFO] Written to L2_test/level_2/SCO_Uv3/SCO_Uv3_hour.csv
2025-09-30 09:25:56,617 [INFO] Written to L2_test/level_2/SCO_Uv3/SCO_Uv3_hour.nc
2025-09-30 09:25:56,617 [INFO] Files saved to L2_test/level_2/SCO_Uv3...
2025-09-30 09:25:56,660 [WARNING] data_issues_path is missing. Using default data issues path: ../PROMICE-AWS-data-issues
2025-09-30 09:25:56,947 [INFO] processing gps_lat without relocation
2025-09-30 09:25:56,950 [INFO] processing gps_lon without relocation
2025-09-30 09:25:56,953 [INFO] processing gps_alt without relocation
2025-09-30 09:25:56,965 [INFO] Using file: ../PROMICE-AWS-data-issues/adjustments/SCO_Uv3.csv
2025-09-30 09:25:56,978 [INFO] Combining surface height
2025-09-30 09:25:56,979 [INFO] -> ablation site
2025-09-30 09:25:57,028 [DEBUG] -> estimating ablation period for each year
2025-09-30 09:25:57,030 [DEBUG] 2024 derived from z_ice_surf
2025-09-30 09:25:57,030 [DEBUG] 2025 derived from z_ice_surf
2025-09-30 09:25:57,031 [DEBUG] 2024: Ablation from 2024-08-17 00:00:00 to 2024-08-31 12:00:00
2025-09-30 09:25:57,037 [DEBUG] adjusting z to hs1
2025-09-30 09:25:57,038 [DEBUG] adjusting hs2 to z
2025-09-30 09:25:57,038 [DEBUG] using end of melt season
2025-09-30 09:25:57,040 [DEBUG] adjusting hs1
2025-09-30 09:25:57,040 [DEBUG] to hs2, minimizing winter difference
2025-09-30 09:25:57,042 [DEBUG] 2025: Ablation from 2025-06-04 14:00:00 to 2025-09-28 12:00:00
2025-09-30 09:25:57,048 [DEBUG] adjusting hs2 to z
/home/bav/pypromice/src/pypromice/pipeline/L2toL3.py:620: RuntimeWarning: Mean of empty slice
  if ~np.isnan(np.nanmean(hs2.iloc[(ind_end[i]-24*7):(ind_end[i]+24*30)])):
2025-09-30 09:25:57,051 [DEBUG] adjusting hs1
2025-09-30 09:25:57,051 [DEBUG] to z
2025-09-30 09:25:57,051 [DEBUG] using end of melt season
2025-09-30 09:25:57,063 [INFO] surface height combination finished
2025-09-30 09:25:57,086 [INFO] Calculating thermistor depth
2025-09-30 09:25:57,091 [INFO] No maintenance at SCO_Uv3
2025-09-30 09:25:57,099 [INFO] interpolating 10 m firn/ice temperature (on hourly values)
2025-09-30 09:25:58,822 [INFO] Resampling to 60min
2025-09-30 09:25:58,907 [INFO] Writing to files...
2025-09-30 09:25:59,245 [INFO] Written to L3_test/stations/SCO_Uv3/SCO_Uv3_hour.csv
2025-09-30 09:25:59,246 [INFO] Written to L3_test/stations/SCO_Uv3/SCO_Uv3_hour.nc
2025-09-30 09:25:59,282 [INFO] Resampling to 1D
2025-09-30 09:25:59,360 [INFO] Writing to files...
2025-09-30 09:25:59,427 [INFO] Written to L3_test/stations/SCO_Uv3/SCO_Uv3_day.csv
2025-09-30 09:25:59,427 [INFO] Written to L3_test/stations/SCO_Uv3/SCO_Uv3_day.nc
2025-09-30 09:25:59,465 [INFO] Resampling to ME
2025-09-30 09:25:59,542 [INFO] Writing to files...
2025-09-30 09:25:59,598 [INFO] Written to L3_test/stations/SCO_Uv3/SCO_Uv3_month.csv
2025-09-30 09:25:59,598 [INFO] Written to L3_test/stations/SCO_Uv3/SCO_Uv3_month.nc
/n ======== test join_l3 ========= 

SCO_Uv3

 ======== test get_l2 ========= 


 ======== test join_l2 ========= 


 ======== test l2tol3 ========= 

