2025-09-30 09:28:53,954 [INFO] AWS(config_file=../aws-l0//tx/config/WEG_B.toml, inpath=../aws-l0//tx/, data_issues_repository=../PROMICE-AWS-data-issues, var_file=None, meta_file=None)
2025-09-30 09:28:54,380 [DEBUG] Source information: {'pypromice': '1.5.1', 'l0_config_file': 'WEG_B.toml:016a28db7b1c6dc223642f5fa4e0a0249a3cdac3', 'l0_data_root': '016a28db7b1c6dc223642f5fa4e0a0249a3cdac3', 'data_issues': 'd1389d62adb1864056bb11f559d4785105b56943'}
2025-09-30 09:28:54,395 [INFO] Detected L0 file type 'csv_default' for ../aws-l0/tx/WEG_B_300534060529310_1.txt
2025-09-30 09:28:54,441 [INFO] L0 data successfully loaded from WEG_B_300534060529310_1.txt
2025-09-30 09:28:54,447 [INFO] Detected L0 file type 'csv_default' for ../aws-l0/tx/WEG_B_300534063815810_2.txt
2025-09-30 09:28:54,523 [INFO] L0 data successfully loaded from WEG_B_300534063815810_2.txt
2025-09-30 09:28:54,524 [INFO] Detected L0 file type 'csv_default' for ../aws-l0/tx/WEG_B_300234065157600_3.txt
2025-09-30 09:28:54,556 [INFO] L0 data successfully loaded from WEG_B_300234065157600_3.txt
2025-09-30 09:28:54,581 [INFO] Level 1 processing...
2025-09-30 09:28:55,123 [INFO] Level 2 processing...
2025-09-30 09:28:55,125 [INFO] Using file: ../PROMICE-AWS-data-issues/adjustments/WEG_B.csv
2025-09-30 09:28:55,125 [INFO] No ../PROMICE-AWS-data-issues/adjustments/WEG_B.csv file to read.
2025-09-30 09:28:55,126 [INFO] Using file: ../PROMICE-AWS-data-issues/flags/WEG_B.csv
2025-09-30 09:28:55,126 [INFO] No ../PROMICE-AWS-data-issues/flags/WEG_B.csv file to read.
2025-09-30 09:28:55,129 [INFO] Using file: ../PROMICE-AWS-data-issues/adjustments/WEG_B.csv
2025-09-30 09:28:55,129 [INFO] No ../PROMICE-AWS-data-issues/adjustments/WEG_B.csv file to read.
2025-09-30 09:28:55,136 [DEBUG] Running persistence_qc using {'t_i': {'max_diff': 0.0001, 'period': 2}, 't_u': {'max_diff': 0.0001, 'period': 2}, 't_l': {'max_diff': 0.0001, 'period': 2}, 'p_i': {'max_diff': 0.0001, 'period': 3}, 'p_u': {'max_diff': 0.0001, 'period': 150}, 'p_l': {'max_diff': 0.0001, 'period': 150}, 'gps_lat_lon': {'max_diff': 1e-06, 'period': 6}, 'gps_alt': {'max_diff': 0.0001, 'period': 6}, 't_rad': {'max_diff': 0.0001, 'period': 2}, 'rh_i': {'max_diff': 0.0001, 'period': 2}, 'rh_u': {'max_diff': 0.0001, 'period': 2}, 'rh_l': {'max_diff': 0.0001, 'period': 2}, 'wspd_i': {'max_diff': 0.0001, 'period': 6}, 'wspd_u': {'max_diff': 0.0001, 'period': 6}, 'wspd_l': {'max_diff': 0.0001, 'period': 6}}
2025-09-30 09:28:55,140 [DEBUG] Applying persistent QC in t_i. Filtering 869/22120 samples
2025-09-30 09:28:55,143 [DEBUG] Applying persistent QC in t_u. Filtering 97/22120 samples
2025-09-30 09:28:55,146 [DEBUG] Applying persistent QC in p_i. Filtering 296/22120 samples
2025-09-30 09:28:55,209 [DEBUG] Applying persistent QC in p_u. Filtering 0/22120 samples
2025-09-30 09:28:55,218 [DEBUG] Applying persistent QC in gps_lat_lon. Filtering 34/22120 samples
2025-09-30 09:28:55,224 [DEBUG] Applying persistent QC in gps_alt. Filtering 34/22120 samples
2025-09-30 09:28:55,226 [DEBUG] Applying persistent QC in t_rad. Filtering 16/22120 samples
2025-09-30 09:28:55,230 [DEBUG] Applying persistent QC in rh_i. Filtering 209/22120 samples
2025-09-30 09:28:55,233 [DEBUG] Applying persistent QC in rh_u. Filtering 54/22120 samples
2025-09-30 09:28:55,239 [DEBUG] Applying persistent QC in wspd_i. Filtering 65/22120 samples
2025-09-30 09:28:55,245 [DEBUG] Applying persistent QC in wspd_u. Filtering 29/22120 samples
2025-09-30 09:28:55,763 [INFO] Resampling to 60min
2025-09-30 09:28:55,842 [INFO] Writing to files...
2025-09-30 09:28:56,727 [INFO] Written to L2_test/tx/WEG_B/WEG_B_hour.csv
2025-09-30 09:28:56,728 [INFO] Written to L2_test/tx/WEG_B/WEG_B_hour.nc
2025-09-30 09:28:56,729 [INFO] AWS(config_file=../aws-l0//raw/config/WEG_B.toml, inpath=../aws-l0//raw/WEG_B/, data_issues_repository=../PROMICE-AWS-data-issues, var_file=None, meta_file=None)
2025-09-30 09:28:57,037 [DEBUG] Source information: {'pypromice': '1.5.1', 'l0_config_file': 'WEG_B.toml:016a28db7b1c6dc223642f5fa4e0a0249a3cdac3', 'l0_data_root': '016a28db7b1c6dc223642f5fa4e0a0249a3cdac3', 'data_issues': 'd1389d62adb1864056bb11f559d4785105b56943'}
2025-09-30 09:28:58,318 [INFO] Detected L0 file type 'toa5' for ../aws-l0/raw/WEG_B/WEG_B_2022_raw.txt
2025-09-30 09:28:58,370 [INFO] Detected L0 file type 'toa5' for ../aws-l0/raw/WEG_B/WEG_B_2022_raw.txt
2025-09-30 09:28:58,491 [INFO] L0 data successfully loaded from WEG_B_2022_raw.txt
2025-09-30 09:28:58,494 [INFO] Detected L0 file type 'toa5' for ../aws-l0/raw/WEG_B/WEG_B_2024_raw.txt
2025-09-30 09:28:58,585 [INFO] Detected L0 file type 'toa5' for ../aws-l0/raw/WEG_B/WEG_B_2024_raw.txt
2025-09-30 09:28:58,763 [INFO] L0 data successfully loaded from WEG_B_2024_raw.txt
2025-09-30 09:28:58,999 [INFO] Detected L0 file type 'toa5' for ../aws-l0/raw/WEG_B/WEG_B_2025_DataTable60min.dat
2025-09-30 09:28:59,008 [INFO] Detected L0 file type 'toa5' for ../aws-l0/raw/WEG_B/WEG_B_2025_DataTable60min.dat
2025-09-30 09:28:59,041 [INFO] L0 data successfully loaded from WEG_B_2025_DataTable60min.dat
2025-09-30 09:28:59,057 [INFO] Level 1 processing...
2025-09-30 09:28:59,142 [INFO] Warning: Non-null data for z_pt at a bedrock site
2025-09-30 09:28:59,316 [INFO] Warning: Non-null data for z_pt at a bedrock site
2025-09-30 09:28:59,469 [INFO] Warning: Non-null data for z_pt at a bedrock site
2025-09-30 09:28:59,677 [INFO] Level 2 processing...
2025-09-30 09:28:59,704 [INFO] Using file: ../PROMICE-AWS-data-issues/adjustments/WEG_B.csv
2025-09-30 09:28:59,705 [INFO] No ../PROMICE-AWS-data-issues/adjustments/WEG_B.csv file to read.
2025-09-30 09:28:59,727 [INFO] Using file: ../PROMICE-AWS-data-issues/flags/WEG_B.csv
2025-09-30 09:28:59,728 [INFO] No ../PROMICE-AWS-data-issues/flags/WEG_B.csv file to read.
2025-09-30 09:28:59,749 [INFO] Using file: ../PROMICE-AWS-data-issues/adjustments/WEG_B.csv
2025-09-30 09:28:59,749 [INFO] No ../PROMICE-AWS-data-issues/adjustments/WEG_B.csv file to read.
2025-09-30 09:28:59,775 [DEBUG] Running persistence_qc using {'t_i': {'max_diff': 0.0001, 'period': 2}, 't_u': {'max_diff': 0.0001, 'period': 2}, 't_l': {'max_diff': 0.0001, 'period': 2}, 'p_i': {'max_diff': 0.0001, 'period': 3}, 'p_u': {'max_diff': 0.0001, 'period': 150}, 'p_l': {'max_diff': 0.0001, 'period': 150}, 'gps_lat_lon': {'max_diff': 1e-06, 'period': 6}, 'gps_alt': {'max_diff': 0.0001, 'period': 6}, 't_rad': {'max_diff': 0.0001, 'period': 2}, 'rh_i': {'max_diff': 0.0001, 'period': 2}, 'rh_u': {'max_diff': 0.0001, 'period': 2}, 'rh_l': {'max_diff': 0.0001, 'period': 2}, 'wspd_i': {'max_diff': 0.0001, 'period': 6}, 'wspd_u': {'max_diff': 0.0001, 'period': 6}, 'wspd_l': {'max_diff': 0.0001, 'period': 6}}
2025-09-30 09:28:59,779 [DEBUG] Applying persistent QC in t_i. Filtering 121/91081 samples
2025-09-30 09:28:59,785 [DEBUG] Applying persistent QC in t_u. Filtering 23/91081 samples
2025-09-30 09:28:59,790 [DEBUG] Applying persistent QC in p_i. Filtering 39/91081 samples
2025-09-30 09:28:59,853 [DEBUG] Applying persistent QC in p_u. Filtering 0/91081 samples
2025-09-30 09:28:59,865 [DEBUG] Applying persistent QC in gps_lat_lon. Filtering 1/91081 samples
2025-09-30 09:28:59,872 [DEBUG] Applying persistent QC in gps_alt. Filtering 0/91081 samples
2025-09-30 09:28:59,877 [DEBUG] Applying persistent QC in t_rad. Filtering 4/91081 samples
2025-09-30 09:28:59,882 [DEBUG] Applying persistent QC in rh_i. Filtering 4/91081 samples
2025-09-30 09:28:59,886 [DEBUG] Applying persistent QC in rh_u. Filtering 2/91081 samples
2025-09-30 09:28:59,893 [DEBUG] Applying persistent QC in wspd_i. Filtering 73/91081 samples
2025-09-30 09:28:59,899 [DEBUG] Applying persistent QC in wspd_u. Filtering 250/91081 samples
2025-09-30 09:29:00,261 [WARNING] Dropping column 'msg_i' because it is of type 'object' and contains unique values: [nan '!S']
2025-09-30 09:29:00,526 [INFO] Resampling to 10min
2025-09-30 09:29:00,669 [INFO] Writing to files...
2025-09-30 09:29:03,538 [INFO] Written to L2_test/raw/WEG_B/WEG_B_10min.csv
2025-09-30 09:29:03,538 [INFO] Written to L2_test/raw/WEG_B/WEG_B_10min.nc
2025-09-30 09:29:03,575 [WARNING] Dropping column 'msg_i' because it is of type 'object' and contains unique values: [nan '!S']
2025-09-30 09:29:03,799 [INFO] Resampling to 60min
2025-09-30 09:29:03,881 [INFO] Writing to files...
2025-09-30 09:29:04,563 [INFO] Written to L2_test/raw/WEG_B/WEG_B_hour.csv
2025-09-30 09:29:04,563 [INFO] Written to L2_test/raw/WEG_B/WEG_B_hour.nc
2025-09-30 09:29:04,610 [DEBUG] Could not import boto3, continuing with reduced functionality.
2025-09-30 09:29:04,610 [DEBUG] GDAL data found in package: path='/home/bav/miniforge3/lib/python3.12/site-packages/rasterio/gdal_data'.
2025-09-30 09:29:04,610 [DEBUG] PROJ data found in package: path='/home/bav/miniforge3/lib/python3.12/site-packages/rasterio/proj_data'.
2025-09-30 09:29:04,698 [INFO] WEG_B array loaded from L2_test/raw/WEG_B/WEG_B_hour.nc
2025-09-30 09:29:04,731 [INFO] WEG_B array loaded from L2_test/tx/WEG_B/WEG_B_hour.nc
2025-09-30 09:29:04,731 [INFO] Combining L2_test/raw/WEG_B/WEG_B_hour.nc with L2_test/tx/WEG_B/WEG_B_hour.nc...
2025-09-30 09:29:04,834 [INFO] Writing to files...
2025-09-30 09:29:05,572 [INFO] Written to L2_test/level_2/WEG_B/WEG_B_hour.csv
2025-09-30 09:29:05,572 [INFO] Written to L2_test/level_2/WEG_B/WEG_B_hour.nc
2025-09-30 09:29:05,573 [INFO] Files saved to L2_test/level_2/WEG_B...
2025-09-30 09:29:05,613 [WARNING] data_issues_path is missing. Using default data issues path: ../PROMICE-AWS-data-issues
2025-09-30 09:29:05,625 [INFO] processing gps_lat without relocation
2025-09-30 09:29:05,629 [INFO] processing gps_lon without relocation
2025-09-30 09:29:05,632 [INFO] processing gps_alt without relocation
2025-09-30 09:29:05,643 [INFO] Using file: ../PROMICE-AWS-data-issues/adjustments/WEG_B.csv
2025-09-30 09:29:05,643 [INFO] No ../PROMICE-AWS-data-issues/adjustments/WEG_B.csv file to read.
2025-09-30 09:29:05,644 [INFO] Combining surface height
2025-09-30 09:29:05,644 [INFO] -> did not find z_ice_surf
2025-09-30 09:29:05,644 [INFO] -> no z_pt or accumulation site: averaging z_surf_1 and z_surf_2
2025-09-30 09:29:05,768 [INFO] Resampling to 60min
2025-09-30 09:29:05,853 [INFO] Writing to files...
2025-09-30 09:29:06,550 [INFO] Written to L3_test/stations/WEG_B/WEG_B_hour.csv
2025-09-30 09:29:06,550 [INFO] Written to L3_test/stations/WEG_B/WEG_B_hour.nc
2025-09-30 09:29:06,607 [INFO] Resampling to 1D
2025-09-30 09:29:06,685 [INFO] Writing to files...
2025-09-30 09:29:06,780 [INFO] Written to L3_test/stations/WEG_B/WEG_B_day.csv
2025-09-30 09:29:06,780 [INFO] Written to L3_test/stations/WEG_B/WEG_B_day.nc
2025-09-30 09:29:06,836 [INFO] Resampling to ME
2025-09-30 09:29:06,912 [INFO] Writing to files...
2025-09-30 09:29:06,967 [INFO] Written to L3_test/stations/WEG_B/WEG_B_month.csv
2025-09-30 09:29:06,967 [INFO] Written to L3_test/stations/WEG_B/WEG_B_month.nc
/n ======== test join_l3 ========= 

WEG_B

 ======== test get_l2 ========= 


 ======== test join_l2 ========= 


 ======== test l2tol3 ========= 

