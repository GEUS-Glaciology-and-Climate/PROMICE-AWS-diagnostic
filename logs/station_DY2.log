2025-09-30 09:18:25,216 [INFO] AWS(config_file=../aws-l0//tx/config/DY2.toml, inpath=../aws-l0//tx/, data_issues_repository=../PROMICE-AWS-data-issues, var_file=None, meta_file=None)
2025-09-30 09:18:25,525 [DEBUG] Source information: {'pypromice': '1.5.1', 'l0_config_file': 'DY2.toml:016a28db7b1c6dc223642f5fa4e0a0249a3cdac3', 'l0_data_root': '016a28db7b1c6dc223642f5fa4e0a0249a3cdac3', 'data_issues': 'd1389d62adb1864056bb11f559d4785105b56943'}
2025-09-30 09:18:25,526 [INFO] Detected L0 file type 'csv_default' for ../aws-l0/tx/DY2_300534063811780_1.txt
2025-09-30 09:18:25,613 [INFO] L0 data successfully loaded from DY2_300534063811780_1.txt
2025-09-30 09:18:25,616 [INFO] Level 1 processing...
2025-09-30 09:18:25,744 [WARNING] bedrock attribute is not set
2025-09-30 09:18:25,868 [INFO] Level 2 processing...
2025-09-30 09:18:25,870 [INFO] Using file: ../PROMICE-AWS-data-issues/adjustments/DY2.csv
2025-09-30 09:18:25,873 [INFO] Using file: ../PROMICE-AWS-data-issues/flags/DY2.csv
2025-09-30 09:18:25,879 [DEBUG] ---> flagging 2023-11-20 02:00:00 2024-05-27 00:00:00 t_i_1
2025-09-30 09:18:25,881 [DEBUG] ---> flagging 2023-11-20 02:00:00 2024-05-27 00:00:00 t_i_2
2025-09-30 09:18:25,883 [DEBUG] ---> flagging 2023-11-20 02:00:00 2024-05-27 00:00:00 t_i_3
2025-09-30 09:18:25,884 [DEBUG] ---> flagging 2023-11-20 02:00:00 2024-05-27 00:00:00 t_i_4
2025-09-30 09:18:25,886 [DEBUG] ---> flagging 2023-11-20 02:00:00 2024-05-27 00:00:00 t_i_5
2025-09-30 09:18:25,888 [DEBUG] ---> flagging 2023-11-20 02:00:00 2024-05-27 00:00:00 t_i_6
2025-09-30 09:18:25,890 [DEBUG] ---> flagging 2023-11-20 02:00:00 2024-05-27 00:00:00 t_i_7
2025-09-30 09:18:25,891 [DEBUG] ---> flagging 2023-11-20 02:00:00 2024-05-27 00:00:00 t_i_8
2025-09-30 09:18:25,893 [DEBUG] ---> flagging 2023-11-20 02:00:00 2024-05-27 00:00:00 t_i_9
2025-09-30 09:18:25,895 [DEBUG] ---> flagging 2023-11-20 02:00:00 2024-05-27 00:00:00 t_i_10
2025-09-30 09:18:25,896 [DEBUG] ---> flagging 2023-11-20 02:00:00 2024-05-27 00:00:00 t_i_11
2025-09-30 09:18:25,899 [INFO] Using file: ../PROMICE-AWS-data-issues/adjustments/DY2.csv
2025-09-30 09:18:25,916 [DEBUG] ---> None None t_i_1 min_filter -30.0
2025-09-30 09:18:25,917 [DEBUG] ---> None None t_i_10 min_filter -30.0
2025-09-30 09:18:25,919 [DEBUG] ---> None None t_i_11 min_filter -30.0
2025-09-30 09:18:25,920 [DEBUG] ---> None None t_i_2 min_filter -30.0
2025-09-30 09:18:25,921 [DEBUG] ---> None None t_i_3 min_filter -30.0
2025-09-30 09:18:25,922 [DEBUG] ---> None None t_i_4 min_filter -30.0
2025-09-30 09:18:25,924 [DEBUG] ---> None None t_i_5 min_filter -30.0
2025-09-30 09:18:25,925 [DEBUG] ---> None None t_i_6 min_filter -30.0
2025-09-30 09:18:25,926 [DEBUG] ---> None None t_i_7 min_filter -30.0
2025-09-30 09:18:25,927 [DEBUG] ---> None None t_i_8 min_filter -30.0
2025-09-30 09:18:25,929 [DEBUG] ---> None None t_i_9 min_filter -30.0
2025-09-30 09:18:25,929 [INFO] could not adjust z_surf_1 not in dataset
2025-09-30 09:18:25,929 [INFO] could not adjust z_surf_2 not in dataset
2025-09-30 09:18:25,936 [DEBUG] Running persistence_qc using {'t_i': {'max_diff': 0.0001, 'period': 2}, 't_u': {'max_diff': 0.0001, 'period': 2}, 't_l': {'max_diff': 0.0001, 'period': 2}, 'p_i': {'max_diff': 0.0001, 'period': 3}, 'p_u': {'max_diff': 0.0001, 'period': 150}, 'p_l': {'max_diff': 0.0001, 'period': 150}, 'gps_lat_lon': {'max_diff': 1e-06, 'period': 6}, 'gps_alt': {'max_diff': 0.0001, 'period': 6}, 't_rad': {'max_diff': 0.0001, 'period': 2}, 'rh_i': {'max_diff': 0.0001, 'period': 2}, 'rh_u': {'max_diff': 0.0001, 'period': 2}, 'rh_l': {'max_diff': 0.0001, 'period': 2}, 'wspd_i': {'max_diff': 0.0001, 'period': 6}, 'wspd_u': {'max_diff': 0.0001, 'period': 6}, 'wspd_l': {'max_diff': 0.0001, 'period': 6}}
2025-09-30 09:18:25,939 [DEBUG] Applying persistent QC in t_i. Filtering 174/11883 samples
2025-09-30 09:18:25,942 [DEBUG] Applying persistent QC in t_u. Filtering 10/11883 samples
2025-09-30 09:18:25,945 [DEBUG] Applying persistent QC in t_l. Filtering 11/11883 samples
2025-09-30 09:18:25,948 [DEBUG] Applying persistent QC in p_i. Filtering 158/11883 samples
2025-09-30 09:18:26,009 [DEBUG] Applying persistent QC in p_u. Filtering 0/11883 samples
2025-09-30 09:18:26,071 [DEBUG] Applying persistent QC in p_l. Filtering 0/11883 samples
2025-09-30 09:18:26,080 [DEBUG] Applying persistent QC in gps_lat_lon. Filtering 0/11883 samples
2025-09-30 09:18:26,084 [DEBUG] Applying persistent QC in gps_alt. Filtering 0/11883 samples
2025-09-30 09:18:26,087 [DEBUG] Applying persistent QC in t_rad. Filtering 5/11883 samples
2025-09-30 09:18:26,089 [DEBUG] Applying persistent QC in rh_i. Filtering 113/11883 samples
2025-09-30 09:18:26,091 [DEBUG] Applying persistent QC in rh_u. Filtering 112/11883 samples
2025-09-30 09:18:26,093 [DEBUG] Applying persistent QC in rh_l. Filtering 96/11883 samples
2025-09-30 09:18:26,098 [DEBUG] Applying persistent QC in wspd_i. Filtering 0/11883 samples
2025-09-30 09:18:26,103 [DEBUG] Applying persistent QC in wspd_u. Filtering 0/11883 samples
2025-09-30 09:18:26,107 [DEBUG] Applying persistent QC in wspd_l. Filtering 0/11883 samples
2025-09-30 09:18:26,620 [INFO] Resampling to 60min
2025-09-30 09:18:26,732 [INFO] Writing to files...
2025-09-30 09:18:27,390 [INFO] Written to L2_test/tx/DY2/DY2_hour.csv
2025-09-30 09:18:27,390 [INFO] Written to L2_test/tx/DY2/DY2_hour.nc
2025-09-30 09:18:27,391 [INFO] AWS(config_file=../aws-l0//raw/config/DY2.toml, inpath=../aws-l0//raw/DY2/, data_issues_repository=../PROMICE-AWS-data-issues, var_file=None, meta_file=None)
2025-09-30 09:18:27,740 [DEBUG] Source information: {'pypromice': '1.5.1', 'l0_config_file': 'DY2.toml:016a28db7b1c6dc223642f5fa4e0a0249a3cdac3', 'l0_data_root': '016a28db7b1c6dc223642f5fa4e0a0249a3cdac3', 'data_issues': 'd1389d62adb1864056bb11f559d4785105b56943'}
2025-09-30 09:18:27,742 [INFO] Detected L0 file type 'toa5' for ../aws-l0/raw/DY2/DY2_2023_raw.txt
2025-09-30 09:18:27,876 [INFO] Detected L0 file type 'toa5' for ../aws-l0/raw/DY2/DY2_2023_raw.txt
2025-09-30 09:18:28,216 [INFO] L0 data successfully loaded from DY2_2023_raw.txt
2025-09-30 09:18:28,216 [INFO] Detected L0 file type 'toa5' for ../aws-l0/raw/DY2/DY2_2024_raw.txt
2025-09-30 09:18:28,335 [INFO] Detected L0 file type 'toa5' for ../aws-l0/raw/DY2/DY2_2024_raw.txt
2025-09-30 09:18:28,612 [INFO] L0 data successfully loaded from DY2_2024_raw.txt
2025-09-30 09:18:28,612 [INFO] Detected L0 file type 'toa5' for ../aws-l0/raw/DY2/DY2_2025_raw.txt
2025-09-30 09:18:28,712 [INFO] Detected L0 file type 'toa5' for ../aws-l0/raw/DY2/DY2_2025_raw.txt
2025-09-30 09:18:28,951 [INFO] L0 data successfully loaded from DY2_2025_raw.txt
2025-09-30 09:18:28,966 [INFO] Level 1 processing...
2025-09-30 09:18:29,088 [WARNING] bedrock attribute is not set
2025-09-30 09:18:29,300 [WARNING] bedrock attribute is not set
2025-09-30 09:18:29,539 [WARNING] bedrock attribute is not set
2025-09-30 09:18:29,896 [INFO] Level 2 processing...
2025-09-30 09:18:29,903 [INFO] Using file: ../PROMICE-AWS-data-issues/adjustments/DY2.csv
2025-09-30 09:18:29,912 [INFO] Using file: ../PROMICE-AWS-data-issues/flags/DY2.csv
2025-09-30 09:18:29,918 [DEBUG] ---> flagging 2023-11-20 02:00:00 2024-05-27 00:00:00 t_i_1
2025-09-30 09:18:29,920 [DEBUG] ---> flagging 2023-11-20 02:00:00 2024-05-27 00:00:00 t_i_2
2025-09-30 09:18:29,922 [DEBUG] ---> flagging 2023-11-20 02:00:00 2024-05-27 00:00:00 t_i_3
2025-09-30 09:18:29,924 [DEBUG] ---> flagging 2023-11-20 02:00:00 2024-05-27 00:00:00 t_i_4
2025-09-30 09:18:29,926 [DEBUG] ---> flagging 2023-11-20 02:00:00 2024-05-27 00:00:00 t_i_5
2025-09-30 09:18:29,928 [DEBUG] ---> flagging 2023-11-20 02:00:00 2024-05-27 00:00:00 t_i_6
2025-09-30 09:18:29,930 [DEBUG] ---> flagging 2023-11-20 02:00:00 2024-05-27 00:00:00 t_i_7
2025-09-30 09:18:29,932 [DEBUG] ---> flagging 2023-11-20 02:00:00 2024-05-27 00:00:00 t_i_8
2025-09-30 09:18:29,934 [DEBUG] ---> flagging 2023-11-20 02:00:00 2024-05-27 00:00:00 t_i_9
2025-09-30 09:18:29,936 [DEBUG] ---> flagging 2023-11-20 02:00:00 2024-05-27 00:00:00 t_i_10
2025-09-30 09:18:29,938 [DEBUG] ---> flagging 2023-11-20 02:00:00 2024-05-27 00:00:00 t_i_11
2025-09-30 09:18:29,947 [INFO] Using file: ../PROMICE-AWS-data-issues/adjustments/DY2.csv
2025-09-30 09:18:29,961 [DEBUG] ---> None None t_i_1 min_filter -30.0
2025-09-30 09:18:29,962 [DEBUG] ---> None None t_i_10 min_filter -30.0
2025-09-30 09:18:29,963 [DEBUG] ---> None None t_i_11 min_filter -30.0
2025-09-30 09:18:29,965 [DEBUG] ---> None None t_i_2 min_filter -30.0
2025-09-30 09:18:29,966 [DEBUG] ---> None None t_i_3 min_filter -30.0
2025-09-30 09:18:29,968 [DEBUG] ---> None None t_i_4 min_filter -30.0
2025-09-30 09:18:29,970 [DEBUG] ---> None None t_i_5 min_filter -30.0
2025-09-30 09:18:29,971 [DEBUG] ---> None None t_i_6 min_filter -30.0
2025-09-30 09:18:29,972 [DEBUG] ---> None None t_i_7 min_filter -30.0
2025-09-30 09:18:29,974 [DEBUG] ---> None None t_i_8 min_filter -30.0
2025-09-30 09:18:29,975 [DEBUG] ---> None None t_i_9 min_filter -30.0
2025-09-30 09:18:29,976 [INFO] could not adjust z_surf_1 not in dataset
2025-09-30 09:18:29,976 [INFO] could not adjust z_surf_2 not in dataset
2025-09-30 09:18:29,995 [DEBUG] Running persistence_qc using {'t_i': {'max_diff': 0.0001, 'period': 2}, 't_u': {'max_diff': 0.0001, 'period': 2}, 't_l': {'max_diff': 0.0001, 'period': 2}, 'p_i': {'max_diff': 0.0001, 'period': 3}, 'p_u': {'max_diff': 0.0001, 'period': 150}, 'p_l': {'max_diff': 0.0001, 'period': 150}, 'gps_lat_lon': {'max_diff': 1e-06, 'period': 6}, 'gps_alt': {'max_diff': 0.0001, 'period': 6}, 't_rad': {'max_diff': 0.0001, 'period': 2}, 'rh_i': {'max_diff': 0.0001, 'period': 2}, 'rh_u': {'max_diff': 0.0001, 'period': 2}, 'rh_l': {'max_diff': 0.0001, 'period': 2}, 'wspd_i': {'max_diff': 0.0001, 'period': 6}, 'wspd_u': {'max_diff': 0.0001, 'period': 6}, 'wspd_l': {'max_diff': 0.0001, 'period': 6}}
2025-09-30 09:18:30,002 [DEBUG] Applying persistent QC in t_i. Filtering 0/152737 samples
2025-09-30 09:18:30,009 [DEBUG] Applying persistent QC in t_u. Filtering 107/152737 samples
2025-09-30 09:18:30,016 [DEBUG] Applying persistent QC in t_l. Filtering 73/152737 samples
2025-09-30 09:18:30,023 [DEBUG] Applying persistent QC in p_i. Filtering 0/152737 samples
2025-09-30 09:18:30,112 [DEBUG] Applying persistent QC in p_u. Filtering 0/152737 samples
2025-09-30 09:18:30,203 [DEBUG] Applying persistent QC in p_l. Filtering 0/152737 samples
2025-09-30 09:18:30,220 [DEBUG] Applying persistent QC in gps_lat_lon. Filtering 0/152737 samples
2025-09-30 09:18:30,229 [DEBUG] Applying persistent QC in gps_alt. Filtering 24/152737 samples
2025-09-30 09:18:30,236 [DEBUG] Applying persistent QC in t_rad. Filtering 0/152737 samples
2025-09-30 09:18:30,243 [DEBUG] Applying persistent QC in rh_i. Filtering 0/152737 samples
2025-09-30 09:18:30,250 [DEBUG] Applying persistent QC in rh_u. Filtering 16/152737 samples
2025-09-30 09:18:30,257 [DEBUG] Applying persistent QC in rh_l. Filtering 11/152737 samples
2025-09-30 09:18:30,266 [DEBUG] Applying persistent QC in wspd_i. Filtering 0/152737 samples
2025-09-30 09:18:30,275 [DEBUG] Applying persistent QC in wspd_u. Filtering 142/152737 samples
2025-09-30 09:18:30,284 [DEBUG] Applying persistent QC in wspd_l. Filtering 281/152737 samples
2025-09-30 09:18:31,247 [INFO] Resampling to 10min
2025-09-30 09:18:31,417 [INFO] Writing to files...
2025-09-30 09:18:36,970 [INFO] Written to L2_test/raw/DY2/DY2_10min.csv
2025-09-30 09:18:36,970 [INFO] Written to L2_test/raw/DY2/DY2_10min.nc
2025-09-30 09:18:37,294 [INFO] Resampling to 60min
2025-09-30 09:18:37,384 [INFO] Writing to files...
2025-09-30 09:18:38,496 [INFO] Written to L2_test/raw/DY2/DY2_hour.csv
2025-09-30 09:18:38,496 [INFO] Written to L2_test/raw/DY2/DY2_hour.nc
2025-09-30 09:18:38,544 [DEBUG] Could not import boto3, continuing with reduced functionality.
2025-09-30 09:18:38,545 [DEBUG] GDAL data found in package: path='/home/bav/miniforge3/lib/python3.12/site-packages/rasterio/gdal_data'.
2025-09-30 09:18:38,545 [DEBUG] PROJ data found in package: path='/home/bav/miniforge3/lib/python3.12/site-packages/rasterio/proj_data'.
2025-09-30 09:18:38,643 [INFO] DY2 array loaded from L2_test/raw/DY2/DY2_hour.nc
2025-09-30 09:18:38,678 [INFO] DY2 array loaded from L2_test/tx/DY2/DY2_hour.nc
2025-09-30 09:18:38,678 [INFO] Combining L2_test/raw/DY2/DY2_hour.nc with L2_test/tx/DY2/DY2_hour.nc...
2025-09-30 09:18:38,802 [INFO] Writing to files...
2025-09-30 09:18:40,068 [INFO] Written to L2_test/level_2/DY2/DY2_hour.csv
2025-09-30 09:18:40,068 [INFO] Written to L2_test/level_2/DY2/DY2_hour.nc
2025-09-30 09:18:40,068 [INFO] Files saved to L2_test/level_2/DY2...
2025-09-30 09:18:40,109 [WARNING] data_issues_path is missing. Using default data issues path: ../PROMICE-AWS-data-issues
2025-09-30 09:18:43,917 [INFO] processing gps_lat without relocation
2025-09-30 09:18:43,921 [INFO] processing gps_lon without relocation
2025-09-30 09:18:43,925 [INFO] processing gps_alt without relocation
2025-09-30 09:18:43,941 [INFO] Using file: ../PROMICE-AWS-data-issues/adjustments/DY2.csv
2025-09-30 09:18:43,956 [DEBUG] ---> 2023-06-14 17:00:00 None z_surf_1 add 1.5
2025-09-30 09:18:43,957 [DEBUG] ---> 2025-05-12 19:00:00 None z_surf_1 add 1.25
2025-09-30 09:18:43,959 [DEBUG] ---> 2023-06-14 17:00:00 None z_surf_2 add 1.5
2025-09-30 09:18:43,960 [DEBUG] ---> 2025-05-12 19:00:00 None z_surf_2 add 1.3
2025-09-30 09:18:43,961 [INFO] Combining surface height
2025-09-30 09:18:43,962 [INFO] -> did not find z_ice_surf
2025-09-30 09:18:43,962 [INFO] -> no z_pt or accumulation site: averaging z_surf_1 and z_surf_2
2025-09-30 09:18:44,022 [INFO] Calculating thermistor depth
2025-09-30 09:18:44,061 [INFO] interpolating 10 m firn/ice temperature (on hourly values)
2025-09-30 09:18:48,457 [INFO] Resampling to 60min
2025-09-30 09:18:48,582 [INFO] Writing to files...
2025-09-30 09:18:49,670 [INFO] Written to L3_test/stations/DY2/DY2_hour.csv
2025-09-30 09:18:49,670 [INFO] Written to L3_test/stations/DY2/DY2_hour.nc
2025-09-30 09:18:49,738 [INFO] Resampling to 1D
2025-09-30 09:18:49,844 [INFO] Writing to files...
2025-09-30 09:18:49,950 [INFO] Written to L3_test/stations/DY2/DY2_day.csv
2025-09-30 09:18:49,950 [INFO] Written to L3_test/stations/DY2/DY2_day.nc
2025-09-30 09:18:50,021 [INFO] Resampling to ME
2025-09-30 09:18:50,124 [INFO] Writing to files...
2025-09-30 09:18:50,186 [INFO] Written to L3_test/stations/DY2/DY2_month.csv
2025-09-30 09:18:50,186 [INFO] Written to L3_test/stations/DY2/DY2_month.nc
/n ======== test join_l3 ========= 

DY2

 ======== test get_l2 ========= 


 ======== test join_l2 ========= 


 ======== test l2tol3 ========= 

