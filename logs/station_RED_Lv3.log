2025-09-30 09:25:50,082 [INFO] AWS(config_file=../aws-l0//tx/config/RED_Lv3.toml, inpath=../aws-l0//tx/, data_issues_repository=../PROMICE-AWS-data-issues, var_file=None, meta_file=None)
2025-09-30 09:25:50,426 [DEBUG] Source information: {'pypromice': '1.5.1', 'l0_config_file': 'RED_Lv3.toml:016a28db7b1c6dc223642f5fa4e0a0249a3cdac3', 'l0_data_root': '016a28db7b1c6dc223642f5fa4e0a0249a3cdac3', 'data_issues': 'd1389d62adb1864056bb11f559d4785105b56943'}
2025-09-30 09:25:50,432 [INFO] Detected L0 file type 'csv_default' for ../aws-l0/tx/RED_Lv3_300234066318240_1.txt
2025-09-30 09:25:50,539 [INFO] L0 data successfully loaded from RED_Lv3_300234066318240_1.txt
2025-09-30 09:25:50,547 [INFO] Level 1 processing...
2025-09-30 09:25:50,699 [WARNING] bedrock attribute is not set
2025-09-30 09:25:50,884 [INFO] Level 2 processing...
2025-09-30 09:25:50,887 [INFO] Using file: ../PROMICE-AWS-data-issues/adjustments/RED_Lv3.csv
2025-09-30 09:25:50,891 [INFO] Using file: ../PROMICE-AWS-data-issues/flags/RED_Lv3.csv
2025-09-30 09:25:50,895 [DEBUG] ---> flagging 2024-08-11T16:00:00.000000000 2025-09-28T12:00:00.000000000 z_pt_cor
2025-09-30 09:25:50,898 [INFO] Using file: ../PROMICE-AWS-data-issues/adjustments/RED_Lv3.csv
2025-09-30 09:25:50,909 [DEBUG] ---> None None z_boom_u max_filter 2.5
2025-09-30 09:25:50,910 [DEBUG] ---> None None z_boom_u min_filter 1.5
2025-09-30 09:25:50,917 [DEBUG] ---> None 2025-09-01 00:00:00 z_pt_cor max_filter 9.07
2025-09-30 09:25:50,918 [DEBUG] ---> None 2025-09-01 00:00:00 z_pt_cor min_filter 8.8
2025-09-30 09:25:50,920 [DEBUG] ---> None None z_stake max_filter 2.0
2025-09-30 09:25:50,932 [DEBUG] Running persistence_qc using {'t_i': {'max_diff': 0.0001, 'period': 2}, 't_u': {'max_diff': 0.0001, 'period': 2}, 't_l': {'max_diff': 0.0001, 'period': 2}, 'p_i': {'max_diff': 0.0001, 'period': 3}, 'p_u': {'max_diff': 0.0001, 'period': 150}, 'p_l': {'max_diff': 0.0001, 'period': 150}, 'gps_lat_lon': {'max_diff': 1e-06, 'period': 6}, 'gps_alt': {'max_diff': 0.0001, 'period': 6}, 't_rad': {'max_diff': 0.0001, 'period': 2}, 'rh_i': {'max_diff': 0.0001, 'period': 2}, 'rh_u': {'max_diff': 0.0001, 'period': 2}, 'rh_l': {'max_diff': 0.0001, 'period': 2}, 'wspd_i': {'max_diff': 0.0001, 'period': 6}, 'wspd_u': {'max_diff': 0.0001, 'period': 6}, 'wspd_l': {'max_diff': 0.0001, 'period': 6}}
2025-09-30 09:25:50,938 [DEBUG] Applying persistent QC in t_i. Filtering 167/9834 samples
2025-09-30 09:25:50,941 [DEBUG] Applying persistent QC in t_u. Filtering 11/9834 samples
2025-09-30 09:25:50,947 [DEBUG] Applying persistent QC in p_i. Filtering 86/9834 samples
2025-09-30 09:25:51,037 [DEBUG] Applying persistent QC in p_u. Filtering 0/9834 samples
2025-09-30 09:25:51,045 [DEBUG] Applying persistent QC in gps_lat_lon. Filtering 10/9834 samples
2025-09-30 09:25:51,050 [DEBUG] Applying persistent QC in gps_alt. Filtering 10/9834 samples
2025-09-30 09:25:51,056 [DEBUG] Applying persistent QC in t_rad. Filtering 0/9834 samples
2025-09-30 09:25:51,059 [DEBUG] Applying persistent QC in rh_i. Filtering 18/9834 samples
2025-09-30 09:25:51,061 [DEBUG] Applying persistent QC in rh_u. Filtering 26/9834 samples
2025-09-30 09:25:51,068 [DEBUG] Applying persistent QC in wspd_i. Filtering 10/9834 samples
2025-09-30 09:25:51,076 [DEBUG] Applying persistent QC in wspd_u. Filtering 0/9834 samples
2025-09-30 09:25:51,396 [INFO] Resampling to 60min
2025-09-30 09:25:51,468 [INFO] Writing to files...
2025-09-30 09:25:51,888 [INFO] Written to L2_test/tx/RED_Lv3/RED_Lv3_hour.csv
2025-09-30 09:25:51,888 [INFO] Written to L2_test/tx/RED_Lv3/RED_Lv3_hour.nc
2025-09-30 09:25:51,978 [DEBUG] Could not import boto3, continuing with reduced functionality.
2025-09-30 09:25:51,979 [DEBUG] GDAL data found in package: path='/home/bav/miniforge3/lib/python3.12/site-packages/rasterio/gdal_data'.
2025-09-30 09:25:51,979 [DEBUG] PROJ data found in package: path='/home/bav/miniforge3/lib/python3.12/site-packages/rasterio/proj_data'.
2025-09-30 09:25:52,072 [INFO] RED_Lv3 array loaded from L2_test/tx/RED_Lv3/RED_Lv3_hour.nc
2025-09-30 09:25:52,072 [INFO] Only one file found L2_test/tx/RED_Lv3/RED_Lv3_hour.nc...
2025-09-30 09:25:52,168 [INFO] Writing to files...
2025-09-30 09:25:52,663 [INFO] Written to L2_test/level_2/RED_Lv3/RED_Lv3_hour.csv
2025-09-30 09:25:52,664 [INFO] Written to L2_test/level_2/RED_Lv3/RED_Lv3_hour.nc
2025-09-30 09:25:52,664 [INFO] Files saved to L2_test/level_2/RED_Lv3...
2025-09-30 09:25:52,709 [WARNING] data_issues_path is missing. Using default data issues path: ../PROMICE-AWS-data-issues
2025-09-30 09:25:54,516 [INFO] processing gps_lat without relocation
2025-09-30 09:25:54,520 [INFO] processing gps_lon without relocation
2025-09-30 09:25:54,522 [INFO] processing gps_alt without relocation
2025-09-30 09:25:54,534 [INFO] Using file: ../PROMICE-AWS-data-issues/adjustments/RED_Lv3.csv
2025-09-30 09:25:54,541 [INFO] Combining surface height
2025-09-30 09:25:54,542 [INFO] -> ablation site
2025-09-30 09:25:54,576 [DEBUG] -> estimating ablation period for each year
2025-09-30 09:25:54,577 [DEBUG] 2024 no z_ice_surf, just using JJA
2025-09-30 09:25:54,578 [DEBUG] 2025 no z_ice_surf, just using JJA
2025-09-30 09:25:54,579 [DEBUG] 2024: Ablation from 2024-08-11 16:00:00 to 2024-08-31 23:00:00
2025-09-30 09:25:54,586 [DEBUG] adjusting hs1
2025-09-30 09:25:54,586 [DEBUG] to hs2, minimizing winter difference
2025-09-30 09:25:54,587 [DEBUG] 2025: Ablation from 2025-06-01 00:00:00 to 2025-08-31 23:00:00
2025-09-30 09:25:54,594 [DEBUG] adjusting hs1
2025-09-30 09:25:54,594 [DEBUG] to hs2, minimizing winter difference
2025-09-30 09:25:54,601 [INFO] surface height combination finished
2025-09-30 09:25:54,621 [INFO] Calculating thermistor depth
2025-09-30 09:25:54,626 [INFO] No maintenance at RED_Lv3
2025-09-30 09:25:54,633 [INFO] interpolating 10 m firn/ice temperature (on hourly values)
2025-09-30 09:25:55,834 [INFO] Resampling to 60min
2025-09-30 09:25:55,921 [INFO] Writing to files...
2025-09-30 09:25:56,374 [INFO] Written to L3_test/stations/RED_Lv3/RED_Lv3_hour.csv
2025-09-30 09:25:56,375 [INFO] Written to L3_test/stations/RED_Lv3/RED_Lv3_hour.nc
2025-09-30 09:25:56,419 [INFO] Resampling to 1D
2025-09-30 09:25:56,507 [INFO] Writing to files...
2025-09-30 09:25:56,632 [INFO] Written to L3_test/stations/RED_Lv3/RED_Lv3_day.csv
2025-09-30 09:25:56,632 [INFO] Written to L3_test/stations/RED_Lv3/RED_Lv3_day.nc
2025-09-30 09:25:56,680 [INFO] Resampling to ME
2025-09-30 09:25:56,758 [INFO] Writing to files...
2025-09-30 09:25:56,845 [INFO] Written to L3_test/stations/RED_Lv3/RED_Lv3_month.csv
2025-09-30 09:25:56,845 [INFO] Written to L3_test/stations/RED_Lv3/RED_Lv3_month.nc
/n ======== test join_l3 ========= 

RED_Lv3

 ======== test get_l2 ========= 


 ======== test join_l2 ========= 


 ======== test l2tol3 ========= 

