2025-09-30 09:27:51,040 [INFO] AWS(config_file=../aws-l0//tx/config/THU_L2.toml, inpath=../aws-l0//tx/, data_issues_repository=../PROMICE-AWS-data-issues, var_file=None, meta_file=None)
2025-09-30 09:27:51,424 [DEBUG] Source information: {'pypromice': '1.5.1', 'l0_config_file': 'THU_L2.toml:016a28db7b1c6dc223642f5fa4e0a0249a3cdac3', 'l0_data_root': '016a28db7b1c6dc223642f5fa4e0a0249a3cdac3', 'data_issues': 'd1389d62adb1864056bb11f559d4785105b56943'}
2025-09-30 09:27:51,431 [INFO] Detected L0 file type 'csv_default' for ../aws-l0/tx/THU_L2_300234065158630_1.txt
2025-09-30 09:27:51,477 [INFO] L0 data successfully loaded from THU_L2_300234065158630_1.txt
2025-09-30 09:27:51,485 [INFO] Level 1 processing...
2025-09-30 09:27:51,607 [WARNING] bedrock attribute is not set
2025-09-30 09:27:51,760 [INFO] Level 2 processing...
2025-09-30 09:27:51,762 [INFO] Using file: ../PROMICE-AWS-data-issues/adjustments/THU_L2.csv
2025-09-30 09:27:51,769 [INFO] Using file: ../PROMICE-AWS-data-issues/flags/THU_L2.csv
2025-09-30 09:27:51,769 [INFO] No ../PROMICE-AWS-data-issues/flags/THU_L2.csv file to read.
2025-09-30 09:27:51,769 [INFO] Using file: ../PROMICE-AWS-data-issues/adjustments/THU_L2.csv
2025-09-30 09:27:51,788 [DEBUG] ---> None None t_i_1 min_filter -40.0
2025-09-30 09:27:51,789 [DEBUG] ---> None None t_i_2 min_filter -40.0
2025-09-30 09:27:51,790 [DEBUG] ---> None None t_i_3 min_filter -40.0
2025-09-30 09:27:51,793 [DEBUG] ---> None None t_i_4 min_filter -40.0
2025-09-30 09:27:51,795 [DEBUG] ---> None None t_i_5 min_filter -40.0
2025-09-30 09:27:51,797 [DEBUG] ---> None None t_i_6 min_filter -40.0
2025-09-30 09:27:51,798 [DEBUG] ---> None None t_i_7 min_filter -40.0
2025-09-30 09:27:51,804 [DEBUG] ---> None None t_i_8 min_filter -40.0
2025-09-30 09:27:51,805 [DEBUG] ---> None None z_boom_u max_filter 2.65
2025-09-30 09:27:51,806 [INFO] could not adjust z_ice_surf not in dataset
2025-09-30 09:27:51,807 [DEBUG] ---> None None z_stake max_filter 2.6
2025-09-30 09:27:51,808 [DEBUG] ---> None None z_stake min_filter 1.33
2025-09-30 09:27:51,809 [INFO] could not adjust z_surf_1 not in dataset
2025-09-30 09:27:51,809 [INFO] could not adjust z_surf_2 not in dataset
2025-09-30 09:27:51,813 [DEBUG] Running persistence_qc using {'t_i': {'max_diff': 0.0001, 'period': 2}, 't_u': {'max_diff': 0.0001, 'period': 2}, 't_l': {'max_diff': 0.0001, 'period': 2}, 'p_i': {'max_diff': 0.0001, 'period': 3}, 'p_u': {'max_diff': 0.0001, 'period': 150}, 'p_l': {'max_diff': 0.0001, 'period': 150}, 'gps_lat_lon': {'max_diff': 1e-06, 'period': 6}, 'gps_alt': {'max_diff': 0.0001, 'period': 6}, 't_rad': {'max_diff': 0.0001, 'period': 2}, 'rh_i': {'max_diff': 0.0001, 'period': 2}, 'rh_u': {'max_diff': 0.0001, 'period': 2}, 'rh_l': {'max_diff': 0.0001, 'period': 2}, 'wspd_i': {'max_diff': 0.0001, 'period': 6}, 'wspd_u': {'max_diff': 0.0001, 'period': 6}, 'wspd_l': {'max_diff': 0.0001, 'period': 6}}
2025-09-30 09:27:51,817 [DEBUG] Applying persistent QC in t_i. Filtering 12/5463 samples
2025-09-30 09:27:51,821 [DEBUG] Applying persistent QC in t_u. Filtering 1/5463 samples
2025-09-30 09:27:51,824 [DEBUG] Applying persistent QC in p_i. Filtering 14/5463 samples
2025-09-30 09:27:51,904 [DEBUG] Applying persistent QC in p_u. Filtering 0/5463 samples
2025-09-30 09:27:51,915 [DEBUG] Applying persistent QC in gps_lat_lon. Filtering 24/5463 samples
2025-09-30 09:27:51,922 [DEBUG] Applying persistent QC in gps_alt. Filtering 29/5463 samples
2025-09-30 09:27:51,925 [DEBUG] Applying persistent QC in t_rad. Filtering 0/5463 samples
2025-09-30 09:27:51,927 [DEBUG] Applying persistent QC in rh_i. Filtering 6/5463 samples
2025-09-30 09:27:51,931 [DEBUG] Applying persistent QC in rh_u. Filtering 2/5463 samples
2025-09-30 09:27:51,935 [DEBUG] Applying persistent QC in wspd_i. Filtering 11/5463 samples
2025-09-30 09:27:51,942 [DEBUG] Applying persistent QC in wspd_u. Filtering 6/5463 samples
2025-09-30 09:27:52,331 [INFO] Resampling to 60min
2025-09-30 09:27:52,420 [INFO] Writing to files...
2025-09-30 09:27:52,688 [INFO] Written to L2_test/tx/THU_L2/THU_L2_hour.csv
2025-09-30 09:27:52,688 [INFO] Written to L2_test/tx/THU_L2/THU_L2_hour.nc
2025-09-30 09:27:52,688 [INFO] AWS(config_file=../aws-l0//raw/config/THU_L2.toml, inpath=../aws-l0//raw/THU_L2/, data_issues_repository=../PROMICE-AWS-data-issues, var_file=None, meta_file=None)
2025-09-30 09:27:53,004 [DEBUG] Source information: {'pypromice': '1.5.1', 'l0_config_file': 'THU_L2.toml:016a28db7b1c6dc223642f5fa4e0a0249a3cdac3', 'l0_data_root': '016a28db7b1c6dc223642f5fa4e0a0249a3cdac3', 'data_issues': 'd1389d62adb1864056bb11f559d4785105b56943'}
2025-09-30 09:27:53,011 [INFO] Detected L0 file type 'csv_default' for ../aws-l0/raw/THU_L2/THU_L2_2024_raw_transmitted.txt
2025-09-30 09:27:53,080 [INFO] L0 data successfully loaded from THU_L2_2024_raw_transmitted.txt
2025-09-30 09:27:53,862 [INFO] Detected L0 file type 'toa5' for ../aws-l0/raw/THU_L2/THU_L2_2024_SlimTableMem.txt
2025-09-30 09:27:53,910 [INFO] Detected L0 file type 'toa5' for ../aws-l0/raw/THU_L2/THU_L2_2024_SlimTableMem.txt
2025-09-30 09:27:54,018 [INFO] L0 data successfully loaded from THU_L2_2024_SlimTableMem.txt
2025-09-30 09:27:54,037 [INFO] Level 1 processing...
2025-09-30 09:27:54,190 [WARNING] bedrock attribute is not set
2025-09-30 09:27:54,449 [WARNING] bedrock attribute is not set
2025-09-30 09:27:54,615 [INFO] Level 2 processing...
2025-09-30 09:27:54,616 [INFO] Using file: ../PROMICE-AWS-data-issues/adjustments/THU_L2.csv
2025-09-30 09:27:54,622 [INFO] Using file: ../PROMICE-AWS-data-issues/flags/THU_L2.csv
2025-09-30 09:27:54,622 [INFO] No ../PROMICE-AWS-data-issues/flags/THU_L2.csv file to read.
2025-09-30 09:27:54,624 [INFO] Using file: ../PROMICE-AWS-data-issues/adjustments/THU_L2.csv
2025-09-30 09:27:54,648 [DEBUG] ---> None None t_i_1 min_filter -40.0
2025-09-30 09:27:54,650 [DEBUG] ---> None None t_i_2 min_filter -40.0
2025-09-30 09:27:54,651 [DEBUG] ---> None None t_i_3 min_filter -40.0
2025-09-30 09:27:54,652 [DEBUG] ---> None None t_i_4 min_filter -40.0
2025-09-30 09:27:54,653 [DEBUG] ---> None None t_i_5 min_filter -40.0
2025-09-30 09:27:54,654 [DEBUG] ---> None None t_i_6 min_filter -40.0
2025-09-30 09:27:54,656 [DEBUG] ---> None None t_i_7 min_filter -40.0
2025-09-30 09:27:54,657 [DEBUG] ---> None None t_i_8 min_filter -40.0
2025-09-30 09:27:54,658 [DEBUG] ---> None None z_boom_u max_filter 2.65
2025-09-30 09:27:54,658 [INFO] could not adjust z_ice_surf not in dataset
2025-09-30 09:27:54,659 [DEBUG] ---> None None z_stake max_filter 2.6
2025-09-30 09:27:54,660 [DEBUG] ---> None None z_stake min_filter 1.33
2025-09-30 09:27:54,660 [INFO] could not adjust z_surf_1 not in dataset
2025-09-30 09:27:54,660 [INFO] could not adjust z_surf_2 not in dataset
2025-09-30 09:27:54,666 [DEBUG] Running persistence_qc using {'t_i': {'max_diff': 0.0001, 'period': 2}, 't_u': {'max_diff': 0.0001, 'period': 2}, 't_l': {'max_diff': 0.0001, 'period': 2}, 'p_i': {'max_diff': 0.0001, 'period': 3}, 'p_u': {'max_diff': 0.0001, 'period': 150}, 'p_l': {'max_diff': 0.0001, 'period': 150}, 'gps_lat_lon': {'max_diff': 1e-06, 'period': 6}, 'gps_alt': {'max_diff': 0.0001, 'period': 6}, 't_rad': {'max_diff': 0.0001, 'period': 2}, 'rh_i': {'max_diff': 0.0001, 'period': 2}, 'rh_u': {'max_diff': 0.0001, 'period': 2}, 'rh_l': {'max_diff': 0.0001, 'period': 2}, 'wspd_i': {'max_diff': 0.0001, 'period': 6}, 'wspd_u': {'max_diff': 0.0001, 'period': 6}, 'wspd_l': {'max_diff': 0.0001, 'period': 6}}
2025-09-30 09:27:54,670 [DEBUG] Applying persistent QC in t_i. Filtering 5/17801 samples
2025-09-30 09:27:54,674 [DEBUG] Applying persistent QC in t_u. Filtering 4/17801 samples
2025-09-30 09:27:54,677 [DEBUG] Applying persistent QC in p_i. Filtering 7/17801 samples
2025-09-30 09:27:54,737 [DEBUG] Applying persistent QC in p_u. Filtering 0/17801 samples
2025-09-30 09:27:54,745 [DEBUG] Applying persistent QC in gps_lat_lon. Filtering 7591/17801 samples
2025-09-30 09:27:54,749 [DEBUG] Applying persistent QC in gps_alt. Filtering 7596/17801 samples
2025-09-30 09:27:54,752 [DEBUG] Applying persistent QC in t_rad. Filtering 0/17801 samples
2025-09-30 09:27:54,755 [DEBUG] Applying persistent QC in rh_i. Filtering 7/17801 samples
2025-09-30 09:27:54,757 [DEBUG] Applying persistent QC in rh_u. Filtering 16/17801 samples
2025-09-30 09:27:54,761 [DEBUG] Applying persistent QC in wspd_i. Filtering 21/17801 samples
2025-09-30 09:27:54,765 [DEBUG] Applying persistent QC in wspd_u. Filtering 239/17801 samples
2025-09-30 09:27:55,077 [INFO] Resampling to 60min
2025-09-30 09:27:55,148 [INFO] Writing to files...
2025-09-30 09:27:55,733 [INFO] Written to L2_test/raw/THU_L2/THU_L2_hour.csv
2025-09-30 09:27:55,733 [INFO] Written to L2_test/raw/THU_L2/THU_L2_hour.nc
2025-09-30 09:27:55,782 [DEBUG] Could not import boto3, continuing with reduced functionality.
2025-09-30 09:27:55,782 [DEBUG] GDAL data found in package: path='/home/bav/miniforge3/lib/python3.12/site-packages/rasterio/gdal_data'.
2025-09-30 09:27:55,783 [DEBUG] PROJ data found in package: path='/home/bav/miniforge3/lib/python3.12/site-packages/rasterio/proj_data'.
2025-09-30 09:27:55,865 [INFO] THU_L2 array loaded from L2_test/raw/THU_L2/THU_L2_hour.nc
2025-09-30 09:27:55,892 [INFO] THU_L2 array loaded from L2_test/tx/THU_L2/THU_L2_hour.nc
2025-09-30 09:27:55,892 [INFO] Combining L2_test/raw/THU_L2/THU_L2_hour.nc with L2_test/tx/THU_L2/THU_L2_hour.nc...
2025-09-30 09:27:56,004 [INFO] Writing to files...
2025-09-30 09:27:56,715 [INFO] Written to L2_test/level_2/THU_L2/THU_L2_hour.csv
2025-09-30 09:27:56,715 [INFO] Written to L2_test/level_2/THU_L2/THU_L2_hour.nc
2025-09-30 09:27:56,715 [INFO] Files saved to L2_test/level_2/THU_L2...
2025-09-30 09:27:56,750 [WARNING] data_issues_path is missing. Using default data issues path: ../PROMICE-AWS-data-issues
2025-09-30 09:27:58,515 [INFO] processing gps_lat without relocation
2025-09-30 09:27:58,520 [INFO] processing gps_lon without relocation
2025-09-30 09:27:58,523 [INFO] processing gps_alt without relocation
2025-09-30 09:27:58,539 [INFO] Using file: ../PROMICE-AWS-data-issues/adjustments/THU_L2.csv
2025-09-30 09:27:58,556 [DEBUG] ---> 2022-01-01 00:00:00 None z_ice_surf add 2.2
2025-09-30 09:27:58,559 [DEBUG] ---> 2022-01-01 00:00:00 None z_surf_1 add -0.15
2025-09-30 09:27:58,562 [DEBUG] ---> 2022-01-01 00:00:00 None z_surf_2 add 1.5
2025-09-30 09:27:58,563 [DEBUG] ---> 2024-05-10 19:00:00 None z_surf_2 add -1.5
2025-09-30 09:27:58,564 [INFO] Combining surface height
2025-09-30 09:27:58,565 [INFO] -> ablation site
2025-09-30 09:27:58,682 [DEBUG] -> estimating ablation period for each year
2025-09-30 09:27:58,684 [DEBUG] 2022 derived from z_ice_surf
2025-09-30 09:27:58,685 [DEBUG] 2023 derived from z_ice_surf
2025-09-30 09:27:58,687 [DEBUG] 2024 derived from z_ice_surf
2025-09-30 09:27:58,688 [DEBUG] 2025 derived from z_ice_surf
2025-09-30 09:27:58,688 [DEBUG] 2022: Ablation from 2022-06-17 05:00:00 to 2022-09-05 05:00:00
2025-09-30 09:27:58,695 [DEBUG] adjusting z to hs1
2025-09-30 09:27:58,696 [DEBUG] adjusting hs2 to z
2025-09-30 09:27:58,696 [DEBUG] using end of melt season
2025-09-30 09:27:58,698 [DEBUG] adjusting hs1
2025-09-30 09:27:58,698 [DEBUG] to hs2, minimizing winter difference
2025-09-30 09:27:58,700 [DEBUG] 2023: Ablation from 2023-06-20 13:00:00 to 2023-08-31 23:00:00
2025-09-30 09:27:58,706 [DEBUG] adjusting hs2 to z
2025-09-30 09:27:58,706 [DEBUG] using end of melt season
2025-09-30 09:27:58,708 [DEBUG] adjusting hs1
2025-09-30 09:27:58,708 [DEBUG] to hs2, minimizing winter difference
2025-09-30 09:27:58,710 [DEBUG] 2024: Ablation from 2024-06-11 10:00:00 to 2024-08-21 00:00:00
2025-09-30 09:27:58,715 [DEBUG] adjusting hs2 to z
2025-09-30 09:27:58,715 [DEBUG] using end of melt season
2025-09-30 09:27:58,718 [DEBUG] adjusting hs1
2025-09-30 09:27:58,718 [DEBUG] to hs2, minimizing winter difference
2025-09-30 09:27:58,719 [DEBUG] 2025: Ablation from 2025-06-11 15:00:00 to 2025-07-23 15:00:00
2025-09-30 09:27:58,725 [DEBUG] adjusting hs2 to z
2025-09-30 09:27:58,725 [DEBUG] using end of melt season
2025-09-30 09:27:58,740 [INFO] surface height combination finished
2025-09-30 09:27:58,771 [INFO] Calculating thermistor depth
2025-09-30 09:27:58,797 [INFO] interpolating 10 m firn/ice temperature (on hourly values)
2025-09-30 09:27:59,429 [INFO] Resampling to 60min
2025-09-30 09:27:59,528 [INFO] Writing to files...
2025-09-30 09:28:00,423 [INFO] Written to L3_test/stations/THU_L2/THU_L2_hour.csv
2025-09-30 09:28:00,423 [INFO] Written to L3_test/stations/THU_L2/THU_L2_hour.nc
2025-09-30 09:28:00,478 [INFO] Resampling to 1D
2025-09-30 09:28:00,558 [INFO] Writing to files...
2025-09-30 09:28:00,704 [INFO] Written to L3_test/stations/THU_L2/THU_L2_day.csv
2025-09-30 09:28:00,704 [INFO] Written to L3_test/stations/THU_L2/THU_L2_day.nc
2025-09-30 09:28:00,828 [INFO] Resampling to ME
2025-09-30 09:28:00,906 [INFO] Writing to files...
2025-09-30 09:28:01,017 [INFO] Written to L3_test/stations/THU_L2/THU_L2_month.csv
2025-09-30 09:28:01,017 [INFO] Written to L3_test/stations/THU_L2/THU_L2_month.nc
/n ======== test join_l3 ========= 

THU_L2

 ======== test get_l2 ========= 


 ======== test join_l2 ========= 


 ======== test l2tol3 ========= 

