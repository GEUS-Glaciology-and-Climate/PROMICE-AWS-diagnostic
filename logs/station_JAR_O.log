2025-09-30 09:19:20,483 [INFO] AWS(config_file=../aws-l0//tx/config/JAR_O.toml, inpath=../aws-l0//tx/, data_issues_repository=../PROMICE-AWS-data-issues, var_file=None, meta_file=None)
2025-09-30 09:19:20,935 [DEBUG] Source information: {'pypromice': '1.5.1', 'l0_config_file': 'JAR_O.toml:016a28db7b1c6dc223642f5fa4e0a0249a3cdac3', 'l0_data_root': '016a28db7b1c6dc223642f5fa4e0a0249a3cdac3', 'data_issues': 'd1389d62adb1864056bb11f559d4785105b56943'}
2025-09-30 09:19:20,952 [INFO] Detected L0 file type 'csv_default' for ../aws-l0/tx/JAR_O_300534063814490_1.txt
2025-09-30 09:19:21,072 [INFO] L0 data successfully loaded from JAR_O_300534063814490_1.txt
2025-09-30 09:19:21,078 [INFO] Detected L0 file type 'csv_default' for ../aws-l0/tx/JAR_O_300534063814490_2.txt
2025-09-30 09:19:21,219 [INFO] L0 data successfully loaded from JAR_O_300534063814490_2.txt
2025-09-30 09:19:21,224 [INFO] Detected L0 file type 'csv_default' for ../aws-l0/tx/JAR_O_300534063814490_3.txt
2025-09-30 09:19:21,262 [INFO] L0 data successfully loaded from JAR_O_300534063814490_3.txt
2025-09-30 09:19:21,287 [INFO] Level 1 processing...
2025-09-30 09:19:21,437 [WARNING] bedrock attribute is not set
2025-09-30 09:19:21,701 [WARNING] bedrock attribute is not set
2025-09-30 09:19:21,939 [WARNING] bedrock attribute is not set
2025-09-30 09:19:22,183 [INFO] Level 2 processing...
2025-09-30 09:19:22,185 [INFO] Using file: ../PROMICE-AWS-data-issues/adjustments/JAR_O.csv
2025-09-30 09:19:22,189 [INFO] Using file: ../PROMICE-AWS-data-issues/flags/JAR_O.csv
2025-09-30 09:19:22,195 [DEBUG] ---> flagging 2023-09-19T13:00:00.000000000 2022-11-01 00:00:00 dsr
2025-09-30 09:19:22,202 [DEBUG] ---> flagging 2022-01-01 00:00:00 2025-10-01 00:00:00 z_pt_cor
2025-09-30 09:19:22,206 [DEBUG] ---> flagging 2024-08-22 00:00:00 2024-09-15 00:00:00 z_boom_u
2025-09-30 09:19:22,210 [DEBUG] ---> flagging 2025-01-02 04:00:00 2025-01-04 00:00:00 t_u
2025-09-30 09:19:22,212 [DEBUG] ---> flagging 2025-01-02 04:00:00 2025-01-04 00:00:00 rh_u
2025-09-30 09:19:22,215 [DEBUG] ---> flagging 2025-01-20 12:00:00 2025-01-24 12:00:00 t_u
2025-09-30 09:19:22,218 [DEBUG] ---> flagging 2025-01-20 12:00:00 2025-01-24 12:00:00 rh_u
2025-09-30 09:19:22,224 [INFO] Using file: ../PROMICE-AWS-data-issues/adjustments/JAR_O.csv
2025-09-30 09:19:22,233 [DEBUG] ---> None None p_u min_filter 800.0
2025-09-30 09:19:22,237 [DEBUG] ---> 2025-02-12 12:00:00 2025-02-21 00:00:00 rh_u min_filter 57.0
2025-09-30 09:19:22,240 [DEBUG] ---> 2025-02-01 00:00:00 2025-02-02 00:00:00 t_u min_filter -30.0
2025-09-30 09:19:22,242 [DEBUG] ---> 2025-02-15 00:00:00 2025-02-17 00:00:00 t_u min_filter -17.0
2025-09-30 09:19:22,245 [DEBUG] ---> 2024-08-16 00:00:00 2024-11-24 00:00:00 z_boom_u min_filter 2.14
2025-09-30 09:19:22,247 [DEBUG] ---> 2024-08-16 00:00:00 2024-12-17 00:00:00 z_boom_u min_filter 1.8
2025-09-30 09:19:22,248 [DEBUG] ---> None None z_boom_u max_filter 2.8
2025-09-30 09:19:22,251 [DEBUG] ---> 2025-08-16 00:00:00 None z_stake min_filter 1.5
2025-09-30 09:19:22,252 [INFO] could not adjust z_surf_1 not in dataset
2025-09-30 09:19:22,252 [INFO] could not adjust z_surf_2 not in dataset
2025-09-30 09:19:22,261 [DEBUG] Running persistence_qc using {'t_i': {'max_diff': 0.0001, 'period': 2}, 't_u': {'max_diff': 0.0001, 'period': 2}, 't_l': {'max_diff': 0.0001, 'period': 2}, 'p_i': {'max_diff': 0.0001, 'period': 3}, 'p_u': {'max_diff': 0.0001, 'period': 150}, 'p_l': {'max_diff': 0.0001, 'period': 150}, 'gps_lat_lon': {'max_diff': 1e-06, 'period': 6}, 'gps_alt': {'max_diff': 0.0001, 'period': 6}, 't_rad': {'max_diff': 0.0001, 'period': 2}, 'rh_i': {'max_diff': 0.0001, 'period': 2}, 'rh_u': {'max_diff': 0.0001, 'period': 2}, 'rh_l': {'max_diff': 0.0001, 'period': 2}, 'wspd_i': {'max_diff': 0.0001, 'period': 6}, 'wspd_u': {'max_diff': 0.0001, 'period': 6}, 'wspd_l': {'max_diff': 0.0001, 'period': 6}}
2025-09-30 09:19:22,266 [DEBUG] Applying persistent QC in t_i. Filtering 258/17754 samples
2025-09-30 09:19:22,269 [DEBUG] Applying persistent QC in t_u. Filtering 21/17754 samples
2025-09-30 09:19:22,274 [DEBUG] Applying persistent QC in p_i. Filtering 120/17754 samples
2025-09-30 09:19:22,364 [DEBUG] Applying persistent QC in p_u. Filtering 0/17754 samples
2025-09-30 09:19:22,377 [DEBUG] Applying persistent QC in gps_lat_lon. Filtering 0/17754 samples
2025-09-30 09:19:22,386 [DEBUG] Applying persistent QC in gps_alt. Filtering 1/17754 samples
2025-09-30 09:19:22,390 [DEBUG] Applying persistent QC in t_rad. Filtering 0/17754 samples
2025-09-30 09:19:22,395 [DEBUG] Applying persistent QC in rh_i. Filtering 114/17754 samples
2025-09-30 09:19:22,399 [DEBUG] Applying persistent QC in rh_u. Filtering 102/17754 samples
2025-09-30 09:19:22,405 [DEBUG] Applying persistent QC in wspd_i. Filtering 0/17754 samples
2025-09-30 09:19:22,411 [DEBUG] Applying persistent QC in wspd_u. Filtering 0/17754 samples
2025-09-30 09:19:22,904 [INFO] Resampling to 60min
2025-09-30 09:19:22,992 [INFO] Writing to files...
2025-09-30 09:19:23,670 [INFO] Written to L2_test/tx/JAR_O/JAR_O_hour.csv
2025-09-30 09:19:23,670 [INFO] Written to L2_test/tx/JAR_O/JAR_O_hour.nc
2025-09-30 09:19:23,670 [INFO] AWS(config_file=../aws-l0//raw/config/JAR_O.toml, inpath=../aws-l0//raw/JAR_O/, data_issues_repository=../PROMICE-AWS-data-issues, var_file=None, meta_file=None)
2025-09-30 09:19:23,962 [DEBUG] Source information: {'pypromice': '1.5.1', 'l0_config_file': 'JAR_O.toml:016a28db7b1c6dc223642f5fa4e0a0249a3cdac3', 'l0_data_root': '016a28db7b1c6dc223642f5fa4e0a0249a3cdac3', 'data_issues': 'd1389d62adb1864056bb11f559d4785105b56943'}
2025-09-30 09:19:23,969 [INFO] Detected L0 file type 'toa5' for ../aws-l0/raw/JAR_O/JAR_O_2023_raw.txt
2025-09-30 09:19:24,071 [INFO] Detected L0 file type 'toa5' for ../aws-l0/raw/JAR_O/JAR_O_2023_raw.txt
2025-09-30 09:19:24,300 [INFO] L0 data successfully loaded from JAR_O_2023_raw.txt
2025-09-30 09:19:24,303 [INFO] Detected L0 file type 'toa5' for ../aws-l0/raw/JAR_O/JAR_O_2024_raw.txt
2025-09-30 09:19:24,397 [INFO] Detected L0 file type 'toa5' for ../aws-l0/raw/JAR_O/JAR_O_2024_raw.txt
2025-09-30 09:19:24,630 [INFO] L0 data successfully loaded from JAR_O_2024_raw.txt
2025-09-30 09:19:24,645 [INFO] Level 1 processing...
2025-09-30 09:19:24,737 [WARNING] bedrock attribute is not set
2025-09-30 09:19:24,908 [WARNING] bedrock attribute is not set
2025-09-30 09:19:25,107 [INFO] Level 2 processing...
2025-09-30 09:19:25,112 [INFO] Using file: ../PROMICE-AWS-data-issues/adjustments/JAR_O.csv
2025-09-30 09:19:25,119 [INFO] Using file: ../PROMICE-AWS-data-issues/flags/JAR_O.csv
2025-09-30 09:19:25,123 [DEBUG] ---> flagging 2022-08-03T14:40:00.000000000 2022-11-01 00:00:00 dsr
2025-09-30 09:19:25,126 [DEBUG] ---> flagging 2022-01-01 00:00:00 2025-10-01 00:00:00 z_pt_cor
2025-09-30 09:19:25,129 [DEBUG] ---> flagging 2024-08-22 00:00:00 2024-09-15 00:00:00 z_boom_u
2025-09-30 09:19:25,131 [DEBUG] ---> flagging 2025-01-02 04:00:00 2025-01-04 00:00:00 t_u
2025-09-30 09:19:25,133 [DEBUG] ---> flagging 2025-01-02 04:00:00 2025-01-04 00:00:00 rh_u
2025-09-30 09:19:25,135 [DEBUG] ---> flagging 2025-01-20 12:00:00 2025-01-24 12:00:00 t_u
2025-09-30 09:19:25,137 [DEBUG] ---> flagging 2025-01-20 12:00:00 2025-01-24 12:00:00 rh_u
2025-09-30 09:19:25,143 [INFO] Using file: ../PROMICE-AWS-data-issues/adjustments/JAR_O.csv
2025-09-30 09:19:25,149 [DEBUG] ---> None None p_u min_filter 800.0
2025-09-30 09:19:25,156 [INFO] ---> 2025-02-12 12:00:00 2025-02-21 00:00:00 rh_u min_filter 57.0
2025-09-30 09:19:25,156 [INFO] Time range does not intersect with dataset
2025-09-30 09:19:25,158 [INFO] ---> 2025-02-01 00:00:00 2025-02-02 00:00:00 t_u min_filter -30.0
2025-09-30 09:19:25,158 [INFO] Time range does not intersect with dataset
2025-09-30 09:19:25,160 [INFO] ---> 2025-02-15 00:00:00 2025-02-17 00:00:00 t_u min_filter -17.0
2025-09-30 09:19:25,160 [INFO] Time range does not intersect with dataset
2025-09-30 09:19:25,162 [DEBUG] ---> 2024-08-16 00:00:00 2024-11-24 00:00:00 z_boom_u min_filter 2.14
2025-09-30 09:19:25,163 [DEBUG] ---> 2024-08-16 00:00:00 2024-12-17 00:00:00 z_boom_u min_filter 1.8
2025-09-30 09:19:25,164 [DEBUG] ---> None None z_boom_u max_filter 2.8
2025-09-30 09:19:25,166 [INFO] ---> 2025-08-16 00:00:00 None z_stake min_filter 1.5
2025-09-30 09:19:25,166 [INFO] Time range does not intersect with dataset
2025-09-30 09:19:25,166 [INFO] could not adjust z_surf_1 not in dataset
2025-09-30 09:19:25,166 [INFO] could not adjust z_surf_2 not in dataset
2025-09-30 09:19:25,183 [DEBUG] Running persistence_qc using {'t_i': {'max_diff': 0.0001, 'period': 2}, 't_u': {'max_diff': 0.0001, 'period': 2}, 't_l': {'max_diff': 0.0001, 'period': 2}, 'p_i': {'max_diff': 0.0001, 'period': 3}, 'p_u': {'max_diff': 0.0001, 'period': 150}, 'p_l': {'max_diff': 0.0001, 'period': 150}, 'gps_lat_lon': {'max_diff': 1e-06, 'period': 6}, 'gps_alt': {'max_diff': 0.0001, 'period': 6}, 't_rad': {'max_diff': 0.0001, 'period': 2}, 'rh_i': {'max_diff': 0.0001, 'period': 2}, 'rh_u': {'max_diff': 0.0001, 'period': 2}, 'rh_l': {'max_diff': 0.0001, 'period': 2}, 'wspd_i': {'max_diff': 0.0001, 'period': 6}, 'wspd_u': {'max_diff': 0.0001, 'period': 6}, 'wspd_l': {'max_diff': 0.0001, 'period': 6}}
2025-09-30 09:19:25,189 [DEBUG] Applying persistent QC in t_i. Filtering 0/107553 samples
2025-09-30 09:19:25,195 [DEBUG] Applying persistent QC in t_u. Filtering 187/107553 samples
2025-09-30 09:19:25,201 [DEBUG] Applying persistent QC in p_i. Filtering 0/107553 samples
2025-09-30 09:19:25,289 [DEBUG] Applying persistent QC in p_u. Filtering 0/107553 samples
2025-09-30 09:19:25,304 [DEBUG] Applying persistent QC in gps_lat_lon. Filtering 0/107553 samples
2025-09-30 09:19:25,312 [DEBUG] Applying persistent QC in gps_alt. Filtering 0/107553 samples
2025-09-30 09:19:25,317 [DEBUG] Applying persistent QC in t_rad. Filtering 0/107553 samples
2025-09-30 09:19:25,324 [DEBUG] Applying persistent QC in rh_i. Filtering 0/107553 samples
2025-09-30 09:19:25,330 [DEBUG] Applying persistent QC in rh_u. Filtering 6/107553 samples
2025-09-30 09:19:25,338 [DEBUG] Applying persistent QC in wspd_i. Filtering 0/107553 samples
2025-09-30 09:19:25,345 [DEBUG] Applying persistent QC in wspd_u. Filtering 276/107553 samples
2025-09-30 09:19:25,961 [INFO] Resampling to 10min
2025-09-30 09:19:26,080 [INFO] Writing to files...
2025-09-30 09:19:28,721 [INFO] Written to L2_test/raw/JAR_O/JAR_O_10min.csv
2025-09-30 09:19:28,721 [INFO] Written to L2_test/raw/JAR_O/JAR_O_10min.nc
2025-09-30 09:19:28,894 [INFO] Resampling to 60min
2025-09-30 09:19:28,964 [INFO] Writing to files...
2025-09-30 09:19:29,592 [INFO] Written to L2_test/raw/JAR_O/JAR_O_hour.csv
2025-09-30 09:19:29,592 [INFO] Written to L2_test/raw/JAR_O/JAR_O_hour.nc
2025-09-30 09:19:29,648 [DEBUG] Could not import boto3, continuing with reduced functionality.
2025-09-30 09:19:29,649 [DEBUG] GDAL data found in package: path='/home/bav/miniforge3/lib/python3.12/site-packages/rasterio/gdal_data'.
2025-09-30 09:19:29,649 [DEBUG] PROJ data found in package: path='/home/bav/miniforge3/lib/python3.12/site-packages/rasterio/proj_data'.
2025-09-30 09:19:29,740 [INFO] JAR_O array loaded from L2_test/raw/JAR_O/JAR_O_hour.nc
2025-09-30 09:19:29,770 [INFO] JAR_O array loaded from L2_test/tx/JAR_O/JAR_O_hour.nc
2025-09-30 09:19:29,770 [INFO] Combining L2_test/raw/JAR_O/JAR_O_hour.nc with L2_test/tx/JAR_O/JAR_O_hour.nc...
2025-09-30 09:19:29,882 [INFO] Writing to files...
2025-09-30 09:19:30,720 [INFO] Written to L2_test/level_2/JAR_O/JAR_O_hour.csv
2025-09-30 09:19:30,720 [INFO] Written to L2_test/level_2/JAR_O/JAR_O_hour.nc
2025-09-30 09:19:30,720 [INFO] Files saved to L2_test/level_2/JAR_O...
2025-09-30 09:19:30,759 [WARNING] data_issues_path is missing. Using default data issues path: ../PROMICE-AWS-data-issues
2025-09-30 09:19:32,636 [INFO] processing gps_lat without relocation
2025-09-30 09:19:32,640 [INFO] processing gps_lon without relocation
2025-09-30 09:19:32,644 [INFO] processing gps_alt without relocation
2025-09-30 09:19:32,658 [INFO] Using file: ../PROMICE-AWS-data-issues/adjustments/JAR_O.csv
2025-09-30 09:19:32,665 [DEBUG] ---> 2024-08-19 14:00:00 None z_surf_1 add -0.8
2025-09-30 09:19:32,667 [DEBUG] ---> 2023-09-19 00:00:00 None z_surf_2 add 1.0
2025-09-30 09:19:32,668 [DEBUG] ---> 2024-08-19 14:00:00 None z_surf_2 add -2.5
2025-09-30 09:19:32,669 [DEBUG] ---> 2025-08-01 00:00:00 None z_surf_2 add 0.5
2025-09-30 09:19:32,670 [INFO] Combining surface height
2025-09-30 09:19:32,670 [INFO] -> ablation site
2025-09-30 09:19:32,754 [DEBUG] -> estimating ablation period for each year
2025-09-30 09:19:32,756 [DEBUG] 2022 no z_ice_surf, just using JJA
2025-09-30 09:19:32,758 [DEBUG] 2023 no z_ice_surf, just using JJA
2025-09-30 09:19:32,760 [DEBUG] 2024 no z_ice_surf, just using JJA
2025-09-30 09:19:32,762 [DEBUG] 2025 no z_ice_surf, just using JJA
2025-09-30 09:19:32,762 [DEBUG] 2022: Ablation from 2022-08-03 14:00:00 to 2022-08-31 23:00:00
2025-09-30 09:19:32,770 [DEBUG] adjusting hs1
2025-09-30 09:19:32,771 [DEBUG] to hs2, minimizing winter difference
2025-09-30 09:19:32,772 [DEBUG] 2023: Ablation from 2023-06-01 00:00:00 to 2023-08-31 23:00:00
2025-09-30 09:19:32,778 [DEBUG] adjusting hs1
2025-09-30 09:19:32,778 [DEBUG] to hs2, minimizing winter difference
2025-09-30 09:19:32,780 [DEBUG] 2024: Ablation from 2024-06-01 00:00:00 to 2024-08-31 23:00:00
2025-09-30 09:19:32,786 [DEBUG] adjusting hs1
2025-09-30 09:19:32,786 [DEBUG] to hs2, minimizing winter difference
2025-09-30 09:19:32,788 [DEBUG] 2025: Ablation from 2025-06-01 00:00:00 to 2025-08-31 23:00:00
2025-09-30 09:19:32,794 [DEBUG] adjusting hs1
2025-09-30 09:19:32,794 [DEBUG] to hs2, minimizing winter difference
2025-09-30 09:19:32,805 [INFO] surface height combination finished
2025-09-30 09:19:32,835 [INFO] Calculating thermistor depth
2025-09-30 09:19:32,861 [INFO] interpolating 10 m firn/ice temperature (on hourly values)
2025-09-30 09:19:37,224 [INFO] Resampling to 60min
2025-09-30 09:19:37,323 [INFO] Writing to files...
2025-09-30 09:19:38,341 [INFO] Written to L3_test/stations/JAR_O/JAR_O_hour.csv
2025-09-30 09:19:38,341 [INFO] Written to L3_test/stations/JAR_O/JAR_O_hour.nc
2025-09-30 09:19:38,394 [INFO] Resampling to 1D
2025-09-30 09:19:38,474 [INFO] Writing to files...
2025-09-30 09:19:38,571 [INFO] Written to L3_test/stations/JAR_O/JAR_O_day.csv
2025-09-30 09:19:38,571 [INFO] Written to L3_test/stations/JAR_O/JAR_O_day.nc
2025-09-30 09:19:38,617 [INFO] Resampling to ME
2025-09-30 09:19:38,696 [INFO] Writing to files...
2025-09-30 09:19:38,755 [INFO] Written to L3_test/stations/JAR_O/JAR_O_month.csv
2025-09-30 09:19:38,755 [INFO] Written to L3_test/stations/JAR_O/JAR_O_month.nc
/n ======== test join_l3 ========= 

JAR_O

 ======== test get_l2 ========= 


 ======== test join_l2 ========= 


 ======== test l2tol3 ========= 

