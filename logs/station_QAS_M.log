2025-09-30 09:24:34,118 [INFO] AWS(config_file=../aws-l0//raw/config/QAS_M.toml, inpath=../aws-l0//raw/QAS_M/, data_issues_repository=../PROMICE-AWS-data-issues, var_file=None, meta_file=None)
2025-09-30 09:24:34,423 [DEBUG] Source information: {'pypromice': '1.5.1', 'l0_config_file': 'QAS_M.toml:016a28db7b1c6dc223642f5fa4e0a0249a3cdac3', 'l0_data_root': '016a28db7b1c6dc223642f5fa4e0a0249a3cdac3', 'data_issues': 'd1389d62adb1864056bb11f559d4785105b56943'}
2025-09-30 09:24:34,439 [INFO] Detected L0 file type 'csv_default' for ../aws-l0/raw/QAS_M/QAS_M_2017_raw_transmitted_1.txt
2025-09-30 09:24:34,480 [INFO] L0 data successfully loaded from QAS_M_2017_raw_transmitted_1.txt
2025-09-30 09:24:34,723 [INFO] Detected L0 file type 'toa5' for ../aws-l0/raw/QAS_M/QAS_M_2017_raw_SlimTableMem.txt
2025-09-30 09:24:34,734 [INFO] Detected L0 file type 'toa5' for ../aws-l0/raw/QAS_M/QAS_M_2017_raw_SlimTableMem.txt
2025-09-30 09:24:34,775 [INFO] L0 data successfully loaded from QAS_M_2017_raw_SlimTableMem.txt
2025-09-30 09:24:35,965 [INFO] Detected L0 file type 'toa5' for ../aws-l0/raw/QAS_M/QAS_M_2018_raw.txt
2025-09-30 09:24:36,034 [INFO] Detected L0 file type 'toa5' for ../aws-l0/raw/QAS_M/QAS_M_2018_raw.txt
2025-09-30 09:24:36,215 [INFO] L0 data successfully loaded from QAS_M_2018_raw.txt
2025-09-30 09:24:36,218 [INFO] Detected L0 file type 'toa5' for ../aws-l0/raw/QAS_M/QAS_M_2019_raw.txt
2025-09-30 09:24:36,396 [INFO] Detected L0 file type 'toa5' for ../aws-l0/raw/QAS_M/QAS_M_2019_raw.txt
2025-09-30 09:24:36,689 [INFO] L0 data successfully loaded from QAS_M_2019_raw.txt
2025-09-30 09:24:36,692 [INFO] Detected L0 file type 'toa5' for ../aws-l0/raw/QAS_M/QAS_M_2020_raw.txt
2025-09-30 09:24:36,835 [INFO] Detected L0 file type 'toa5' for ../aws-l0/raw/QAS_M/QAS_M_2020_raw.txt
2025-09-30 09:24:37,137 [INFO] L0 data successfully loaded from QAS_M_2020_raw.txt
2025-09-30 09:24:37,140 [INFO] Detected L0 file type 'toa5' for ../aws-l0/raw/QAS_M/QAS_M_2021_raw.txt
2025-09-30 09:24:37,279 [INFO] Detected L0 file type 'toa5' for ../aws-l0/raw/QAS_M/QAS_M_2021_raw.txt
2025-09-30 09:24:37,555 [INFO] L0 data successfully loaded from QAS_M_2021_raw.txt
2025-09-30 09:24:37,560 [INFO] Detected L0 file type 'toa5' for ../aws-l0/raw/QAS_M/QAS_M_2022_raw.txt
2025-09-30 09:24:37,729 [INFO] Detected L0 file type 'toa5' for ../aws-l0/raw/QAS_M/QAS_M_2022_raw.txt
2025-09-30 09:24:38,128 [INFO] L0 data successfully loaded from QAS_M_2022_raw.txt
2025-09-30 09:24:38,131 [INFO] Detected L0 file type 'toa5' for ../aws-l0/raw/QAS_M/QAS_M_2023_raw.txt
2025-09-30 09:24:38,254 [INFO] Detected L0 file type 'toa5' for ../aws-l0/raw/QAS_M/QAS_M_2023_raw.txt
2025-09-30 09:24:38,483 [INFO] L0 data successfully loaded from QAS_M_2023_raw.txt
2025-09-30 09:24:38,521 [INFO] Level 1 processing...
2025-09-30 09:24:38,623 [WARNING] bedrock attribute is not set
2025-09-30 09:24:38,845 [WARNING] bedrock attribute is not set
2025-09-30 09:24:39,088 [WARNING] bedrock attribute is not set
2025-09-30 09:24:39,554 [WARNING] bedrock attribute is not set
2025-09-30 09:24:39,986 [WARNING] bedrock attribute is not set
2025-09-30 09:24:40,396 [WARNING] bedrock attribute is not set
2025-09-30 09:24:40,769 [WARNING] bedrock attribute is not set
2025-09-30 09:24:41,173 [WARNING] bedrock attribute is not set
2025-09-30 09:24:42,208 [INFO] Level 2 processing...
2025-09-30 09:24:42,220 [INFO] Using file: ../PROMICE-AWS-data-issues/adjustments/QAS_M.csv
2025-09-30 09:24:42,246 [INFO] Using file: ../PROMICE-AWS-data-issues/flags/QAS_M.csv
2025-09-30 09:24:42,255 [DEBUG] ---> flagging 2017-07-14 14:00:00 2017-08-24 12:00:00 z_pt_cor
2025-09-30 09:24:42,261 [DEBUG] ---> flagging 2017-11-11 00:00:00 2017-12-06 00:00:00 z_pt_cor
2025-09-30 09:24:42,267 [DEBUG] ---> flagging 2018-08-30 00:00:00 2018-08-31 23:00:00 z_pt_cor
2025-09-30 09:24:42,273 [DEBUG] ---> flagging 2017-12-15 00:00:00 2018-02-15 00:00:00 z_stake
2025-09-30 09:24:42,278 [DEBUG] ---> flagging 2018-12-30 00:00:00 2019-01-10 00:00:00 z_stake
2025-09-30 09:24:42,284 [DEBUG] ---> flagging 2019-08-29 00:00:00 2019-12-06 00:00:00 z_stake
2025-09-30 09:24:42,290 [DEBUG] ---> flagging 2019-01-29 00:00:00 2019-02-15 00:00:00 z_boom_u
2025-09-30 09:24:42,298 [DEBUG] ---> flagging 2017-05-18 00:00:00 2017-08-27 00:00:00 t_i_1
2025-09-30 09:24:42,302 [DEBUG] ---> flagging 2017-05-18 00:00:00 2017-08-27 00:00:00 t_i_2
2025-09-30 09:24:42,307 [DEBUG] ---> flagging 2017-05-18 00:00:00 2017-08-27 00:00:00 t_i_3
2025-09-30 09:24:42,311 [DEBUG] ---> flagging 2017-05-18 00:00:00 2017-08-27 00:00:00 t_i_4
2025-09-30 09:24:42,315 [DEBUG] ---> flagging 2017-05-18 00:00:00 2017-08-27 00:00:00 t_i_5
2025-09-30 09:24:42,320 [DEBUG] ---> flagging 2017-05-18 00:00:00 2017-08-27 00:00:00 t_i_6
2025-09-30 09:24:42,324 [DEBUG] ---> flagging 2017-05-18 00:00:00 2017-08-27 00:00:00 t_i_7
2025-09-30 09:24:42,329 [DEBUG] ---> flagging 2017-05-18 00:00:00 2017-08-27 00:00:00 t_i_8
2025-09-30 09:24:42,335 [DEBUG] ---> flagging 2017-10-01 00:00:00 2018-09-18 00:00:00 t_i_7
2025-09-30 09:24:42,354 [INFO] Using file: ../PROMICE-AWS-data-issues/adjustments/QAS_M.csv
2025-09-30 09:24:42,376 [DEBUG] ---> None None gps_alt min_filter 580.0
2025-09-30 09:24:42,378 [DEBUG] ---> None None gps_lat max_filter 70.0
2025-09-30 09:24:42,381 [DEBUG] ---> None None gps_lon min_filter 46.0
2025-09-30 09:24:42,383 [DEBUG] ---> None None t_i_1 min_filter -10.0
2025-09-30 09:24:42,385 [DEBUG] ---> None None t_i_2 min_filter -10.0
2025-09-30 09:24:42,388 [DEBUG] ---> None None t_i_3 min_filter -10.0
2025-09-30 09:24:42,390 [DEBUG] ---> None None t_i_4 min_filter -10.0
2025-09-30 09:24:42,393 [DEBUG] ---> None None t_i_5 min_filter -10.0
2025-09-30 09:24:42,395 [DEBUG] ---> None None t_i_6 min_filter -10.0
2025-09-30 09:24:42,397 [DEBUG] ---> None None t_i_7 min_filter -10.0
2025-09-30 09:24:42,399 [DEBUG] ---> None None t_i_8 min_filter -10.0
2025-09-30 09:24:42,401 [DEBUG] ---> None None z_boom_u max_filter 2.8
2025-09-30 09:24:42,402 [INFO] could not adjust z_ice_surf not in dataset
2025-09-30 09:24:42,402 [INFO] could not adjust z_surf_2 not in dataset
2025-09-30 09:24:42,440 [DEBUG] Running persistence_qc using {'t_i': {'max_diff': 0.0001, 'period': 2}, 't_u': {'max_diff': 0.0001, 'period': 2}, 't_l': {'max_diff': 0.0001, 'period': 2}, 'p_i': {'max_diff': 0.0001, 'period': 3}, 'p_u': {'max_diff': 0.0001, 'period': 150}, 'p_l': {'max_diff': 0.0001, 'period': 150}, 'gps_lat_lon': {'max_diff': 1e-06, 'period': 6}, 'gps_alt': {'max_diff': 0.0001, 'period': 6}, 't_rad': {'max_diff': 0.0001, 'period': 2}, 'rh_i': {'max_diff': 0.0001, 'period': 2}, 'rh_u': {'max_diff': 0.0001, 'period': 2}, 'rh_l': {'max_diff': 0.0001, 'period': 2}, 'wspd_i': {'max_diff': 0.0001, 'period': 6}, 'wspd_u': {'max_diff': 0.0001, 'period': 6}, 'wspd_l': {'max_diff': 0.0001, 'period': 6}}
2025-09-30 09:24:42,457 [DEBUG] Applying persistent QC in t_i. Filtering 0/293248 samples
2025-09-30 09:24:42,472 [DEBUG] Applying persistent QC in t_u. Filtering 524/293248 samples
2025-09-30 09:24:42,489 [DEBUG] Applying persistent QC in p_i. Filtering 0/293248 samples
2025-09-30 09:24:42,667 [DEBUG] Applying persistent QC in p_u. Filtering 0/293248 samples
2025-09-30 09:24:42,702 [DEBUG] Applying persistent QC in gps_lat_lon. Filtering 105967/293248 samples
2025-09-30 09:24:42,721 [DEBUG] Applying persistent QC in gps_alt. Filtering 99639/293248 samples
2025-09-30 09:24:42,735 [DEBUG] Applying persistent QC in t_rad. Filtering 511/293248 samples
2025-09-30 09:24:42,748 [DEBUG] Applying persistent QC in rh_i. Filtering 0/293248 samples
2025-09-30 09:24:42,763 [DEBUG] Applying persistent QC in rh_u. Filtering 2130/293248 samples
2025-09-30 09:24:42,785 [DEBUG] Applying persistent QC in wspd_i. Filtering 0/293248 samples
2025-09-30 09:24:42,803 [DEBUG] Applying persistent QC in wspd_u. Filtering 7482/293248 samples
2025-09-30 09:24:44,175 [INFO] Resampling to 10min
2025-09-30 09:24:44,486 [INFO] Writing to files...
2025-09-30 09:24:51,366 [INFO] Written to L2_test/raw/QAS_M/QAS_M_10min.csv
2025-09-30 09:24:51,366 [INFO] Written to L2_test/raw/QAS_M/QAS_M_10min.nc
2025-09-30 09:24:51,724 [INFO] Resampling to 60min
2025-09-30 09:24:51,813 [INFO] Writing to files...
2025-09-30 09:24:53,347 [INFO] Written to L2_test/raw/QAS_M/QAS_M_hour.csv
2025-09-30 09:24:53,347 [INFO] Written to L2_test/raw/QAS_M/QAS_M_hour.nc
2025-09-30 09:24:53,392 [DEBUG] Could not import boto3, continuing with reduced functionality.
2025-09-30 09:24:53,393 [DEBUG] GDAL data found in package: path='/home/bav/miniforge3/lib/python3.12/site-packages/rasterio/gdal_data'.
2025-09-30 09:24:53,393 [DEBUG] PROJ data found in package: path='/home/bav/miniforge3/lib/python3.12/site-packages/rasterio/proj_data'.
2025-09-30 09:24:53,475 [INFO] QAS_M array loaded from L2_test/raw/QAS_M/QAS_M_hour.nc
2025-09-30 09:24:53,475 [INFO] Only one file found L2_test/raw/QAS_M/QAS_M_hour.nc...
2025-09-30 09:24:53,557 [INFO] Writing to files...
2025-09-30 09:24:55,020 [INFO] Written to L2_test/level_2/QAS_M/QAS_M_hour.csv
2025-09-30 09:24:55,020 [INFO] Written to L2_test/level_2/QAS_M/QAS_M_hour.nc
2025-09-30 09:24:55,020 [INFO] Files saved to L2_test/level_2/QAS_M...
2025-09-30 09:24:55,058 [WARNING] data_issues_path is missing. Using default data issues path: ../PROMICE-AWS-data-issues
2025-09-30 09:24:57,095 [INFO] processing gps_lat with relocation on 2022-09-01T00:00:00
2025-09-30 09:24:57,104 [INFO] processing gps_lon with relocation on 2022-09-01T00:00:00
2025-09-30 09:24:57,111 [INFO] processing gps_alt with relocation on 2022-09-01T00:00:00
2025-09-30 09:24:57,130 [INFO] Using file: ../PROMICE-AWS-data-issues/adjustments/QAS_M.csv
2025-09-30 09:24:57,145 [DEBUG] ---> 2018-08-31 14:00:00 None z_ice_surf add -5.3
2025-09-30 09:24:57,147 [DEBUG] ---> 2019-08-29 16:00:00 None z_ice_surf add -1.4
2025-09-30 09:24:57,148 [DEBUG] ---> 2021-08-31 15:00:00 None z_ice_surf add -18.7
2025-09-30 09:24:57,149 [DEBUG] ---> 2022-09-01 15:00:00 None z_ice_surf add 5.0
2025-09-30 09:24:57,151 [DEBUG] ---> 2017-08-01 14:00:00 None z_surf_2 add -2.0
2025-09-30 09:24:57,152 [DEBUG] ---> 2018-08-31 14:00:00 None z_surf_2 add -2.5
2025-09-30 09:24:57,153 [INFO] Combining surface height
2025-09-30 09:24:57,153 [INFO] -> ablation site
2025-09-30 09:24:57,373 [DEBUG] -> estimating ablation period for each year
2025-09-30 09:24:57,375 [DEBUG] 2016 derived from z_ice_surf
2025-09-30 09:24:57,378 [DEBUG] 2017 derived from z_ice_surf
2025-09-30 09:24:57,380 [DEBUG] 2018 derived from z_ice_surf
2025-09-30 09:24:57,382 [DEBUG] 2019 derived from z_ice_surf
2025-09-30 09:24:57,385 [DEBUG] 2020 derived from z_ice_surf
2025-09-30 09:24:57,387 [DEBUG] 2021 derived from z_ice_surf
2025-09-30 09:24:57,390 [DEBUG] 2022 derived from z_ice_surf
2025-09-30 09:24:57,392 [DEBUG] 2023 derived from z_ice_surf
2025-09-30 09:24:57,392 [DEBUG] 2016: Ablation from 2016-08-14 18:00:00 to 2016-09-25 21:00:00
2025-09-30 09:24:57,400 [DEBUG] adjusting z to hs1
2025-09-30 09:24:57,401 [DEBUG] adjusting hs2 to z
2025-09-30 09:24:57,401 [DEBUG] using end of melt season
2025-09-30 09:24:57,403 [DEBUG] adjusting hs1
2025-09-30 09:24:57,403 [DEBUG] to hs2, minimizing winter difference
2025-09-30 09:24:57,404 [DEBUG] 2017: Ablation from 2017-06-07 07:00:00 to 2017-09-30 23:00:00
2025-09-30 09:24:57,410 [DEBUG] adjusting hs2 to z
2025-09-30 09:24:57,411 [DEBUG] using end of melt season
2025-09-30 09:24:57,413 [DEBUG] adjusting hs1
2025-09-30 09:24:57,413 [DEBUG] to hs2, minimizing winter difference
2025-09-30 09:24:57,415 [DEBUG] 2018: Ablation from 2018-07-14 05:00:00 to 2018-09-21 08:00:00
2025-09-30 09:24:57,420 [DEBUG] adjusting hs2 to z
2025-09-30 09:24:57,420 [DEBUG] using end of melt season
2025-09-30 09:24:57,422 [DEBUG] adjusting hs1
2025-09-30 09:24:57,423 [DEBUG] to hs2, minimizing winter difference
2025-09-30 09:24:57,424 [DEBUG] 2019: Ablation from 2019-06-30 19:00:00 to 2019-09-30 23:00:00
2025-09-30 09:24:57,430 [DEBUG] adjusting hs2 to z
/home/bav/pypromice/src/pypromice/pipeline/L2toL3.py:620: RuntimeWarning: Mean of empty slice
  if ~np.isnan(np.nanmean(hs2.iloc[(ind_end[i]-24*7):(ind_end[i]+24*30)])):
2025-09-30 09:24:57,431 [DEBUG] using end of accumulation season
2025-09-30 09:24:57,432 [DEBUG] adjusting hs1
2025-09-30 09:24:57,433 [DEBUG] to hs2, minimizing winter difference
2025-09-30 09:24:57,434 [DEBUG] 2020: Ablation from 2020-07-05 08:00:00 to 2020-09-17 00:00:00
2025-09-30 09:24:57,439 [DEBUG] adjusting hs2 to z
2025-09-30 09:24:57,440 [DEBUG] using end of melt season
2025-09-30 09:24:57,442 [DEBUG] adjusting hs1
2025-09-30 09:24:57,442 [DEBUG] to hs2, minimizing winter difference
2025-09-30 09:24:57,443 [DEBUG] 2021: Ablation from 2021-07-06 03:00:00 to 2021-09-22 09:00:00
2025-09-30 09:24:57,448 [DEBUG] adjusting hs2 to z
2025-09-30 09:24:57,449 [DEBUG] using end of melt season
2025-09-30 09:24:57,451 [DEBUG] adjusting hs1
2025-09-30 09:24:57,451 [DEBUG] to hs2, minimizing winter difference
2025-09-30 09:24:57,452 [DEBUG] 2022: Ablation from 2022-06-04 00:00:00 to 2022-09-30 23:00:00
2025-09-30 09:24:57,458 [DEBUG] adjusting hs2 to z
2025-09-30 09:24:57,458 [DEBUG] using end of melt season
2025-09-30 09:24:57,460 [DEBUG] adjusting hs1
2025-09-30 09:24:57,460 [DEBUG] to hs2, minimizing winter difference
2025-09-30 09:24:57,462 [DEBUG] 2023: Ablation from 2023-06-14 15:00:00 to 2023-09-02 12:00:00
2025-09-30 09:24:57,467 [DEBUG] adjusting hs2 to z
2025-09-30 09:24:57,467 [DEBUG] using end of melt season
2025-09-30 09:24:57,469 [DEBUG] adjusting hs1
2025-09-30 09:24:57,469 [DEBUG] to hs2, minimizing winter difference
2025-09-30 09:24:57,501 [INFO] surface height combination finished
2025-09-30 09:24:57,548 [INFO] Calculating thermistor depth
2025-09-30 09:24:57,609 [INFO] interpolating 10 m firn/ice temperature (on hourly values)
2025-09-30 09:25:01,134 [INFO] Resampling to 60min
2025-09-30 09:25:01,250 [INFO] Writing to files...
2025-09-30 09:25:03,463 [INFO] Written to L3_test/stations/QAS_M/QAS_M_hour.csv
2025-09-30 09:25:03,463 [INFO] Written to L3_test/stations/QAS_M/QAS_M_hour.nc
2025-09-30 09:25:03,538 [INFO] Resampling to 1D
2025-09-30 09:25:03,618 [INFO] Writing to files...
2025-09-30 09:25:03,748 [INFO] Written to L3_test/stations/QAS_M/QAS_M_day.csv
2025-09-30 09:25:03,748 [INFO] Written to L3_test/stations/QAS_M/QAS_M_day.nc
2025-09-30 09:25:03,820 [INFO] Resampling to ME
2025-09-30 09:25:03,899 [INFO] Writing to files...
2025-09-30 09:25:03,955 [INFO] Written to L3_test/stations/QAS_M/QAS_M_month.csv
2025-09-30 09:25:03,955 [INFO] Written to L3_test/stations/QAS_M/QAS_M_month.nc
/n ======== test join_l3 ========= 

QAS_M

 ======== test get_l2 ========= 


 ======== test join_l2 ========= 


 ======== test l2tol3 ========= 

