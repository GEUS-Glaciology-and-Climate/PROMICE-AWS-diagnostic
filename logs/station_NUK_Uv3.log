2025-09-30 09:23:21,979 [INFO] AWS(config_file=../aws-l0//tx/config/NUK_Uv3.toml, inpath=../aws-l0//tx/, data_issues_repository=../PROMICE-AWS-data-issues, var_file=None, meta_file=None)
2025-09-30 09:23:22,391 [DEBUG] Source information: {'pypromice': '1.5.1', 'l0_config_file': 'NUK_Uv3.toml:016a28db7b1c6dc223642f5fa4e0a0249a3cdac3', 'l0_data_root': '016a28db7b1c6dc223642f5fa4e0a0249a3cdac3', 'data_issues': 'd1389d62adb1864056bb11f559d4785105b56943'}
2025-09-30 09:23:22,413 [INFO] Detected L0 file type 'csv_default' for ../aws-l0/tx/NUK_Uv3_300234068420030_1.txt
2025-09-30 09:23:22,441 [INFO] Detected L0 file type 'csv_default' for ../aws-l0/tx/NUK_Uv3_300234068420030_1.txt
2025-09-30 09:23:22,554 [INFO] L0 data successfully loaded from NUK_Uv3_300234068420030_1.txt
2025-09-30 09:23:22,557 [INFO] Detected L0 file type 'csv_default' for ../aws-l0/tx/NUK_Uv3_300234068420030_2.txt
2025-09-30 09:23:22,621 [INFO] L0 data successfully loaded from NUK_Uv3_300234068420030_2.txt
2025-09-30 09:23:22,628 [INFO] Detected L0 file type 'csv_default' for ../aws-l0/tx/NUK_Uv3_300534062923450_3.txt
2025-09-30 09:23:22,649 [INFO] L0 data successfully loaded from NUK_Uv3_300534062923450_3.txt
2025-09-30 09:23:22,653 [INFO] Detected L0 file type 'csv_default' for ../aws-l0/tx/NUK_Uv3_300534063817730_4.txt
2025-09-30 09:23:22,675 [INFO] L0 data successfully loaded from NUK_Uv3_300534063817730_4.txt
2025-09-30 09:23:22,678 [INFO] Detected L0 file type 'csv_default' for ../aws-l0/tx/NUK_Uv3_300534063817730_5.txt
2025-09-30 09:23:22,711 [INFO] L0 data successfully loaded from NUK_Uv3_300534063817730_5.txt
2025-09-30 09:23:22,729 [INFO] Level 1 processing...
2025-09-30 09:23:22,841 [WARNING] bedrock attribute is not set
2025-09-30 09:23:23,093 [WARNING] bedrock attribute is not set
2025-09-30 09:23:23,318 [WARNING] bedrock attribute is not set
2025-09-30 09:23:23,526 [WARNING] bedrock attribute is not set
2025-09-30 09:23:23,772 [WARNING] bedrock attribute is not set
2025-09-30 09:23:23,947 [INFO] Level 2 processing...
2025-09-30 09:23:23,950 [INFO] Using file: ../PROMICE-AWS-data-issues/adjustments/NUK_Uv3.csv
2025-09-30 09:23:23,957 [INFO] Using file: ../PROMICE-AWS-data-issues/flags/NUK_Uv3.csv
2025-09-30 09:23:23,965 [DEBUG] ---> flagging 2021-09-22 00:00:00 2021-11-01 00:00:00 z_pt_cor
2025-09-30 09:23:23,974 [DEBUG] ---> flagging 2020-08-31T15:18:00.000000000 2023-08-20 00:00:00 t_i_1
2025-09-30 09:23:23,976 [DEBUG] ---> flagging 2020-08-31T15:18:00.000000000 2023-08-20 00:00:00 t_i_2
2025-09-30 09:23:23,978 [DEBUG] ---> flagging 2020-08-31T15:18:00.000000000 2023-08-20 00:00:00 t_i_3
2025-09-30 09:23:23,980 [DEBUG] ---> flagging 2020-08-31T15:18:00.000000000 2023-08-20 00:00:00 t_i_4
2025-09-30 09:23:23,981 [DEBUG] ---> flagging 2020-08-31T15:18:00.000000000 2023-08-20 00:00:00 t_i_5
2025-09-30 09:23:23,983 [DEBUG] ---> flagging 2020-08-31T15:18:00.000000000 2023-08-20 00:00:00 t_i_6
2025-09-30 09:23:23,984 [DEBUG] ---> flagging 2020-08-31T15:18:00.000000000 2023-08-20 00:00:00 t_i_7
2025-09-30 09:23:23,987 [DEBUG] ---> flagging 2020-08-31T15:18:00.000000000 2023-08-20 00:00:00 t_i_8
2025-09-30 09:23:23,992 [INFO] Using file: ../PROMICE-AWS-data-issues/adjustments/NUK_Uv3.csv
2025-09-30 09:23:24,009 [DEBUG] ---> None None gps_lat min_filter 64.505
2025-09-30 09:23:24,011 [DEBUG] ---> None None gps_lon min_filter 49.27
2025-09-30 09:23:24,012 [DEBUG] ---> None None t_i_1 min_filter -20.0
2025-09-30 09:23:24,014 [DEBUG] ---> None None t_i_2 min_filter -20.0
2025-09-30 09:23:24,015 [DEBUG] ---> None None t_i_3 min_filter -20.0
2025-09-30 09:23:24,017 [DEBUG] ---> None None t_i_4 min_filter -20.0
2025-09-30 09:23:24,019 [DEBUG] ---> None None t_i_5 min_filter -20.0
2025-09-30 09:23:24,020 [DEBUG] ---> None None t_i_6 min_filter -20.0
2025-09-30 09:23:24,021 [DEBUG] ---> None None t_i_7 min_filter -20.0
2025-09-30 09:23:24,022 [DEBUG] ---> None None t_i_8 min_filter -20.0
2025-09-30 09:23:24,024 [DEBUG] ---> None None z_boom_u max_filter 2.8
2025-09-30 09:23:24,024 [INFO] could not adjust z_ice_surf not in dataset
2025-09-30 09:23:24,039 [DEBUG] Running persistence_qc using {'t_i': {'max_diff': 0.0001, 'period': 2}, 't_u': {'max_diff': 0.0001, 'period': 2}, 't_l': {'max_diff': 0.0001, 'period': 2}, 'p_i': {'max_diff': 0.0001, 'period': 3}, 'p_u': {'max_diff': 0.0001, 'period': 150}, 'p_l': {'max_diff': 0.0001, 'period': 150}, 'gps_lat_lon': {'max_diff': 1e-06, 'period': 6}, 'gps_alt': {'max_diff': 0.0001, 'period': 6}, 't_rad': {'max_diff': 0.0001, 'period': 2}, 'rh_i': {'max_diff': 0.0001, 'period': 2}, 'rh_u': {'max_diff': 0.0001, 'period': 2}, 'rh_l': {'max_diff': 0.0001, 'period': 2}, 'wspd_i': {'max_diff': 0.0001, 'period': 6}, 'wspd_u': {'max_diff': 0.0001, 'period': 6}, 'wspd_l': {'max_diff': 0.0001, 'period': 6}}
2025-09-30 09:23:24,043 [DEBUG] Applying persistent QC in t_i. Filtering 568/29758 samples
2025-09-30 09:23:24,046 [DEBUG] Applying persistent QC in t_u. Filtering 27/29758 samples
2025-09-30 09:23:24,049 [DEBUG] Applying persistent QC in p_i. Filtering 284/29758 samples
2025-09-30 09:23:24,117 [DEBUG] Applying persistent QC in p_u. Filtering 0/29758 samples
2025-09-30 09:23:24,125 [DEBUG] Applying persistent QC in gps_lat_lon. Filtering 10/29758 samples
2025-09-30 09:23:24,131 [DEBUG] Applying persistent QC in gps_alt. Filtering 10/29758 samples
2025-09-30 09:23:24,135 [DEBUG] Applying persistent QC in t_rad. Filtering 4/29758 samples
2025-09-30 09:23:24,138 [DEBUG] Applying persistent QC in rh_i. Filtering 77/29758 samples
2025-09-30 09:23:24,142 [DEBUG] Applying persistent QC in rh_u. Filtering 79/29758 samples
2025-09-30 09:23:24,148 [DEBUG] Applying persistent QC in wspd_i. Filtering 73/29758 samples
2025-09-30 09:23:24,156 [DEBUG] Applying persistent QC in wspd_u. Filtering 59/29758 samples
2025-09-30 09:23:24,580 [INFO] Resampling to 60min
2025-09-30 09:23:24,680 [INFO] Writing to files...
2025-09-30 09:23:25,738 [INFO] Written to L2_test/tx/NUK_Uv3/NUK_Uv3_hour.csv
2025-09-30 09:23:25,738 [INFO] Written to L2_test/tx/NUK_Uv3/NUK_Uv3_hour.nc
2025-09-30 09:23:25,738 [INFO] AWS(config_file=../aws-l0//raw/config/NUK_Uv3.toml, inpath=../aws-l0//raw/NUK_Uv3/, data_issues_repository=../PROMICE-AWS-data-issues, var_file=None, meta_file=None)
2025-09-30 09:23:26,008 [DEBUG] Source information: {'pypromice': '1.5.1', 'l0_config_file': 'NUK_Uv3.toml:016a28db7b1c6dc223642f5fa4e0a0249a3cdac3', 'l0_data_root': '016a28db7b1c6dc223642f5fa4e0a0249a3cdac3', 'data_issues': 'd1389d62adb1864056bb11f559d4785105b56943'}
2025-09-30 09:23:26,481 [INFO] Detected L0 file type 'toa5' for ../aws-l0/raw/NUK_Uv3/NUK_Uv3_2021_raw.txt
2025-09-30 09:23:26,501 [INFO] Detected L0 file type 'toa5' for ../aws-l0/raw/NUK_Uv3/NUK_Uv3_2021_raw.txt
2025-09-30 09:23:26,563 [INFO] L0 data successfully loaded from NUK_Uv3_2021_raw.txt
2025-09-30 09:23:27,639 [INFO] Detected L0 file type 'toa5' for ../aws-l0/raw/NUK_Uv3/NUK_Uv3_2022_raw.txt
2025-09-30 09:23:27,694 [INFO] Detected L0 file type 'toa5' for ../aws-l0/raw/NUK_Uv3/NUK_Uv3_2022_raw.txt
2025-09-30 09:23:27,811 [INFO] L0 data successfully loaded from NUK_Uv3_2022_raw.txt
2025-09-30 09:23:27,816 [INFO] Detected L0 file type 'toa5' for ../aws-l0/raw/NUK_Uv3/NUK_Uv3_2025_raw.txt
2025-09-30 09:23:27,963 [INFO] Detected L0 file type 'toa5' for ../aws-l0/raw/NUK_Uv3/NUK_Uv3_2025_raw.txt
2025-09-30 09:23:28,311 [INFO] L0 data successfully loaded from NUK_Uv3_2025_raw.txt
2025-09-30 09:23:28,329 [INFO] Level 1 processing...
2025-09-30 09:23:28,439 [WARNING] bedrock attribute is not set
2025-09-30 09:23:28,679 [WARNING] bedrock attribute is not set
2025-09-30 09:23:28,929 [WARNING] bedrock attribute is not set
2025-09-30 09:23:29,292 [INFO] Level 2 processing...
2025-09-30 09:23:29,298 [INFO] Using file: ../PROMICE-AWS-data-issues/adjustments/NUK_Uv3.csv
2025-09-30 09:23:29,306 [INFO] Using file: ../PROMICE-AWS-data-issues/flags/NUK_Uv3.csv
2025-09-30 09:23:29,310 [DEBUG] ---> flagging 2021-09-22 00:00:00 2021-11-01 00:00:00 z_pt_cor
2025-09-30 09:23:29,314 [DEBUG] ---> flagging 2021-06-17T14:50:00.000000000 2023-08-20 00:00:00 t_i_1
2025-09-30 09:23:29,317 [DEBUG] ---> flagging 2021-06-17T14:50:00.000000000 2023-08-20 00:00:00 t_i_2
2025-09-30 09:23:29,319 [DEBUG] ---> flagging 2021-06-17T14:50:00.000000000 2023-08-20 00:00:00 t_i_3
2025-09-30 09:23:29,321 [DEBUG] ---> flagging 2021-06-17T14:50:00.000000000 2023-08-20 00:00:00 t_i_4
2025-09-30 09:23:29,323 [DEBUG] ---> flagging 2021-06-17T14:50:00.000000000 2023-08-20 00:00:00 t_i_5
2025-09-30 09:23:29,325 [DEBUG] ---> flagging 2021-06-17T14:50:00.000000000 2023-08-20 00:00:00 t_i_6
2025-09-30 09:23:29,327 [DEBUG] ---> flagging 2021-06-17T14:50:00.000000000 2023-08-20 00:00:00 t_i_7
2025-09-30 09:23:29,329 [DEBUG] ---> flagging 2021-06-17T14:50:00.000000000 2023-08-20 00:00:00 t_i_8
2025-09-30 09:23:29,337 [INFO] Using file: ../PROMICE-AWS-data-issues/adjustments/NUK_Uv3.csv
2025-09-30 09:23:29,351 [DEBUG] ---> None None gps_lat min_filter 64.505
2025-09-30 09:23:29,352 [DEBUG] ---> None None gps_lon min_filter 49.27
2025-09-30 09:23:29,354 [DEBUG] ---> None None t_i_1 min_filter -20.0
2025-09-30 09:23:29,356 [DEBUG] ---> None None t_i_2 min_filter -20.0
2025-09-30 09:23:29,357 [DEBUG] ---> None None t_i_3 min_filter -20.0
2025-09-30 09:23:29,358 [DEBUG] ---> None None t_i_4 min_filter -20.0
2025-09-30 09:23:29,360 [DEBUG] ---> None None t_i_5 min_filter -20.0
2025-09-30 09:23:29,361 [DEBUG] ---> None None t_i_6 min_filter -20.0
2025-09-30 09:23:29,363 [DEBUG] ---> None None t_i_7 min_filter -20.0
2025-09-30 09:23:29,364 [DEBUG] ---> None None t_i_8 min_filter -20.0
2025-09-30 09:23:29,365 [DEBUG] ---> None None z_boom_u max_filter 2.8
2025-09-30 09:23:29,366 [INFO] could not adjust z_ice_surf not in dataset
2025-09-30 09:23:29,381 [DEBUG] Running persistence_qc using {'t_i': {'max_diff': 0.0001, 'period': 2}, 't_u': {'max_diff': 0.0001, 'period': 2}, 't_l': {'max_diff': 0.0001, 'period': 2}, 'p_i': {'max_diff': 0.0001, 'period': 3}, 'p_u': {'max_diff': 0.0001, 'period': 150}, 'p_l': {'max_diff': 0.0001, 'period': 150}, 'gps_lat_lon': {'max_diff': 1e-06, 'period': 6}, 'gps_alt': {'max_diff': 0.0001, 'period': 6}, 't_rad': {'max_diff': 0.0001, 'period': 2}, 'rh_i': {'max_diff': 0.0001, 'period': 2}, 'rh_u': {'max_diff': 0.0001, 'period': 2}, 'rh_l': {'max_diff': 0.0001, 'period': 2}, 'wspd_i': {'max_diff': 0.0001, 'period': 6}, 'wspd_u': {'max_diff': 0.0001, 'period': 6}, 'wspd_l': {'max_diff': 0.0001, 'period': 6}}
2025-09-30 09:23:29,388 [DEBUG] Applying persistent QC in t_i. Filtering 0/134006 samples
2025-09-30 09:23:29,395 [DEBUG] Applying persistent QC in t_u. Filtering 91/134006 samples
2025-09-30 09:23:29,402 [DEBUG] Applying persistent QC in p_i. Filtering 0/134006 samples
2025-09-30 09:23:29,503 [DEBUG] Applying persistent QC in p_u. Filtering 151/134006 samples
2025-09-30 09:23:29,519 [DEBUG] Applying persistent QC in gps_lat_lon. Filtering 0/134006 samples
2025-09-30 09:23:29,527 [DEBUG] Applying persistent QC in gps_alt. Filtering 5/134006 samples
2025-09-30 09:23:29,533 [DEBUG] Applying persistent QC in t_rad. Filtering 1/134006 samples
2025-09-30 09:23:29,538 [DEBUG] Applying persistent QC in rh_i. Filtering 0/134006 samples
2025-09-30 09:23:29,544 [DEBUG] Applying persistent QC in rh_u. Filtering 9/134006 samples
2025-09-30 09:23:29,552 [DEBUG] Applying persistent QC in wspd_i. Filtering 0/134006 samples
2025-09-30 09:23:29,560 [DEBUG] Applying persistent QC in wspd_u. Filtering 108/134006 samples
2025-09-30 09:23:30,228 [INFO] Resampling to 10min
2025-09-30 09:23:30,406 [INFO] Writing to files...
2025-09-30 09:23:34,224 [INFO] Written to L2_test/raw/NUK_Uv3/NUK_Uv3_10min.csv
2025-09-30 09:23:34,224 [INFO] Written to L2_test/raw/NUK_Uv3/NUK_Uv3_10min.nc
2025-09-30 09:23:34,430 [INFO] Resampling to 60min
2025-09-30 09:23:34,506 [INFO] Writing to files...
2025-09-30 09:23:35,299 [INFO] Written to L2_test/raw/NUK_Uv3/NUK_Uv3_hour.csv
2025-09-30 09:23:35,299 [INFO] Written to L2_test/raw/NUK_Uv3/NUK_Uv3_hour.nc
2025-09-30 09:23:35,341 [DEBUG] Could not import boto3, continuing with reduced functionality.
2025-09-30 09:23:35,342 [DEBUG] GDAL data found in package: path='/home/bav/miniforge3/lib/python3.12/site-packages/rasterio/gdal_data'.
2025-09-30 09:23:35,342 [DEBUG] PROJ data found in package: path='/home/bav/miniforge3/lib/python3.12/site-packages/rasterio/proj_data'.
2025-09-30 09:23:35,425 [INFO] NUK_Uv3 array loaded from L2_test/raw/NUK_Uv3/NUK_Uv3_hour.nc
2025-09-30 09:23:35,455 [INFO] NUK_Uv3 array loaded from L2_test/tx/NUK_Uv3/NUK_Uv3_hour.nc
2025-09-30 09:23:35,455 [INFO] Combining L2_test/raw/NUK_Uv3/NUK_Uv3_hour.nc with L2_test/tx/NUK_Uv3/NUK_Uv3_hour.nc...
2025-09-30 09:23:35,562 [INFO] Writing to files...
2025-09-30 09:23:36,781 [INFO] Written to L2_test/level_2/NUK_Uv3/NUK_Uv3_hour.csv
2025-09-30 09:23:36,781 [INFO] Written to L2_test/level_2/NUK_Uv3/NUK_Uv3_hour.nc
2025-09-30 09:23:36,781 [INFO] Files saved to L2_test/level_2/NUK_Uv3...
2025-09-30 09:23:36,821 [WARNING] data_issues_path is missing. Using default data issues path: ../PROMICE-AWS-data-issues
2025-09-30 09:23:38,955 [INFO] processing gps_lat without relocation
2025-09-30 09:23:38,961 [INFO] processing gps_lon without relocation
2025-09-30 09:23:38,965 [INFO] processing gps_alt without relocation
2025-09-30 09:23:38,986 [INFO] Using file: ../PROMICE-AWS-data-issues/adjustments/NUK_Uv3.csv
2025-09-30 09:23:39,000 [DEBUG] ---> 2022-08-19 12:00:00 None z_ice_surf add -0.5
2025-09-30 09:23:39,001 [INFO] Combining surface height
2025-09-30 09:23:39,001 [INFO] -> ablation site
2025-09-30 09:23:39,174 [DEBUG] -> estimating ablation period for each year
2025-09-30 09:23:39,176 [DEBUG] 2020 derived from z_ice_surf
2025-09-30 09:23:39,178 [DEBUG] 2021 derived from z_ice_surf
2025-09-30 09:23:39,180 [DEBUG] 2022 derived from z_ice_surf
2025-09-30 09:23:39,182 [DEBUG] 2023 derived from z_ice_surf
2025-09-30 09:23:39,184 [DEBUG] 2024 derived from z_ice_surf
2025-09-30 09:23:39,186 [DEBUG] 2025 derived from z_ice_surf
2025-09-30 09:23:39,186 [DEBUG] 2020: Ablation from 2020-09-24 05:00:00 to 2020-09-30 23:00:00
2025-09-30 09:23:39,193 [DEBUG] adjusting z to hs1
2025-09-30 09:23:39,194 [DEBUG] adjusting hs2 to z
2025-09-30 09:23:39,194 [DEBUG] using end of melt season
2025-09-30 09:23:39,196 [DEBUG] adjusting hs1
2025-09-30 09:23:39,196 [DEBUG] to hs2, minimizing winter difference
2025-09-30 09:23:39,198 [DEBUG] 2021: Ablation from 2021-06-14 03:00:00 to 2021-09-11 10:00:00
2025-09-30 09:23:39,203 [DEBUG] adjusting hs2 to z
2025-09-30 09:23:39,204 [DEBUG] using end of melt season
2025-09-30 09:23:39,206 [DEBUG] adjusting hs1
2025-09-30 09:23:39,206 [DEBUG] to hs2, minimizing winter difference
2025-09-30 09:23:39,207 [DEBUG] 2022: Ablation from 2022-06-18 18:00:00 to 2022-09-28 23:00:00
2025-09-30 09:23:39,213 [DEBUG] adjusting hs2 to z
2025-09-30 09:23:39,213 [DEBUG] using end of melt season
2025-09-30 09:23:39,215 [DEBUG] adjusting hs1
2025-09-30 09:23:39,215 [DEBUG] to hs2, minimizing winter difference
2025-09-30 09:23:39,216 [DEBUG] 2023: Ablation from 2023-07-03 16:00:00 to 2023-09-23 21:00:00
2025-09-30 09:23:39,222 [DEBUG] adjusting hs2 to z
2025-09-30 09:23:39,222 [DEBUG] using end of melt season
2025-09-30 09:23:39,224 [DEBUG] adjusting hs1
2025-09-30 09:23:39,224 [DEBUG] to hs2, minimizing winter difference
2025-09-30 09:23:39,225 [DEBUG] 2024: Ablation from 2024-06-18 07:00:00 to 2024-09-04 14:00:00
2025-09-30 09:23:39,231 [DEBUG] adjusting hs2 to z
2025-09-30 09:23:39,231 [DEBUG] using end of melt season
2025-09-30 09:23:39,233 [DEBUG] adjusting hs1
2025-09-30 09:23:39,233 [DEBUG] to hs2, minimizing winter difference
2025-09-30 09:23:39,235 [DEBUG] 2025: Ablation from 2025-06-15 05:00:00 to 2025-09-07 08:00:00
2025-09-30 09:23:39,240 [DEBUG] adjusting hs2 to z
2025-09-30 09:23:39,240 [DEBUG] using end of melt season
2025-09-30 09:23:39,242 [DEBUG] adjusting hs1
2025-09-30 09:23:39,242 [DEBUG] to hs2, minimizing winter difference
2025-09-30 09:23:39,260 [INFO] surface height combination finished
2025-09-30 09:23:39,304 [INFO] Calculating thermistor depth
2025-09-30 09:23:39,333 [INFO] interpolating 10 m firn/ice temperature (on hourly values)
2025-09-30 09:23:42,071 [INFO] Resampling to 60min
2025-09-30 09:23:42,179 [INFO] Writing to files...
2025-09-30 09:23:43,526 [INFO] Written to L3_test/stations/NUK_Uv3/NUK_Uv3_hour.csv
2025-09-30 09:23:43,526 [INFO] Written to L3_test/stations/NUK_Uv3/NUK_Uv3_hour.nc
2025-09-30 09:23:43,593 [INFO] Resampling to 1D
2025-09-30 09:23:43,673 [INFO] Writing to files...
2025-09-30 09:23:43,794 [INFO] Written to L3_test/stations/NUK_Uv3/NUK_Uv3_day.csv
2025-09-30 09:23:43,794 [INFO] Written to L3_test/stations/NUK_Uv3/NUK_Uv3_day.nc
2025-09-30 09:23:43,863 [INFO] Resampling to ME
2025-09-30 09:23:43,943 [INFO] Writing to files...
2025-09-30 09:23:44,003 [INFO] Written to L3_test/stations/NUK_Uv3/NUK_Uv3_month.csv
2025-09-30 09:23:44,003 [INFO] Written to L3_test/stations/NUK_Uv3/NUK_Uv3_month.nc
/n ======== test join_l3 ========= 

NUK_Uv3

 ======== test get_l2 ========= 


 ======== test join_l2 ========= 


 ======== test l2tol3 ========= 

