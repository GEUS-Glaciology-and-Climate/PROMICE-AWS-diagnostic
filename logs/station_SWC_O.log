2025-09-30 09:26:54,689 [INFO] AWS(config_file=../aws-l0//tx/config/SWC_O.toml, inpath=../aws-l0//tx/, data_issues_repository=../PROMICE-AWS-data-issues, var_file=None, meta_file=None)
2025-09-30 09:26:55,077 [DEBUG] Source information: {'pypromice': '1.5.1', 'l0_config_file': 'SWC_O.toml:016a28db7b1c6dc223642f5fa4e0a0249a3cdac3', 'l0_data_root': '016a28db7b1c6dc223642f5fa4e0a0249a3cdac3', 'data_issues': 'd1389d62adb1864056bb11f559d4785105b56943'}
2025-09-30 09:26:55,100 [INFO] Detected L0 file type 'csv_default' for ../aws-l0/tx/SWC_O_300534063816770_1.txt
2025-09-30 09:26:55,241 [INFO] L0 data successfully loaded from SWC_O_300534063816770_1.txt
2025-09-30 09:26:55,241 [INFO] Detected L0 file type 'csv_default' for ../aws-l0/tx/SWC_O_300534063816770_2.txt
2025-09-30 09:26:55,285 [INFO] L0 data successfully loaded from SWC_O_300534063816770_2.txt
2025-09-30 09:26:55,301 [INFO] Level 1 processing...
2025-09-30 09:26:55,446 [WARNING] bedrock attribute is not set
2025-09-30 09:26:55,635 [WARNING] bedrock attribute is not set
2025-09-30 09:26:55,751 [INFO] Level 2 processing...
2025-09-30 09:26:55,753 [INFO] Using file: ../PROMICE-AWS-data-issues/adjustments/SWC_O.csv
2025-09-30 09:26:55,757 [INFO] Using file: ../PROMICE-AWS-data-issues/flags/SWC_O.csv
2025-09-30 09:26:55,764 [DEBUG] ---> flagging 2023-09-19T13:00:00.000000000 2022-08-05 00:00:00 t_i_1
2025-09-30 09:26:55,767 [DEBUG] ---> flagging 2023-09-19T13:00:00.000000000 2022-08-05 00:00:00 t_i_2
2025-09-30 09:26:55,769 [DEBUG] ---> flagging 2023-09-19T13:00:00.000000000 2022-08-05 00:00:00 t_i_3
2025-09-30 09:26:55,771 [DEBUG] ---> flagging 2023-09-19T13:00:00.000000000 2022-08-05 00:00:00 t_i_4
2025-09-30 09:26:55,773 [DEBUG] ---> flagging 2023-09-19T13:00:00.000000000 2022-08-05 00:00:00 t_i_5
2025-09-30 09:26:55,775 [DEBUG] ---> flagging 2023-09-19T13:00:00.000000000 2022-08-05 00:00:00 t_i_6
2025-09-30 09:26:55,776 [DEBUG] ---> flagging 2023-09-19T13:00:00.000000000 2022-08-05 00:00:00 t_i_7
2025-09-30 09:26:55,778 [DEBUG] ---> flagging 2023-09-19T13:00:00.000000000 2022-08-05 00:00:00 t_i_8
2025-09-30 09:26:55,782 [DEBUG] ---> flagging 2022-12-03 00:00:00 2025-08-22 00:00:00 t_i_1
2025-09-30 09:26:55,784 [DEBUG] ---> flagging 2022-12-03 00:00:00 2025-08-22 00:00:00 t_i_2
2025-09-30 09:26:55,786 [DEBUG] ---> flagging 2022-12-03 00:00:00 2025-08-22 00:00:00 t_i_3
2025-09-30 09:26:55,788 [DEBUG] ---> flagging 2022-12-03 00:00:00 2025-08-22 00:00:00 t_i_4
2025-09-30 09:26:55,790 [DEBUG] ---> flagging 2022-12-03 00:00:00 2025-08-22 00:00:00 t_i_5
2025-09-30 09:26:55,791 [DEBUG] ---> flagging 2022-12-03 00:00:00 2025-08-22 00:00:00 t_i_6
2025-09-30 09:26:55,793 [DEBUG] ---> flagging 2022-12-03 00:00:00 2025-08-22 00:00:00 t_i_7
2025-09-30 09:26:55,794 [DEBUG] ---> flagging 2022-12-03 00:00:00 2025-08-22 00:00:00 t_i_8
2025-09-30 09:26:55,797 [DEBUG] ---> flagging 2022-12-01 00:00:00 2023-07-01 00:00:00 z_pt_cor
2025-09-30 09:26:55,799 [DEBUG] ---> flagging 2023-06-09 00:00:00 2023-07-16 00:00:00 z_pt_cor
2025-09-30 09:26:55,801 [DEBUG] ---> flagging 2023-09-18 00:00:00 2025-07-22 00:00:00 z_pt_cor
2025-09-30 09:26:55,804 [INFO] Using file: ../PROMICE-AWS-data-issues/adjustments/SWC_O.csv
2025-09-30 09:26:55,811 [DEBUG] ---> None None z_boom_u max_filter 2.8
2025-09-30 09:26:55,811 [INFO] could not adjust z_ice_surf not in dataset
2025-09-30 09:26:55,814 [DEBUG] ---> None None z_pt_cor min_filter 10.0
2025-09-30 09:26:55,814 [INFO] could not adjust z_surf_1 not in dataset
2025-09-30 09:26:55,814 [INFO] could not adjust z_surf_2 not in dataset
2025-09-30 09:26:55,821 [DEBUG] Running persistence_qc using {'t_i': {'max_diff': 0.0001, 'period': 2}, 't_u': {'max_diff': 0.0001, 'period': 2}, 't_l': {'max_diff': 0.0001, 'period': 2}, 'p_i': {'max_diff': 0.0001, 'period': 3}, 'p_u': {'max_diff': 0.0001, 'period': 150}, 'p_l': {'max_diff': 0.0001, 'period': 150}, 'gps_lat_lon': {'max_diff': 1e-06, 'period': 6}, 'gps_alt': {'max_diff': 0.0001, 'period': 6}, 't_rad': {'max_diff': 0.0001, 'period': 2}, 'rh_i': {'max_diff': 0.0001, 'period': 2}, 'rh_u': {'max_diff': 0.0001, 'period': 2}, 'rh_l': {'max_diff': 0.0001, 'period': 2}, 'wspd_i': {'max_diff': 0.0001, 'period': 6}, 'wspd_u': {'max_diff': 0.0001, 'period': 6}, 'wspd_l': {'max_diff': 0.0001, 'period': 6}}
2025-09-30 09:26:55,824 [DEBUG] Applying persistent QC in t_i. Filtering 447/17750 samples
2025-09-30 09:26:55,827 [DEBUG] Applying persistent QC in t_u. Filtering 26/17750 samples
2025-09-30 09:26:55,830 [DEBUG] Applying persistent QC in p_i. Filtering 201/17750 samples
2025-09-30 09:26:55,909 [DEBUG] Applying persistent QC in p_u. Filtering 0/17750 samples
2025-09-30 09:26:55,919 [DEBUG] Applying persistent QC in gps_lat_lon. Filtering 0/17750 samples
2025-09-30 09:26:55,926 [DEBUG] Applying persistent QC in gps_alt. Filtering 6/17750 samples
2025-09-30 09:26:55,931 [DEBUG] Applying persistent QC in t_rad. Filtering 0/17750 samples
2025-09-30 09:26:55,935 [DEBUG] Applying persistent QC in rh_i. Filtering 136/17750 samples
2025-09-30 09:26:55,939 [DEBUG] Applying persistent QC in rh_u. Filtering 135/17750 samples
2025-09-30 09:26:55,945 [DEBUG] Applying persistent QC in wspd_i. Filtering 0/17750 samples
2025-09-30 09:26:55,950 [DEBUG] Applying persistent QC in wspd_u. Filtering 0/17750 samples
2025-09-30 09:26:56,352 [INFO] Resampling to 60min
2025-09-30 09:26:56,430 [INFO] Writing to files...
2025-09-30 09:26:57,131 [INFO] Written to L2_test/tx/SWC_O/SWC_O_hour.csv
2025-09-30 09:26:57,131 [INFO] Written to L2_test/tx/SWC_O/SWC_O_hour.nc
2025-09-30 09:26:57,131 [INFO] AWS(config_file=../aws-l0//raw/config/SWC_O.toml, inpath=../aws-l0//raw/SWC_O/, data_issues_repository=../PROMICE-AWS-data-issues, var_file=None, meta_file=None)
2025-09-30 09:26:57,468 [DEBUG] Source information: {'pypromice': '1.5.1', 'l0_config_file': 'SWC_O.toml:016a28db7b1c6dc223642f5fa4e0a0249a3cdac3', 'l0_data_root': '016a28db7b1c6dc223642f5fa4e0a0249a3cdac3', 'data_issues': 'd1389d62adb1864056bb11f559d4785105b56943'}
2025-09-30 09:26:57,481 [INFO] Detected L0 file type 'toa5' for ../aws-l0/raw/SWC_O/SWC_O_2023_raw.txt
2025-09-30 09:26:57,627 [INFO] Detected L0 file type 'toa5' for ../aws-l0/raw/SWC_O/SWC_O_2023_raw.txt
2025-09-30 09:26:57,848 [INFO] L0 data successfully loaded from SWC_O_2023_raw.txt
2025-09-30 09:26:57,851 [INFO] Detected L0 file type 'toa5' for ../aws-l0/raw/SWC_O/SWC_O_2024_raw.txt
2025-09-30 09:26:57,966 [INFO] Detected L0 file type 'toa5' for ../aws-l0/raw/SWC_O/SWC_O_2024_raw.txt
2025-09-30 09:26:58,145 [INFO] L0 data successfully loaded from SWC_O_2024_raw.txt
2025-09-30 09:26:58,157 [INFO] Level 1 processing...
2025-09-30 09:26:58,254 [WARNING] bedrock attribute is not set
2025-09-30 09:26:58,463 [WARNING] bedrock attribute is not set
2025-09-30 09:26:58,665 [INFO] Level 2 processing...
2025-09-30 09:26:58,670 [INFO] Using file: ../PROMICE-AWS-data-issues/adjustments/SWC_O.csv
2025-09-30 09:26:58,677 [INFO] Using file: ../PROMICE-AWS-data-issues/flags/SWC_O.csv
2025-09-30 09:26:58,682 [DEBUG] ---> flagging 2022-08-02T17:50:00.000000000 2022-08-05 00:00:00 t_i_1
2025-09-30 09:26:58,685 [DEBUG] ---> flagging 2022-08-02T17:50:00.000000000 2022-08-05 00:00:00 t_i_2
2025-09-30 09:26:58,687 [DEBUG] ---> flagging 2022-08-02T17:50:00.000000000 2022-08-05 00:00:00 t_i_3
2025-09-30 09:26:58,688 [DEBUG] ---> flagging 2022-08-02T17:50:00.000000000 2022-08-05 00:00:00 t_i_4
2025-09-30 09:26:58,690 [DEBUG] ---> flagging 2022-08-02T17:50:00.000000000 2022-08-05 00:00:00 t_i_5
2025-09-30 09:26:58,692 [DEBUG] ---> flagging 2022-08-02T17:50:00.000000000 2022-08-05 00:00:00 t_i_6
2025-09-30 09:26:58,694 [DEBUG] ---> flagging 2022-08-02T17:50:00.000000000 2022-08-05 00:00:00 t_i_7
2025-09-30 09:26:58,695 [DEBUG] ---> flagging 2022-08-02T17:50:00.000000000 2022-08-05 00:00:00 t_i_8
2025-09-30 09:26:58,699 [DEBUG] ---> flagging 2022-12-03 00:00:00 2025-08-22 00:00:00 t_i_1
2025-09-30 09:26:58,701 [DEBUG] ---> flagging 2022-12-03 00:00:00 2025-08-22 00:00:00 t_i_2
2025-09-30 09:26:58,703 [DEBUG] ---> flagging 2022-12-03 00:00:00 2025-08-22 00:00:00 t_i_3
2025-09-30 09:26:58,705 [DEBUG] ---> flagging 2022-12-03 00:00:00 2025-08-22 00:00:00 t_i_4
2025-09-30 09:26:58,706 [DEBUG] ---> flagging 2022-12-03 00:00:00 2025-08-22 00:00:00 t_i_5
2025-09-30 09:26:58,708 [DEBUG] ---> flagging 2022-12-03 00:00:00 2025-08-22 00:00:00 t_i_6
2025-09-30 09:26:58,710 [DEBUG] ---> flagging 2022-12-03 00:00:00 2025-08-22 00:00:00 t_i_7
2025-09-30 09:26:58,712 [DEBUG] ---> flagging 2022-12-03 00:00:00 2025-08-22 00:00:00 t_i_8
2025-09-30 09:26:58,714 [DEBUG] ---> flagging 2022-12-01 00:00:00 2023-07-01 00:00:00 z_pt_cor
2025-09-30 09:26:58,716 [DEBUG] ---> flagging 2023-06-09 00:00:00 2023-07-16 00:00:00 z_pt_cor
2025-09-30 09:26:58,718 [DEBUG] ---> flagging 2023-09-18 00:00:00 2025-07-22 00:00:00 z_pt_cor
2025-09-30 09:26:58,724 [INFO] Using file: ../PROMICE-AWS-data-issues/adjustments/SWC_O.csv
2025-09-30 09:26:58,730 [DEBUG] ---> None None z_boom_u max_filter 2.8
2025-09-30 09:26:58,731 [INFO] could not adjust z_ice_surf not in dataset
2025-09-30 09:26:58,732 [DEBUG] ---> None None z_pt_cor min_filter 10.0
2025-09-30 09:26:58,733 [INFO] could not adjust z_surf_1 not in dataset
2025-09-30 09:26:58,733 [INFO] could not adjust z_surf_2 not in dataset
2025-09-30 09:26:58,748 [DEBUG] Running persistence_qc using {'t_i': {'max_diff': 0.0001, 'period': 2}, 't_u': {'max_diff': 0.0001, 'period': 2}, 't_l': {'max_diff': 0.0001, 'period': 2}, 'p_i': {'max_diff': 0.0001, 'period': 3}, 'p_u': {'max_diff': 0.0001, 'period': 150}, 'p_l': {'max_diff': 0.0001, 'period': 150}, 'gps_lat_lon': {'max_diff': 1e-06, 'period': 6}, 'gps_alt': {'max_diff': 0.0001, 'period': 6}, 't_rad': {'max_diff': 0.0001, 'period': 2}, 'rh_i': {'max_diff': 0.0001, 'period': 2}, 'rh_u': {'max_diff': 0.0001, 'period': 2}, 'rh_l': {'max_diff': 0.0001, 'period': 2}, 'wspd_i': {'max_diff': 0.0001, 'period': 6}, 'wspd_u': {'max_diff': 0.0001, 'period': 6}, 'wspd_l': {'max_diff': 0.0001, 'period': 6}}
2025-09-30 09:26:58,753 [DEBUG] Applying persistent QC in t_i. Filtering 0/107828 samples
2025-09-30 09:26:58,758 [DEBUG] Applying persistent QC in t_u. Filtering 189/107828 samples
2025-09-30 09:26:58,764 [DEBUG] Applying persistent QC in p_i. Filtering 0/107828 samples
2025-09-30 09:26:58,842 [DEBUG] Applying persistent QC in p_u. Filtering 0/107828 samples
2025-09-30 09:26:58,856 [DEBUG] Applying persistent QC in gps_lat_lon. Filtering 0/107828 samples
2025-09-30 09:26:58,864 [DEBUG] Applying persistent QC in gps_alt. Filtering 0/107828 samples
2025-09-30 09:26:58,869 [DEBUG] Applying persistent QC in t_rad. Filtering 0/107828 samples
2025-09-30 09:26:58,874 [DEBUG] Applying persistent QC in rh_i. Filtering 0/107828 samples
2025-09-30 09:26:58,879 [DEBUG] Applying persistent QC in rh_u. Filtering 12/107828 samples
2025-09-30 09:26:58,886 [DEBUG] Applying persistent QC in wspd_i. Filtering 0/107828 samples
2025-09-30 09:26:58,893 [DEBUG] Applying persistent QC in wspd_u. Filtering 53/107828 samples
2025-09-30 09:26:59,453 [INFO] Resampling to 10min
2025-09-30 09:26:59,566 [INFO] Writing to files...
2025-09-30 09:27:02,098 [INFO] Written to L2_test/raw/SWC_O/SWC_O_10min.csv
2025-09-30 09:27:02,098 [INFO] Written to L2_test/raw/SWC_O/SWC_O_10min.nc
2025-09-30 09:27:02,304 [INFO] Resampling to 60min
2025-09-30 09:27:02,382 [INFO] Writing to files...
2025-09-30 09:27:03,344 [INFO] Written to L2_test/raw/SWC_O/SWC_O_hour.csv
2025-09-30 09:27:03,344 [INFO] Written to L2_test/raw/SWC_O/SWC_O_hour.nc
2025-09-30 09:27:03,426 [DEBUG] Could not import boto3, continuing with reduced functionality.
2025-09-30 09:27:03,427 [DEBUG] GDAL data found in package: path='/home/bav/miniforge3/lib/python3.12/site-packages/rasterio/gdal_data'.
2025-09-30 09:27:03,428 [DEBUG] PROJ data found in package: path='/home/bav/miniforge3/lib/python3.12/site-packages/rasterio/proj_data'.
2025-09-30 09:27:03,642 [INFO] SWC_O array loaded from L2_test/raw/SWC_O/SWC_O_hour.nc
2025-09-30 09:27:03,704 [INFO] SWC_O array loaded from L2_test/tx/SWC_O/SWC_O_hour.nc
2025-09-30 09:27:03,704 [INFO] Combining L2_test/raw/SWC_O/SWC_O_hour.nc with L2_test/tx/SWC_O/SWC_O_hour.nc...
2025-09-30 09:27:03,895 [INFO] Writing to files...
2025-09-30 09:27:05,096 [INFO] Written to L2_test/level_2/SWC_O/SWC_O_hour.csv
2025-09-30 09:27:05,096 [INFO] Written to L2_test/level_2/SWC_O/SWC_O_hour.nc
2025-09-30 09:27:05,096 [INFO] Files saved to L2_test/level_2/SWC_O...
2025-09-30 09:27:05,137 [WARNING] data_issues_path is missing. Using default data issues path: ../PROMICE-AWS-data-issues
2025-09-30 09:27:07,067 [INFO] processing gps_lat without relocation
2025-09-30 09:27:07,071 [INFO] processing gps_lon without relocation
2025-09-30 09:27:07,074 [INFO] processing gps_alt without relocation
2025-09-30 09:27:07,087 [INFO] Using file: ../PROMICE-AWS-data-issues/adjustments/SWC_O.csv
2025-09-30 09:27:07,095 [DEBUG] ---> 2023-06-09 00:00:00 None z_ice_surf add -0.35
2025-09-30 09:27:07,096 [DEBUG] ---> 2023-09-19 00:00:00 None z_ice_surf add -1.0
2025-09-30 09:27:07,097 [DEBUG] ---> 2025-08-27 08:00:00 None z_ice_surf add 0.9
2025-09-30 09:27:07,099 [DEBUG] ---> 2025-08-07 16:00:00 None z_surf_1 add -0.4
2025-09-30 09:27:07,100 [DEBUG] ---> 2023-09-19 15:00:00 None z_surf_2 add 1.0
2025-09-30 09:27:07,101 [DEBUG] ---> 2025-08-20 16:00:00 None z_surf_2 add -1.0
2025-09-30 09:27:07,102 [INFO] Combining surface height
2025-09-30 09:27:07,102 [INFO] -> ablation site
2025-09-30 09:27:07,211 [DEBUG] -> estimating ablation period for each year
2025-09-30 09:27:07,212 [DEBUG] 2022 derived from z_ice_surf
2025-09-30 09:27:07,213 [DEBUG] 2023 derived from z_ice_surf
2025-09-30 09:27:07,215 [DEBUG] 2024 no z_ice_surf, just using JJA
2025-09-30 09:27:07,216 [DEBUG] 2025 derived from z_ice_surf
2025-09-30 09:27:07,217 [DEBUG] 2022: Ablation from 2022-08-09 04:00:00 to 2022-09-14 06:00:00
2025-09-30 09:27:07,223 [DEBUG] adjusting z to hs1
2025-09-30 09:27:07,224 [DEBUG] adjusting hs2 to z
2025-09-30 09:27:07,224 [DEBUG] using end of melt season
2025-09-30 09:27:07,226 [DEBUG] adjusting hs1
2025-09-30 09:27:07,226 [DEBUG] to hs2, minimizing winter difference
2025-09-30 09:27:07,227 [DEBUG] 2023: Ablation from 2023-07-05 01:00:00 to 2023-08-31 02:00:00
2025-09-30 09:27:07,234 [DEBUG] adjusting hs2 to z
2025-09-30 09:27:07,234 [DEBUG] using end of melt season
2025-09-30 09:27:07,236 [DEBUG] adjusting hs1
2025-09-30 09:27:07,236 [DEBUG] to hs2, minimizing winter difference
2025-09-30 09:27:07,237 [DEBUG] 2024: Ablation from 2024-06-01 00:00:00 to 2024-08-31 23:00:00
2025-09-30 09:27:07,244 [DEBUG] adjusting hs1
2025-09-30 09:27:07,244 [DEBUG] to hs2, minimizing winter difference
2025-09-30 09:27:07,245 [DEBUG] 2025: Ablation from 2025-07-17 14:00:00 to 2025-09-01 14:00:00
2025-09-30 09:27:07,250 [DEBUG] adjusting z to hs1
2025-09-30 09:27:07,251 [DEBUG] adjusting hs2 to z
2025-09-30 09:27:07,251 [DEBUG] using end of melt season
2025-09-30 09:27:07,253 [DEBUG] adjusting hs1
2025-09-30 09:27:07,253 [DEBUG] to hs2, minimizing winter difference
2025-09-30 09:27:07,274 [INFO] surface height combination finished
2025-09-30 09:27:07,303 [INFO] Calculating thermistor depth
2025-09-30 09:27:07,335 [INFO] interpolating 10 m firn/ice temperature (on hourly values)
2025-09-30 09:27:08,320 [INFO] Resampling to 60min
2025-09-30 09:27:08,423 [INFO] Writing to files...
2025-09-30 09:27:09,375 [INFO] Written to L3_test/stations/SWC_O/SWC_O_hour.csv
2025-09-30 09:27:09,375 [INFO] Written to L3_test/stations/SWC_O/SWC_O_hour.nc
2025-09-30 09:27:09,429 [INFO] Resampling to 1D
2025-09-30 09:27:09,509 [INFO] Writing to files...
2025-09-30 09:27:09,614 [INFO] Written to L3_test/stations/SWC_O/SWC_O_day.csv
2025-09-30 09:27:09,615 [INFO] Written to L3_test/stations/SWC_O/SWC_O_day.nc
2025-09-30 09:27:09,664 [INFO] Resampling to ME
2025-09-30 09:27:09,741 [INFO] Writing to files...
2025-09-30 09:27:09,806 [INFO] Written to L3_test/stations/SWC_O/SWC_O_month.csv
2025-09-30 09:27:09,806 [INFO] Written to L3_test/stations/SWC_O/SWC_O_month.nc
/n ======== test join_l3 ========= 

SWC_O

 ======== test get_l2 ========= 


 ======== test join_l2 ========= 


 ======== test l2tol3 ========= 

