2025-09-30 09:28:53,518 [INFO] AWS(config_file=../aws-l0//tx/config/ZAC_Lv3.toml, inpath=../aws-l0//tx/, data_issues_repository=../PROMICE-AWS-data-issues, var_file=None, meta_file=None)
2025-09-30 09:28:53,871 [DEBUG] Source information: {'pypromice': '1.5.1', 'l0_config_file': 'ZAC_Lv3.toml:016a28db7b1c6dc223642f5fa4e0a0249a3cdac3', 'l0_data_root': '016a28db7b1c6dc223642f5fa4e0a0249a3cdac3', 'data_issues': 'd1389d62adb1864056bb11f559d4785105b56943'}
2025-09-30 09:28:53,878 [INFO] Detected L0 file type 'csv_default' for ../aws-l0/tx/ZAC_Lv3_300534060520430_1.txt
2025-09-30 09:28:54,051 [INFO] L0 data successfully loaded from ZAC_Lv3_300534060520430_1.txt
2025-09-30 09:28:54,059 [INFO] Level 1 processing...
2025-09-30 09:28:54,213 [WARNING] bedrock attribute is not set
2025-09-30 09:28:54,365 [INFO] Level 2 processing...
2025-09-30 09:28:54,367 [INFO] Using file: ../PROMICE-AWS-data-issues/adjustments/ZAC_Lv3.csv
2025-09-30 09:28:54,380 [INFO] Using file: ../PROMICE-AWS-data-issues/flags/ZAC_Lv3.csv
2025-09-30 09:28:54,393 [DEBUG] ---> flagging 2023-03-28 00:00:00 2023-04-22 00:00:00 z_stake
2025-09-30 09:28:54,396 [DEBUG] ---> flagging 2022-04-20T15:00:00.000000000 2023-06-24 00:00:00 z_pt_cor
2025-09-30 09:28:54,399 [INFO] Using file: ../PROMICE-AWS-data-issues/adjustments/ZAC_Lv3.csv
2025-09-30 09:28:54,409 [DEBUG] ---> None None z_boom_u max_filter 2.8
2025-09-30 09:28:54,409 [INFO] could not adjust z_ice_surf not in dataset
2025-09-30 09:28:54,412 [DEBUG] ---> 2024-06-01 00:00:00 2024-07-01 00:00:00 z_pt_cor min_filter 13.0
2025-09-30 09:28:54,414 [DEBUG] ---> 2024-07-01 00:00:00 2024-08-01 00:00:00 z_pt_cor min_filter 11.62
2025-09-30 09:28:54,414 [INFO] could not adjust z_surf_2 not in dataset
2025-09-30 09:28:54,421 [DEBUG] Running persistence_qc using {'t_i': {'max_diff': 0.0001, 'period': 2}, 't_u': {'max_diff': 0.0001, 'period': 2}, 't_l': {'max_diff': 0.0001, 'period': 2}, 'p_i': {'max_diff': 0.0001, 'period': 3}, 'p_u': {'max_diff': 0.0001, 'period': 150}, 'p_l': {'max_diff': 0.0001, 'period': 150}, 'gps_lat_lon': {'max_diff': 1e-06, 'period': 6}, 'gps_alt': {'max_diff': 0.0001, 'period': 6}, 't_rad': {'max_diff': 0.0001, 'period': 2}, 'rh_i': {'max_diff': 0.0001, 'period': 2}, 'rh_u': {'max_diff': 0.0001, 'period': 2}, 'rh_l': {'max_diff': 0.0001, 'period': 2}, 'wspd_i': {'max_diff': 0.0001, 'period': 6}, 'wspd_u': {'max_diff': 0.0001, 'period': 6}, 'wspd_l': {'max_diff': 0.0001, 'period': 6}}
2025-09-30 09:28:54,425 [DEBUG] Applying persistent QC in t_i. Filtering 302/21319 samples
2025-09-30 09:28:54,428 [DEBUG] Applying persistent QC in t_u. Filtering 5/21319 samples
2025-09-30 09:28:54,432 [DEBUG] Applying persistent QC in p_i. Filtering 324/21319 samples
2025-09-30 09:28:54,515 [DEBUG] Applying persistent QC in p_u. Filtering 0/21319 samples
2025-09-30 09:28:54,538 [DEBUG] Applying persistent QC in gps_lat_lon. Filtering 56/21319 samples
2025-09-30 09:28:54,547 [DEBUG] Applying persistent QC in gps_alt. Filtering 56/21319 samples
2025-09-30 09:28:54,552 [DEBUG] Applying persistent QC in t_rad. Filtering 3/21319 samples
2025-09-30 09:28:54,556 [DEBUG] Applying persistent QC in rh_i. Filtering 83/21319 samples
2025-09-30 09:28:54,560 [DEBUG] Applying persistent QC in rh_u. Filtering 38/21319 samples
2025-09-30 09:28:54,566 [DEBUG] Applying persistent QC in wspd_i. Filtering 56/21319 samples
2025-09-30 09:28:54,573 [DEBUG] Applying persistent QC in wspd_u. Filtering 0/21319 samples
2025-09-30 09:28:54,991 [INFO] Resampling to 60min
2025-09-30 09:28:55,084 [INFO] Writing to files...
2025-09-30 09:28:56,197 [INFO] Written to L2_test/tx/ZAC_Lv3/ZAC_Lv3_hour.csv
2025-09-30 09:28:56,197 [INFO] Written to L2_test/tx/ZAC_Lv3/ZAC_Lv3_hour.nc
2025-09-30 09:28:56,198 [INFO] AWS(config_file=../aws-l0//raw/config/ZAC_Lv3.toml, inpath=../aws-l0//raw/ZAC_Lv3/, data_issues_repository=../PROMICE-AWS-data-issues, var_file=None, meta_file=None)
2025-09-30 09:28:56,595 [DEBUG] Source information: {'pypromice': '1.5.1', 'l0_config_file': 'ZAC_Lv3.toml:016a28db7b1c6dc223642f5fa4e0a0249a3cdac3', 'l0_data_root': '016a28db7b1c6dc223642f5fa4e0a0249a3cdac3', 'data_issues': 'd1389d62adb1864056bb11f559d4785105b56943'}
2025-09-30 09:28:56,605 [INFO] Detected L0 file type 'toa5' for ../aws-l0/raw/ZAC_Lv3/ZAC_Lv3_2024_raw.txt
2025-09-30 09:28:56,611 [INFO] Detected L0 file type 'toa5' for ../aws-l0/raw/ZAC_Lv3/ZAC_Lv3_2024_raw.txt
2025-09-30 09:28:56,633 [INFO] L0 data successfully loaded from ZAC_Lv3_2024_raw.txt
2025-09-30 09:28:56,638 [INFO] Detected L0 file type 'toa5' for ../aws-l0/raw/ZAC_Lv3/ZAC_Lv3_2025_raw.dat
2025-09-30 09:28:56,767 [INFO] Detected L0 file type 'toa5' for ../aws-l0/raw/ZAC_Lv3/ZAC_Lv3_2025_raw.dat
2025-09-30 09:28:56,957 [INFO] L0 data successfully loaded from ZAC_Lv3_2025_raw.dat
2025-09-30 09:28:56,966 [INFO] Level 1 processing...
2025-09-30 09:28:57,089 [WARNING] bedrock attribute is not set
2025-09-30 09:28:57,274 [WARNING] bedrock attribute is not set
2025-09-30 09:28:57,396 [INFO] Level 2 processing...
2025-09-30 09:28:57,399 [INFO] Using file: ../PROMICE-AWS-data-issues/adjustments/ZAC_Lv3.csv
2025-09-30 09:28:57,410 [INFO] Using file: ../PROMICE-AWS-data-issues/flags/ZAC_Lv3.csv
2025-09-30 09:28:57,414 [DEBUG] ---> flagging 2023-03-28 00:00:00 2023-04-22 00:00:00 z_stake
2025-09-30 09:28:57,417 [DEBUG] ---> flagging 2024-04-20T14:50:00.000000000 2023-06-24 00:00:00 z_pt_cor
2025-09-30 09:28:57,421 [INFO] Using file: ../PROMICE-AWS-data-issues/adjustments/ZAC_Lv3.csv
2025-09-30 09:28:57,428 [DEBUG] ---> None None z_boom_u max_filter 2.8
2025-09-30 09:28:57,428 [INFO] could not adjust z_ice_surf not in dataset
2025-09-30 09:28:57,433 [DEBUG] ---> 2024-06-01 00:00:00 2024-07-01 00:00:00 z_pt_cor min_filter 13.0
2025-09-30 09:28:57,434 [DEBUG] ---> 2024-07-01 00:00:00 2024-08-01 00:00:00 z_pt_cor min_filter 11.62
2025-09-30 09:28:57,435 [INFO] could not adjust z_surf_2 not in dataset
2025-09-30 09:28:57,444 [DEBUG] Running persistence_qc using {'t_i': {'max_diff': 0.0001, 'period': 2}, 't_u': {'max_diff': 0.0001, 'period': 2}, 't_l': {'max_diff': 0.0001, 'period': 2}, 'p_i': {'max_diff': 0.0001, 'period': 3}, 'p_u': {'max_diff': 0.0001, 'period': 150}, 'p_l': {'max_diff': 0.0001, 'period': 150}, 'gps_lat_lon': {'max_diff': 1e-06, 'period': 6}, 'gps_alt': {'max_diff': 0.0001, 'period': 6}, 't_rad': {'max_diff': 0.0001, 'period': 2}, 'rh_i': {'max_diff': 0.0001, 'period': 2}, 'rh_u': {'max_diff': 0.0001, 'period': 2}, 'rh_l': {'max_diff': 0.0001, 'period': 2}, 'wspd_i': {'max_diff': 0.0001, 'period': 6}, 'wspd_u': {'max_diff': 0.0001, 'period': 6}, 'wspd_l': {'max_diff': 0.0001, 'period': 6}}
2025-09-30 09:28:57,449 [DEBUG] Applying persistent QC in t_i. Filtering 0/51988 samples
2025-09-30 09:28:57,453 [DEBUG] Applying persistent QC in t_u. Filtering 0/51988 samples
2025-09-30 09:28:57,458 [DEBUG] Applying persistent QC in p_i. Filtering 0/51988 samples
2025-09-30 09:28:57,527 [DEBUG] Applying persistent QC in p_u. Filtering 0/51988 samples
2025-09-30 09:28:57,538 [DEBUG] Applying persistent QC in gps_lat_lon. Filtering 0/51988 samples
2025-09-30 09:28:57,544 [DEBUG] Applying persistent QC in gps_alt. Filtering 0/51988 samples
2025-09-30 09:28:57,547 [DEBUG] Applying persistent QC in t_rad. Filtering 0/51988 samples
2025-09-30 09:28:57,552 [DEBUG] Applying persistent QC in rh_i. Filtering 0/51988 samples
2025-09-30 09:28:57,556 [DEBUG] Applying persistent QC in rh_u. Filtering 150/51988 samples
2025-09-30 09:28:57,562 [DEBUG] Applying persistent QC in wspd_i. Filtering 0/51988 samples
2025-09-30 09:28:57,567 [DEBUG] Applying persistent QC in wspd_u. Filtering 0/51988 samples
2025-09-30 09:28:57,988 [INFO] Resampling to 10min
2025-09-30 09:28:58,085 [INFO] Writing to files...
2025-09-30 09:28:59,546 [INFO] Written to L2_test/raw/ZAC_Lv3/ZAC_Lv3_10min.csv
2025-09-30 09:28:59,546 [INFO] Written to L2_test/raw/ZAC_Lv3/ZAC_Lv3_10min.nc
2025-09-30 09:28:59,688 [INFO] Resampling to 60min
2025-09-30 09:28:59,753 [INFO] Writing to files...
2025-09-30 09:29:00,095 [INFO] Written to L2_test/raw/ZAC_Lv3/ZAC_Lv3_hour.csv
2025-09-30 09:29:00,096 [INFO] Written to L2_test/raw/ZAC_Lv3/ZAC_Lv3_hour.nc
2025-09-30 09:29:00,143 [DEBUG] Could not import boto3, continuing with reduced functionality.
2025-09-30 09:29:00,144 [DEBUG] GDAL data found in package: path='/home/bav/miniforge3/lib/python3.12/site-packages/rasterio/gdal_data'.
2025-09-30 09:29:00,144 [DEBUG] PROJ data found in package: path='/home/bav/miniforge3/lib/python3.12/site-packages/rasterio/proj_data'.
2025-09-30 09:29:00,225 [INFO] ZAC_Lv3 array loaded from L2_test/raw/ZAC_Lv3/ZAC_Lv3_hour.nc
2025-09-30 09:29:00,255 [INFO] ZAC_Lv3 array loaded from L2_test/tx/ZAC_Lv3/ZAC_Lv3_hour.nc
2025-09-30 09:29:00,256 [INFO] Combining L2_test/raw/ZAC_Lv3/ZAC_Lv3_hour.nc with L2_test/tx/ZAC_Lv3/ZAC_Lv3_hour.nc...
2025-09-30 09:29:00,354 [INFO] Writing to files...
2025-09-30 09:29:01,194 [INFO] Written to L2_test/level_2/ZAC_Lv3/ZAC_Lv3_hour.csv
2025-09-30 09:29:01,194 [INFO] Written to L2_test/level_2/ZAC_Lv3/ZAC_Lv3_hour.nc
2025-09-30 09:29:01,194 [INFO] Files saved to L2_test/level_2/ZAC_Lv3...
2025-09-30 09:29:01,231 [WARNING] data_issues_path is missing. Using default data issues path: ../PROMICE-AWS-data-issues
2025-09-30 09:29:03,033 [INFO] processing gps_lat without relocation
2025-09-30 09:29:03,037 [INFO] processing gps_lon without relocation
2025-09-30 09:29:03,040 [INFO] processing gps_alt without relocation
2025-09-30 09:29:03,054 [INFO] Using file: ../PROMICE-AWS-data-issues/adjustments/ZAC_Lv3.csv
2025-09-30 09:29:03,061 [DEBUG] ---> 2024-04-22 16:00:00 None z_ice_surf add -7.8
2025-09-30 09:29:03,063 [DEBUG] ---> 2024-04-20 16:00:00 None z_surf_2 add -2.8
2025-09-30 09:29:03,064 [INFO] Combining surface height
2025-09-30 09:29:03,065 [INFO] -> ablation site
2025-09-30 09:29:03,172 [DEBUG] -> estimating ablation period for each year
2025-09-30 09:29:03,175 [DEBUG] 2022 no z_ice_surf, just using JJA
2025-09-30 09:29:03,176 [DEBUG] 2023 derived from z_ice_surf
2025-09-30 09:29:03,178 [DEBUG] 2024 derived from z_ice_surf
2025-09-30 09:29:03,179 [DEBUG] 2025 derived from z_ice_surf
2025-09-30 09:29:03,179 [DEBUG] 2022: Ablation from 2022-06-01 00:00:00 to 2022-08-31 23:00:00
2025-09-30 09:29:03,188 [DEBUG] 2023: Ablation from 2023-06-18 17:00:00 to 2023-09-07 01:00:00
2025-09-30 09:29:03,193 [DEBUG] adjusting z to hs1
2025-09-30 09:29:03,194 [DEBUG] adjusting hs2 to z
2025-09-30 09:29:03,194 [DEBUG] using end of melt season
2025-09-30 09:29:03,197 [DEBUG] adjusting hs1
2025-09-30 09:29:03,197 [DEBUG] to hs2, minimizing winter difference
2025-09-30 09:29:03,199 [DEBUG] 2024: Ablation from 2024-06-10 21:00:00 to 2024-08-17 11:00:00
2025-09-30 09:29:03,204 [DEBUG] adjusting hs2 to z
2025-09-30 09:29:03,205 [DEBUG] using end of melt season
2025-09-30 09:29:03,207 [DEBUG] adjusting hs1
2025-09-30 09:29:03,207 [DEBUG] to hs2, minimizing winter difference
2025-09-30 09:29:03,209 [DEBUG] 2025: Ablation from 2025-06-15 19:00:00 to 2025-09-04 23:00:00
2025-09-30 09:29:03,215 [DEBUG] adjusting hs2 to z
2025-09-30 09:29:03,215 [DEBUG] using end of melt season
2025-09-30 09:29:03,217 [DEBUG] adjusting hs1
2025-09-30 09:29:03,217 [DEBUG] to hs2, minimizing winter difference
2025-09-30 09:29:03,238 [INFO] surface height combination finished
2025-09-30 09:29:03,269 [INFO] Calculating thermistor depth
2025-09-30 09:29:03,276 [INFO] No maintenance at ZAC_Lv3
2025-09-30 09:29:03,286 [INFO] interpolating 10 m firn/ice temperature (on hourly values)
2025-09-30 09:29:04,214 [INFO] Resampling to 60min
2025-09-30 09:29:04,316 [INFO] Writing to files...
2025-09-30 09:29:05,232 [INFO] Written to L3_test/stations/ZAC_Lv3/ZAC_Lv3_hour.csv
2025-09-30 09:29:05,233 [INFO] Written to L3_test/stations/ZAC_Lv3/ZAC_Lv3_hour.nc
2025-09-30 09:29:05,286 [INFO] Resampling to 1D
2025-09-30 09:29:05,365 [INFO] Writing to files...
2025-09-30 09:29:05,465 [INFO] Written to L3_test/stations/ZAC_Lv3/ZAC_Lv3_day.csv
2025-09-30 09:29:05,466 [INFO] Written to L3_test/stations/ZAC_Lv3/ZAC_Lv3_day.nc
2025-09-30 09:29:05,511 [INFO] Resampling to ME
2025-09-30 09:29:05,588 [INFO] Writing to files...
2025-09-30 09:29:05,652 [INFO] Written to L3_test/stations/ZAC_Lv3/ZAC_Lv3_month.csv
2025-09-30 09:29:05,652 [INFO] Written to L3_test/stations/ZAC_Lv3/ZAC_Lv3_month.nc
/n ======== test join_l3 ========= 

ZAC_Lv3

 ======== test get_l2 ========= 


 ======== test join_l2 ========= 


 ======== test l2tol3 ========= 

