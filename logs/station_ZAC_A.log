2025-09-30 09:28:53,599 [INFO] AWS(config_file=../aws-l0//tx/config/ZAC_A.toml, inpath=../aws-l0//tx/, data_issues_repository=../PROMICE-AWS-data-issues, var_file=None, meta_file=None)
2025-09-30 09:28:53,996 [DEBUG] Source information: {'pypromice': '1.5.1', 'l0_config_file': 'ZAC_A.toml:016a28db7b1c6dc223642f5fa4e0a0249a3cdac3', 'l0_data_root': '016a28db7b1c6dc223642f5fa4e0a0249a3cdac3', 'data_issues': 'd1389d62adb1864056bb11f559d4785105b56943'}
2025-09-30 09:28:54,005 [INFO] Detected L0 file type 'csv_default' for ../aws-l0/tx/ZAC_A_300534062419950_1.txt
2025-09-30 09:28:54,048 [INFO] L0 data successfully loaded from ZAC_A_300534062419950_1.txt
2025-09-30 09:28:54,052 [INFO] Detected L0 file type 'csv_default' for ../aws-l0/tx/ZAC_A_300534063817770_2.txt
2025-09-30 09:28:54,098 [INFO] L0 data successfully loaded from ZAC_A_300534063817770_2.txt
2025-09-30 09:28:54,108 [INFO] Level 1 processing...
2025-09-30 09:28:54,280 [WARNING] bedrock attribute is not set
2025-09-30 09:28:54,510 [WARNING] bedrock attribute is not set
2025-09-30 09:28:54,641 [INFO] Level 2 processing...
2025-09-30 09:28:54,642 [INFO] Using file: ../PROMICE-AWS-data-issues/adjustments/ZAC_A.csv
2025-09-30 09:28:54,642 [INFO] No ../PROMICE-AWS-data-issues/adjustments/ZAC_A.csv file to read.
2025-09-30 09:28:54,642 [INFO] Using file: ../PROMICE-AWS-data-issues/flags/ZAC_A.csv
2025-09-30 09:28:54,651 [DEBUG] ---> flagging 2023-11-20 00:00:00 2024-04-23 00:00:00 z_boom_u
2025-09-30 09:28:54,653 [DEBUG] ---> flagging 2023-11-20 00:00:00 2024-04-23 00:00:00 z_boom_l
2025-09-30 09:28:54,655 [DEBUG] ---> flagging 2023-11-20 00:00:00 2024-04-23 00:00:00 dsr
2025-09-30 09:28:54,657 [DEBUG] ---> flagging 2023-11-20 00:00:00 2024-04-23 00:00:00 usr
2025-09-30 09:28:54,659 [DEBUG] ---> flagging 2023-11-20 00:00:00 2024-04-23 00:00:00 dlr
2025-09-30 09:28:54,660 [DEBUG] ---> flagging 2023-11-20 00:00:00 2024-04-23 00:00:00 ulr
2025-09-30 09:28:54,667 [INFO] Using file: ../PROMICE-AWS-data-issues/adjustments/ZAC_A.csv
2025-09-30 09:28:54,667 [INFO] No ../PROMICE-AWS-data-issues/adjustments/ZAC_A.csv file to read.
2025-09-30 09:28:54,672 [DEBUG] Running persistence_qc using {'t_i': {'max_diff': 0.0001, 'period': 2}, 't_u': {'max_diff': 0.0001, 'period': 2}, 't_l': {'max_diff': 0.0001, 'period': 2}, 'p_i': {'max_diff': 0.0001, 'period': 3}, 'p_u': {'max_diff': 0.0001, 'period': 150}, 'p_l': {'max_diff': 0.0001, 'period': 150}, 'gps_lat_lon': {'max_diff': 1e-06, 'period': 6}, 'gps_alt': {'max_diff': 0.0001, 'period': 6}, 't_rad': {'max_diff': 0.0001, 'period': 2}, 'rh_i': {'max_diff': 0.0001, 'period': 2}, 'rh_u': {'max_diff': 0.0001, 'period': 2}, 'rh_l': {'max_diff': 0.0001, 'period': 2}, 'wspd_i': {'max_diff': 0.0001, 'period': 6}, 'wspd_u': {'max_diff': 0.0001, 'period': 6}, 'wspd_l': {'max_diff': 0.0001, 'period': 6}}
2025-09-30 09:28:54,680 [DEBUG] Applying persistent QC in t_i. Filtering 73/3563 samples
2025-09-30 09:28:54,684 [DEBUG] Applying persistent QC in t_u. Filtering 5/3563 samples
2025-09-30 09:28:54,686 [DEBUG] Applying persistent QC in t_l. Filtering 1/3563 samples
2025-09-30 09:28:54,689 [DEBUG] Applying persistent QC in p_i. Filtering 70/3563 samples
2025-09-30 09:28:54,786 [DEBUG] Applying persistent QC in p_u. Filtering 3/3563 samples
2025-09-30 09:28:54,888 [DEBUG] Applying persistent QC in p_l. Filtering 0/3563 samples
2025-09-30 09:28:54,905 [DEBUG] Applying persistent QC in gps_lat_lon. Filtering 10/3563 samples
2025-09-30 09:28:54,909 [DEBUG] Applying persistent QC in gps_alt. Filtering 10/3563 samples
2025-09-30 09:28:54,916 [DEBUG] Applying persistent QC in t_rad. Filtering 0/3563 samples
2025-09-30 09:28:54,923 [DEBUG] Applying persistent QC in rh_i. Filtering 24/3563 samples
2025-09-30 09:28:54,926 [DEBUG] Applying persistent QC in rh_u. Filtering 43/3563 samples
2025-09-30 09:28:54,929 [DEBUG] Applying persistent QC in rh_l. Filtering 22/3563 samples
2025-09-30 09:28:54,938 [DEBUG] Applying persistent QC in wspd_i. Filtering 10/3563 samples
2025-09-30 09:28:54,945 [DEBUG] Applying persistent QC in wspd_u. Filtering 0/3563 samples
2025-09-30 09:28:54,949 [DEBUG] Applying persistent QC in wspd_l. Filtering 0/3563 samples
2025-09-30 09:28:55,597 [INFO] Resampling to 60min
2025-09-30 09:28:55,717 [INFO] Writing to files...
2025-09-30 09:28:56,388 [INFO] Written to L2_test/tx/ZAC_A/ZAC_A_hour.csv
2025-09-30 09:28:56,389 [INFO] Written to L2_test/tx/ZAC_A/ZAC_A_hour.nc
2025-09-30 09:28:56,389 [INFO] AWS(config_file=../aws-l0//raw/config/ZAC_A.toml, inpath=../aws-l0//raw/ZAC_A/, data_issues_repository=../PROMICE-AWS-data-issues, var_file=None, meta_file=None)
2025-09-30 09:28:56,737 [DEBUG] Source information: {'pypromice': '1.5.1', 'l0_config_file': 'ZAC_A.toml:016a28db7b1c6dc223642f5fa4e0a0249a3cdac3', 'l0_data_root': '016a28db7b1c6dc223642f5fa4e0a0249a3cdac3', 'data_issues': 'd1389d62adb1864056bb11f559d4785105b56943'}
2025-09-30 09:28:56,750 [INFO] Detected L0 file type 'toa5' for ../aws-l0/raw/ZAC_A/ZAC_A_2024_raw.txt
2025-09-30 09:28:56,918 [INFO] Detected L0 file type 'toa5' for ../aws-l0/raw/ZAC_A/ZAC_A_2024_raw.txt
2025-09-30 09:28:57,161 [INFO] L0 data successfully loaded from ZAC_A_2024_raw.txt
2025-09-30 09:28:57,166 [INFO] Detected L0 file type 'toa5' for ../aws-l0/raw/ZAC_A/ZAC_A_2025_raw.dat
2025-09-30 09:28:57,272 [INFO] Detected L0 file type 'toa5' for ../aws-l0/raw/ZAC_A/ZAC_A_2025_raw.dat
2025-09-30 09:28:57,506 [INFO] L0 data successfully loaded from ZAC_A_2025_raw.dat
2025-09-30 09:28:57,516 [INFO] Level 1 processing...
2025-09-30 09:28:57,615 [WARNING] bedrock attribute is not set
2025-09-30 09:28:57,934 [WARNING] bedrock attribute is not set
2025-09-30 09:28:58,187 [INFO] Level 2 processing...
2025-09-30 09:28:58,193 [INFO] Using file: ../PROMICE-AWS-data-issues/adjustments/ZAC_A.csv
2025-09-30 09:28:58,193 [INFO] No ../PROMICE-AWS-data-issues/adjustments/ZAC_A.csv file to read.
2025-09-30 09:28:58,200 [INFO] Using file: ../PROMICE-AWS-data-issues/flags/ZAC_A.csv
2025-09-30 09:28:58,204 [DEBUG] ---> flagging 2023-11-20 00:00:00 2024-04-23 00:00:00 z_boom_u
2025-09-30 09:28:58,207 [DEBUG] ---> flagging 2023-11-20 00:00:00 2024-04-23 00:00:00 z_boom_l
2025-09-30 09:28:58,209 [DEBUG] ---> flagging 2023-11-20 00:00:00 2024-04-23 00:00:00 dsr
2025-09-30 09:28:58,211 [DEBUG] ---> flagging 2023-11-20 00:00:00 2024-04-23 00:00:00 usr
2025-09-30 09:28:58,213 [DEBUG] ---> flagging 2023-11-20 00:00:00 2024-04-23 00:00:00 dlr
2025-09-30 09:28:58,215 [DEBUG] ---> flagging 2023-11-20 00:00:00 2024-04-23 00:00:00 ulr
2025-09-30 09:28:58,221 [INFO] Using file: ../PROMICE-AWS-data-issues/adjustments/ZAC_A.csv
2025-09-30 09:28:58,222 [INFO] No ../PROMICE-AWS-data-issues/adjustments/ZAC_A.csv file to read.
2025-09-30 09:28:58,238 [DEBUG] Running persistence_qc using {'t_i': {'max_diff': 0.0001, 'period': 2}, 't_u': {'max_diff': 0.0001, 'period': 2}, 't_l': {'max_diff': 0.0001, 'period': 2}, 'p_i': {'max_diff': 0.0001, 'period': 3}, 'p_u': {'max_diff': 0.0001, 'period': 150}, 'p_l': {'max_diff': 0.0001, 'period': 150}, 'gps_lat_lon': {'max_diff': 1e-06, 'period': 6}, 'gps_alt': {'max_diff': 0.0001, 'period': 6}, 't_rad': {'max_diff': 0.0001, 'period': 2}, 'rh_i': {'max_diff': 0.0001, 'period': 2}, 'rh_u': {'max_diff': 0.0001, 'period': 2}, 'rh_l': {'max_diff': 0.0001, 'period': 2}, 'wspd_i': {'max_diff': 0.0001, 'period': 6}, 'wspd_u': {'max_diff': 0.0001, 'period': 6}, 'wspd_l': {'max_diff': 0.0001, 'period': 6}}
2025-09-30 09:28:58,243 [DEBUG] Applying persistent QC in t_i. Filtering 0/103986 samples
2025-09-30 09:28:58,248 [DEBUG] Applying persistent QC in t_u. Filtering 96/103986 samples
2025-09-30 09:28:58,254 [DEBUG] Applying persistent QC in t_l. Filtering 58/103986 samples
2025-09-30 09:28:58,260 [DEBUG] Applying persistent QC in p_i. Filtering 0/103986 samples
2025-09-30 09:28:58,343 [DEBUG] Applying persistent QC in p_u. Filtering 0/103986 samples
2025-09-30 09:28:58,421 [DEBUG] Applying persistent QC in p_l. Filtering 33542/103986 samples
2025-09-30 09:28:58,435 [DEBUG] Applying persistent QC in gps_lat_lon. Filtering 50252/103986 samples
2025-09-30 09:28:58,443 [DEBUG] Applying persistent QC in gps_alt. Filtering 50252/103986 samples
2025-09-30 09:28:58,448 [DEBUG] Applying persistent QC in t_rad. Filtering 0/103986 samples
2025-09-30 09:28:58,453 [DEBUG] Applying persistent QC in rh_i. Filtering 0/103986 samples
2025-09-30 09:28:58,458 [DEBUG] Applying persistent QC in rh_u. Filtering 36/103986 samples
2025-09-30 09:28:58,463 [DEBUG] Applying persistent QC in rh_l. Filtering 38/103986 samples
2025-09-30 09:28:58,471 [DEBUG] Applying persistent QC in wspd_i. Filtering 0/103986 samples
2025-09-30 09:28:58,478 [DEBUG] Applying persistent QC in wspd_u. Filtering 2285/103986 samples
2025-09-30 09:28:58,484 [DEBUG] Applying persistent QC in wspd_l. Filtering 34644/103986 samples
2025-09-30 09:28:59,231 [INFO] Resampling to 10min
2025-09-30 09:28:59,369 [INFO] Writing to files...
2025-09-30 09:29:02,516 [INFO] Written to L2_test/raw/ZAC_A/ZAC_A_10min.csv
2025-09-30 09:29:02,517 [INFO] Written to L2_test/raw/ZAC_A/ZAC_A_10min.nc
2025-09-30 09:29:02,746 [INFO] Resampling to 60min
2025-09-30 09:29:02,832 [INFO] Writing to files...
2025-09-30 09:29:03,627 [INFO] Written to L2_test/raw/ZAC_A/ZAC_A_hour.csv
2025-09-30 09:29:03,627 [INFO] Written to L2_test/raw/ZAC_A/ZAC_A_hour.nc
2025-09-30 09:29:03,683 [DEBUG] Could not import boto3, continuing with reduced functionality.
2025-09-30 09:29:03,683 [DEBUG] GDAL data found in package: path='/home/bav/miniforge3/lib/python3.12/site-packages/rasterio/gdal_data'.
2025-09-30 09:29:03,684 [DEBUG] PROJ data found in package: path='/home/bav/miniforge3/lib/python3.12/site-packages/rasterio/proj_data'.
2025-09-30 09:29:03,800 [INFO] ZAC_A array loaded from L2_test/raw/ZAC_A/ZAC_A_hour.nc
2025-09-30 09:29:03,841 [INFO] ZAC_A array loaded from L2_test/tx/ZAC_A/ZAC_A_hour.nc
2025-09-30 09:29:03,842 [INFO] Combining L2_test/raw/ZAC_A/ZAC_A_hour.nc with L2_test/tx/ZAC_A/ZAC_A_hour.nc...
2025-09-30 09:29:03,967 [INFO] Writing to files...
2025-09-30 09:29:04,745 [INFO] Written to L2_test/level_2/ZAC_A/ZAC_A_hour.csv
2025-09-30 09:29:04,745 [INFO] Written to L2_test/level_2/ZAC_A/ZAC_A_hour.nc
2025-09-30 09:29:04,745 [INFO] Files saved to L2_test/level_2/ZAC_A...
2025-09-30 09:29:04,788 [WARNING] data_issues_path is missing. Using default data issues path: ../PROMICE-AWS-data-issues
2025-09-30 09:29:08,008 [INFO] processing gps_lat without relocation
2025-09-30 09:29:08,011 [INFO] processing gps_lon without relocation
2025-09-30 09:29:08,014 [INFO] processing gps_alt without relocation
2025-09-30 09:29:08,028 [INFO] Using file: ../PROMICE-AWS-data-issues/adjustments/ZAC_A.csv
2025-09-30 09:29:08,028 [INFO] No ../PROMICE-AWS-data-issues/adjustments/ZAC_A.csv file to read.
2025-09-30 09:29:08,029 [INFO] Combining surface height
2025-09-30 09:29:08,029 [INFO] -> did not find z_ice_surf
2025-09-30 09:29:08,029 [INFO] -> no z_pt or accumulation site: averaging z_surf_1 and z_surf_2
2025-09-30 09:29:08,064 [INFO] Calculating thermistor depth
2025-09-30 09:29:08,091 [INFO] interpolating 10 m firn/ice temperature (on hourly values)
2025-09-30 09:29:10,450 [INFO] Resampling to 60min
2025-09-30 09:29:10,570 [INFO] Writing to files...
2025-09-30 09:29:11,284 [INFO] Written to L3_test/stations/ZAC_A/ZAC_A_hour.csv
2025-09-30 09:29:11,284 [INFO] Written to L3_test/stations/ZAC_A/ZAC_A_hour.nc
2025-09-30 09:29:11,343 [INFO] Resampling to 1D
2025-09-30 09:29:11,448 [INFO] Writing to files...
2025-09-30 09:29:11,548 [INFO] Written to L3_test/stations/ZAC_A/ZAC_A_day.csv
2025-09-30 09:29:11,548 [INFO] Written to L3_test/stations/ZAC_A/ZAC_A_day.nc
2025-09-30 09:29:11,608 [INFO] Resampling to ME
2025-09-30 09:29:11,712 [INFO] Writing to files...
2025-09-30 09:29:11,780 [INFO] Written to L3_test/stations/ZAC_A/ZAC_A_month.csv
2025-09-30 09:29:11,780 [INFO] Written to L3_test/stations/ZAC_A/ZAC_A_month.nc
/n ======== test join_l3 ========= 

ZAC_A

 ======== test get_l2 ========= 


 ======== test join_l2 ========= 


 ======== test l2tol3 ========= 

