2025-09-30 09:24:34,422 [INFO] AWS(config_file=../aws-l0//tx/config/QAS_Lv3.toml, inpath=../aws-l0//tx/, data_issues_repository=../PROMICE-AWS-data-issues, var_file=None, meta_file=None)
2025-09-30 09:24:34,820 [DEBUG] Source information: {'pypromice': '1.5.1', 'l0_config_file': 'QAS_Lv3.toml:016a28db7b1c6dc223642f5fa4e0a0249a3cdac3', 'l0_data_root': '016a28db7b1c6dc223642f5fa4e0a0249a3cdac3', 'data_issues': 'd1389d62adb1864056bb11f559d4785105b56943'}
2025-09-30 09:24:34,832 [INFO] Detected L0 file type 'csv_default' for ../aws-l0/tx/QAS_Lv3_300534063815540_1-F.txt
2025-09-30 09:24:34,901 [INFO] L0 data successfully loaded from QAS_Lv3_300534063815540_1-F.txt
2025-09-30 09:24:34,905 [INFO] Detected L0 file type 'csv_default' for ../aws-l0/tx/QAS_Lv3_300534063815540_1.txt
2025-09-30 09:24:34,922 [INFO] L0 data successfully loaded from QAS_Lv3_300534063815540_1.txt
2025-09-30 09:24:34,925 [INFO] Detected L0 file type 'csv_default' for ../aws-l0/tx/QAS_Lv3_300534063815540_2.txt
2025-09-30 09:24:34,941 [INFO] L0 data successfully loaded from QAS_Lv3_300534063815540_2.txt
2025-09-30 09:24:34,944 [INFO] Detected L0 file type 'csv_default' for ../aws-l0/tx/QAS_Lv3_300534063815540_4.txt
2025-09-30 09:24:35,008 [INFO] L0 data successfully loaded from QAS_Lv3_300534063815540_4.txt
2025-09-30 09:24:35,012 [INFO] Detected L0 file type 'csv_default' for ../aws-l0/tx/QAS_Lv3_300534063815540_5.txt
2025-09-30 09:24:35,070 [INFO] L0 data successfully loaded from QAS_Lv3_300534063815540_5.txt
2025-09-30 09:24:35,071 [INFO] Detected L0 file type 'csv_default' for ../aws-l0/tx/QAS_Lv3_300234061627590_6.txt
2025-09-30 09:24:35,088 [INFO] L0 data successfully loaded from QAS_Lv3_300234061627590_6.txt
2025-09-30 09:24:35,117 [INFO] Level 1 processing...
2025-09-30 09:24:35,235 [WARNING] bedrock attribute is not set
2025-09-30 09:24:35,236 [INFO] ERROR: Incorrect metadata: "pt_antifreeze" = 1. Antifreeze mix only supported at 50% or 100%
2025-09-30 09:24:35,411 [WARNING] bedrock attribute is not set
2025-09-30 09:24:35,412 [INFO] ERROR: Incorrect metadata: "pt_antifreeze" = 1. Antifreeze mix only supported at 50% or 100%
2025-09-30 09:24:35,636 [WARNING] bedrock attribute is not set
2025-09-30 09:24:35,637 [INFO] ERROR: Incorrect metadata: "pt_antifreeze" = 1. Antifreeze mix only supported at 50% or 100%
2025-09-30 09:24:35,809 [WARNING] bedrock attribute is not set
2025-09-30 09:24:35,809 [INFO] ERROR: Incorrect metadata: "pt_antifreeze" = 1. Antifreeze mix only supported at 50% or 100%
2025-09-30 09:24:36,056 [WARNING] bedrock attribute is not set
2025-09-30 09:24:36,288 [WARNING] bedrock attribute is not set
2025-09-30 09:24:36,522 [INFO] Level 2 processing...
2025-09-30 09:24:36,524 [INFO] Using file: ../PROMICE-AWS-data-issues/adjustments/QAS_Lv3.csv
2025-09-30 09:24:36,528 [INFO] Using file: ../PROMICE-AWS-data-issues/flags/QAS_Lv3.csv
2025-09-30 09:24:36,534 [DEBUG] ---> flagging 2022-08-29T18:00:00.000000000 2024-09-01 12:00:00 t_i_1
2025-09-30 09:24:36,536 [DEBUG] ---> flagging 2022-08-29T18:00:00.000000000 2024-09-01 12:00:00 t_i_2
2025-09-30 09:24:36,537 [DEBUG] ---> flagging 2022-08-29T18:00:00.000000000 2024-09-01 12:00:00 t_i_3
2025-09-30 09:24:36,539 [DEBUG] ---> flagging 2022-08-29T18:00:00.000000000 2024-09-01 12:00:00 t_i_4
2025-09-30 09:24:36,540 [DEBUG] ---> flagging 2022-08-29T18:00:00.000000000 2024-09-01 12:00:00 t_i_5
2025-09-30 09:24:36,542 [DEBUG] ---> flagging 2022-08-29T18:00:00.000000000 2024-09-01 12:00:00 t_i_6
2025-09-30 09:24:36,544 [DEBUG] ---> flagging 2022-08-29T18:00:00.000000000 2024-09-01 12:00:00 t_i_7
2025-09-30 09:24:36,545 [DEBUG] ---> flagging 2022-08-29T18:00:00.000000000 2024-09-01 12:00:00 t_i_8
2025-09-30 09:24:36,548 [DEBUG] ---> flagging 2025-09-01 12:00:00 2025-09-28T12:00:00.000000000 t_i_1
2025-09-30 09:24:36,550 [DEBUG] ---> flagging 2025-09-01 12:00:00 2025-09-28T12:00:00.000000000 t_i_2
2025-09-30 09:24:36,552 [DEBUG] ---> flagging 2025-09-01 12:00:00 2025-09-28T12:00:00.000000000 t_i_3
2025-09-30 09:24:36,553 [DEBUG] ---> flagging 2025-09-01 12:00:00 2025-09-28T12:00:00.000000000 t_i_4
2025-09-30 09:24:36,555 [DEBUG] ---> flagging 2025-09-01 12:00:00 2025-09-28T12:00:00.000000000 t_i_5
2025-09-30 09:24:36,556 [DEBUG] ---> flagging 2025-09-01 12:00:00 2025-09-28T12:00:00.000000000 t_i_6
2025-09-30 09:24:36,558 [DEBUG] ---> flagging 2025-09-01 12:00:00 2025-09-28T12:00:00.000000000 t_i_7
2025-09-30 09:24:36,559 [DEBUG] ---> flagging 2025-09-01 12:00:00 2025-09-28T12:00:00.000000000 t_i_8
2025-09-30 09:24:36,562 [DEBUG] ---> flagging 2023-08-28 00:00:00 2023-09-01 14:00:00 z_stake
2025-09-30 09:24:36,564 [DEBUG] ---> flagging 2022-08-29T18:00:00.000000000 2025-09-28T12:00:00.000000000 z_pt_cor
2025-09-30 09:24:36,568 [INFO] Using file: ../PROMICE-AWS-data-issues/adjustments/QAS_Lv3.csv
2025-09-30 09:24:36,575 [DEBUG] ---> None None z_boom_u max_filter 2.8
2025-09-30 09:24:36,578 [DEBUG] ---> None 2023-03-01 00:00:00 z_boom_u min_filter 2.4
2025-09-30 09:24:36,580 [DEBUG] ---> 2023-08-01 00:00:00 2023-09-01 14:00:00 z_stake max_filter 6.65
2025-09-30 09:24:36,581 [INFO] could not adjust z_surf_2 not in dataset
2025-09-30 09:24:36,588 [DEBUG] Running persistence_qc using {'t_i': {'max_diff': 0.0001, 'period': 2}, 't_u': {'max_diff': 0.0001, 'period': 2}, 't_l': {'max_diff': 0.0001, 'period': 2}, 'p_i': {'max_diff': 0.0001, 'period': 3}, 'p_u': {'max_diff': 0.0001, 'period': 150}, 'p_l': {'max_diff': 0.0001, 'period': 150}, 'gps_lat_lon': {'max_diff': 1e-06, 'period': 6}, 'gps_alt': {'max_diff': 0.0001, 'period': 6}, 't_rad': {'max_diff': 0.0001, 'period': 2}, 'rh_i': {'max_diff': 0.0001, 'period': 2}, 'rh_u': {'max_diff': 0.0001, 'period': 2}, 'rh_l': {'max_diff': 0.0001, 'period': 2}, 'wspd_i': {'max_diff': 0.0001, 'period': 6}, 'wspd_u': {'max_diff': 0.0001, 'period': 6}, 'wspd_l': {'max_diff': 0.0001, 'period': 6}}
2025-09-30 09:24:36,592 [DEBUG] Applying persistent QC in t_i. Filtering 423/27012 samples
2025-09-30 09:24:36,595 [DEBUG] Applying persistent QC in t_u. Filtering 24/27012 samples
2025-09-30 09:24:36,599 [DEBUG] Applying persistent QC in p_i. Filtering 198/27012 samples
2025-09-30 09:24:36,660 [DEBUG] Applying persistent QC in p_u. Filtering 0/27012 samples
2025-09-30 09:24:36,669 [DEBUG] Applying persistent QC in gps_lat_lon. Filtering 0/27012 samples
2025-09-30 09:24:36,674 [DEBUG] Applying persistent QC in gps_alt. Filtering 0/27012 samples
2025-09-30 09:24:36,677 [DEBUG] Applying persistent QC in t_rad. Filtering 0/27012 samples
2025-09-30 09:24:36,680 [DEBUG] Applying persistent QC in rh_i. Filtering 38/27012 samples
2025-09-30 09:24:36,683 [DEBUG] Applying persistent QC in rh_u. Filtering 24/27012 samples
2025-09-30 09:24:36,688 [DEBUG] Applying persistent QC in wspd_i. Filtering 120/27012 samples
2025-09-30 09:24:36,693 [DEBUG] Applying persistent QC in wspd_u. Filtering 104/27012 samples
2025-09-30 09:24:37,072 [INFO] Resampling to 60min
2025-09-30 09:24:37,151 [INFO] Writing to files...
2025-09-30 09:24:38,131 [INFO] Written to L2_test/tx/QAS_Lv3/QAS_Lv3_hour.csv
2025-09-30 09:24:38,131 [INFO] Written to L2_test/tx/QAS_Lv3/QAS_Lv3_hour.nc
2025-09-30 09:24:38,133 [INFO] AWS(config_file=../aws-l0//raw/config/QAS_Lv3.toml, inpath=../aws-l0//raw/QAS_Lv3/, data_issues_repository=../PROMICE-AWS-data-issues, var_file=None, meta_file=None)
2025-09-30 09:24:38,456 [DEBUG] Source information: {'pypromice': '1.5.1', 'l0_config_file': 'QAS_Lv3.toml:016a28db7b1c6dc223642f5fa4e0a0249a3cdac3', 'l0_data_root': '016a28db7b1c6dc223642f5fa4e0a0249a3cdac3', 'data_issues': 'd1389d62adb1864056bb11f559d4785105b56943'}
2025-09-30 09:24:38,464 [INFO] Detected L0 file type 'toa5' for ../aws-l0/raw/QAS_Lv3/QAS_Lv3_2024_raw.txt
2025-09-30 09:24:38,557 [INFO] Detected L0 file type 'toa5' for ../aws-l0/raw/QAS_Lv3/QAS_Lv3_2024_raw.txt
2025-09-30 09:24:38,737 [INFO] L0 data successfully loaded from QAS_Lv3_2024_raw.txt
2025-09-30 09:24:38,742 [INFO] Level 1 processing...
2025-09-30 09:24:38,841 [WARNING] bedrock attribute is not set
2025-09-30 09:24:38,842 [INFO] ERROR: Incorrect metadata: "pt_antifreeze" = 1. Antifreeze mix only supported at 50% or 100%
2025-09-30 09:24:38,936 [INFO] Level 2 processing...
2025-09-30 09:24:38,938 [INFO] Using file: ../PROMICE-AWS-data-issues/adjustments/QAS_Lv3.csv
2025-09-30 09:24:38,942 [INFO] Using file: ../PROMICE-AWS-data-issues/flags/QAS_Lv3.csv
2025-09-30 09:24:38,947 [DEBUG] ---> flagging 2023-09-01T17:00:00.000000000 2024-09-01 12:00:00 t_i_1
2025-09-30 09:24:38,948 [DEBUG] ---> flagging 2023-09-01T17:00:00.000000000 2024-09-01 12:00:00 t_i_2
2025-09-30 09:24:38,950 [DEBUG] ---> flagging 2023-09-01T17:00:00.000000000 2024-09-01 12:00:00 t_i_3
2025-09-30 09:24:38,952 [DEBUG] ---> flagging 2023-09-01T17:00:00.000000000 2024-09-01 12:00:00 t_i_4
2025-09-30 09:24:38,953 [DEBUG] ---> flagging 2023-09-01T17:00:00.000000000 2024-09-01 12:00:00 t_i_5
2025-09-30 09:24:38,955 [DEBUG] ---> flagging 2023-09-01T17:00:00.000000000 2024-09-01 12:00:00 t_i_6
2025-09-30 09:24:38,956 [DEBUG] ---> flagging 2023-09-01T17:00:00.000000000 2024-09-01 12:00:00 t_i_7
2025-09-30 09:24:38,958 [DEBUG] ---> flagging 2023-09-01T17:00:00.000000000 2024-09-01 12:00:00 t_i_8
2025-09-30 09:24:38,961 [DEBUG] ---> flagging 2025-09-01 12:00:00 2024-09-01T10:50:00.000000000 t_i_1
2025-09-30 09:24:38,963 [DEBUG] ---> flagging 2025-09-01 12:00:00 2024-09-01T10:50:00.000000000 t_i_2
2025-09-30 09:24:38,964 [DEBUG] ---> flagging 2025-09-01 12:00:00 2024-09-01T10:50:00.000000000 t_i_3
2025-09-30 09:24:38,966 [DEBUG] ---> flagging 2025-09-01 12:00:00 2024-09-01T10:50:00.000000000 t_i_4
2025-09-30 09:24:38,967 [DEBUG] ---> flagging 2025-09-01 12:00:00 2024-09-01T10:50:00.000000000 t_i_5
2025-09-30 09:24:38,969 [DEBUG] ---> flagging 2025-09-01 12:00:00 2024-09-01T10:50:00.000000000 t_i_6
2025-09-30 09:24:38,970 [DEBUG] ---> flagging 2025-09-01 12:00:00 2024-09-01T10:50:00.000000000 t_i_7
2025-09-30 09:24:38,972 [DEBUG] ---> flagging 2025-09-01 12:00:00 2024-09-01T10:50:00.000000000 t_i_8
2025-09-30 09:24:38,974 [DEBUG] ---> flagging 2023-08-28 00:00:00 2023-09-01 14:00:00 z_stake
2025-09-30 09:24:38,976 [DEBUG] ---> flagging 2023-09-01T17:00:00.000000000 2024-09-01T10:50:00.000000000 z_pt_cor
2025-09-30 09:24:38,980 [INFO] Using file: ../PROMICE-AWS-data-issues/adjustments/QAS_Lv3.csv
2025-09-30 09:24:38,986 [DEBUG] ---> None None z_boom_u max_filter 2.8
2025-09-30 09:24:38,988 [INFO] ---> None 2023-03-01 00:00:00 z_boom_u min_filter 2.4
2025-09-30 09:24:38,988 [INFO] Time range does not intersect with dataset
2025-09-30 09:24:38,990 [INFO] ---> 2023-08-01 00:00:00 2023-09-01 14:00:00 z_stake max_filter 6.65
2025-09-30 09:24:38,990 [INFO] Time range does not intersect with dataset
2025-09-30 09:24:38,990 [INFO] could not adjust z_surf_2 not in dataset
2025-09-30 09:24:38,996 [DEBUG] Running persistence_qc using {'t_i': {'max_diff': 0.0001, 'period': 2}, 't_u': {'max_diff': 0.0001, 'period': 2}, 't_l': {'max_diff': 0.0001, 'period': 2}, 'p_i': {'max_diff': 0.0001, 'period': 3}, 'p_u': {'max_diff': 0.0001, 'period': 150}, 'p_l': {'max_diff': 0.0001, 'period': 150}, 'gps_lat_lon': {'max_diff': 1e-06, 'period': 6}, 'gps_alt': {'max_diff': 0.0001, 'period': 6}, 't_rad': {'max_diff': 0.0001, 'period': 2}, 'rh_i': {'max_diff': 0.0001, 'period': 2}, 'rh_u': {'max_diff': 0.0001, 'period': 2}, 'rh_l': {'max_diff': 0.0001, 'period': 2}, 'wspd_i': {'max_diff': 0.0001, 'period': 6}, 'wspd_u': {'max_diff': 0.0001, 'period': 6}, 'wspd_l': {'max_diff': 0.0001, 'period': 6}}
2025-09-30 09:24:39,000 [DEBUG] Applying persistent QC in t_i. Filtering 0/52668 samples
2025-09-30 09:24:39,004 [DEBUG] Applying persistent QC in t_u. Filtering 59/52668 samples
2025-09-30 09:24:39,008 [DEBUG] Applying persistent QC in p_i. Filtering 0/52668 samples
2025-09-30 09:24:39,080 [DEBUG] Applying persistent QC in p_u. Filtering 0/52668 samples
2025-09-30 09:24:39,092 [DEBUG] Applying persistent QC in gps_lat_lon. Filtering 0/52668 samples
2025-09-30 09:24:39,099 [DEBUG] Applying persistent QC in gps_alt. Filtering 0/52668 samples
2025-09-30 09:24:39,104 [DEBUG] Applying persistent QC in t_rad. Filtering 0/52668 samples
2025-09-30 09:24:39,109 [DEBUG] Applying persistent QC in rh_i. Filtering 0/52668 samples
2025-09-30 09:24:39,115 [DEBUG] Applying persistent QC in rh_u. Filtering 0/52668 samples
2025-09-30 09:24:39,122 [DEBUG] Applying persistent QC in wspd_i. Filtering 0/52668 samples
2025-09-30 09:24:39,127 [DEBUG] Applying persistent QC in wspd_u. Filtering 383/52668 samples
2025-09-30 09:24:39,526 [INFO] Resampling to 10min
2025-09-30 09:24:39,614 [INFO] Writing to files...
2025-09-30 09:24:40,913 [INFO] Written to L2_test/raw/QAS_Lv3/QAS_Lv3_10min.csv
2025-09-30 09:24:40,914 [INFO] Written to L2_test/raw/QAS_Lv3/QAS_Lv3_10min.nc
2025-09-30 09:24:41,077 [INFO] Resampling to 60min
2025-09-30 09:24:41,169 [INFO] Writing to files...
2025-09-30 09:24:41,649 [INFO] Written to L2_test/raw/QAS_Lv3/QAS_Lv3_hour.csv
2025-09-30 09:24:41,649 [INFO] Written to L2_test/raw/QAS_Lv3/QAS_Lv3_hour.nc
2025-09-30 09:24:41,716 [DEBUG] Could not import boto3, continuing with reduced functionality.
2025-09-30 09:24:41,717 [DEBUG] GDAL data found in package: path='/home/bav/miniforge3/lib/python3.12/site-packages/rasterio/gdal_data'.
2025-09-30 09:24:41,717 [DEBUG] PROJ data found in package: path='/home/bav/miniforge3/lib/python3.12/site-packages/rasterio/proj_data'.
2025-09-30 09:24:41,834 [INFO] QAS_Lv3 array loaded from L2_test/raw/QAS_Lv3/QAS_Lv3_hour.nc
2025-09-30 09:24:41,879 [INFO] QAS_Lv3 array loaded from L2_test/tx/QAS_Lv3/QAS_Lv3_hour.nc
2025-09-30 09:24:41,880 [INFO] Combining L2_test/raw/QAS_Lv3/QAS_Lv3_hour.nc with L2_test/tx/QAS_Lv3/QAS_Lv3_hour.nc...
2025-09-30 09:24:42,020 [INFO] Writing to files...
2025-09-30 09:24:43,151 [INFO] Written to L2_test/level_2/QAS_Lv3/QAS_Lv3_hour.csv
2025-09-30 09:24:43,151 [INFO] Written to L2_test/level_2/QAS_Lv3/QAS_Lv3_hour.nc
2025-09-30 09:24:43,152 [INFO] Files saved to L2_test/level_2/QAS_Lv3...
2025-09-30 09:24:43,202 [WARNING] data_issues_path is missing. Using default data issues path: ../PROMICE-AWS-data-issues
2025-09-30 09:24:44,618 [INFO] processing gps_lat without relocation
2025-09-30 09:24:44,622 [INFO] processing gps_lon without relocation
2025-09-30 09:24:44,625 [INFO] processing gps_alt without relocation
2025-09-30 09:24:44,639 [INFO] Using file: ../PROMICE-AWS-data-issues/adjustments/QAS_Lv3.csv
2025-09-30 09:24:44,647 [DEBUG] ---> 2023-09-01 00:00:00 None z_surf_2 add -4.5
2025-09-30 09:24:44,648 [DEBUG] ---> 2025-09-02 12:00:00 None z_surf_2 add -5.5
2025-09-30 09:24:44,649 [INFO] Combining surface height
2025-09-30 09:24:44,649 [INFO] -> ablation site
2025-09-30 09:24:44,719 [DEBUG] -> estimating ablation period for each year
2025-09-30 09:24:44,721 [DEBUG] 2022 no z_ice_surf, just using JJA
2025-09-30 09:24:44,723 [DEBUG] 2023 no z_ice_surf, just using JJA
2025-09-30 09:24:44,725 [DEBUG] 2024 no z_ice_surf, just using JJA
2025-09-30 09:24:44,727 [DEBUG] 2025 no z_ice_surf, just using JJA
2025-09-30 09:24:44,727 [DEBUG] 2022: Ablation from 2022-08-29 18:00:00 to 2022-08-31 23:00:00
2025-09-30 09:24:44,735 [DEBUG] adjusting hs1
2025-09-30 09:24:44,735 [DEBUG] to hs2, minimizing winter difference
2025-09-30 09:24:44,737 [DEBUG] 2023: Ablation from 2023-06-01 00:00:00 to 2023-08-31 23:00:00
2025-09-30 09:24:44,744 [DEBUG] adjusting hs1
2025-09-30 09:24:44,744 [DEBUG] to hs2, minimizing winter difference
2025-09-30 09:24:44,745 [DEBUG] 2024: Ablation from 2024-06-01 00:00:00 to 2024-08-31 23:00:00
2025-09-30 09:24:44,752 [DEBUG] adjusting hs1
2025-09-30 09:24:44,752 [DEBUG] to hs2, minimizing winter difference
2025-09-30 09:24:44,754 [DEBUG] 2025: Ablation from 2025-06-01 00:00:00 to 2025-08-31 23:00:00
2025-09-30 09:24:44,761 [DEBUG] adjusting hs1
2025-09-30 09:24:44,761 [DEBUG] to hs2, minimizing winter difference
2025-09-30 09:24:44,777 [INFO] surface height combination finished
2025-09-30 09:24:44,808 [INFO] Calculating thermistor depth
2025-09-30 09:24:44,830 [INFO] interpolating 10 m firn/ice temperature (on hourly values)
2025-09-30 09:24:45,436 [INFO] Resampling to 60min
2025-09-30 09:24:45,586 [INFO] Writing to files...
2025-09-30 09:24:46,716 [INFO] Written to L3_test/stations/QAS_Lv3/QAS_Lv3_hour.csv
2025-09-30 09:24:46,716 [INFO] Written to L3_test/stations/QAS_Lv3/QAS_Lv3_hour.nc
2025-09-30 09:24:46,774 [INFO] Resampling to 1D
2025-09-30 09:24:46,869 [INFO] Writing to files...
2025-09-30 09:24:46,971 [INFO] Written to L3_test/stations/QAS_Lv3/QAS_Lv3_day.csv
2025-09-30 09:24:46,971 [INFO] Written to L3_test/stations/QAS_Lv3/QAS_Lv3_day.nc
2025-09-30 09:24:47,025 [INFO] Resampling to ME
2025-09-30 09:24:47,119 [INFO] Writing to files...
2025-09-30 09:24:47,187 [INFO] Written to L3_test/stations/QAS_Lv3/QAS_Lv3_month.csv
2025-09-30 09:24:47,187 [INFO] Written to L3_test/stations/QAS_Lv3/QAS_Lv3_month.nc
/n ======== test join_l3 ========= 

QAS_Lv3

 ======== test get_l2 ========= 


 ======== test join_l2 ========= 


 ======== test l2tol3 ========= 

