2025-09-30 09:28:54,154 [INFO] AWS(config_file=../aws-l0//tx/config/WEG_L.toml, inpath=../aws-l0//tx/, data_issues_repository=../PROMICE-AWS-data-issues, var_file=None, meta_file=None)
2025-09-30 09:28:54,556 [DEBUG] Source information: {'pypromice': '1.5.1', 'l0_config_file': 'WEG_L.toml:016a28db7b1c6dc223642f5fa4e0a0249a3cdac3', 'l0_data_root': '016a28db7b1c6dc223642f5fa4e0a0249a3cdac3', 'data_issues': 'd1389d62adb1864056bb11f559d4785105b56943'}
2025-09-30 09:28:54,573 [INFO] Detected L0 file type 'csv_default' for ../aws-l0/tx/WEG_L_300534063815570_1.txt
2025-09-30 09:28:54,649 [INFO] L0 data successfully loaded from WEG_L_300534063815570_1.txt
2025-09-30 09:28:54,649 [INFO] Detected L0 file type 'csv_default' for ../aws-l0/tx/WEG_L_300534063815570_2.txt
2025-09-30 09:28:54,721 [INFO] L0 data successfully loaded from WEG_L_300534063815570_2.txt
2025-09-30 09:28:54,731 [INFO] Level 1 processing...
2025-09-30 09:28:54,856 [WARNING] bedrock attribute is not set
2025-09-30 09:28:55,088 [WARNING] bedrock attribute is not set
2025-09-30 09:28:55,235 [INFO] Level 2 processing...
2025-09-30 09:28:55,236 [INFO] Using file: ../PROMICE-AWS-data-issues/adjustments/WEG_L.csv
2025-09-30 09:28:55,246 [INFO] Using file: ../PROMICE-AWS-data-issues/flags/WEG_L.csv
2025-09-30 09:28:55,254 [DEBUG] ---> flagging 2023-04-15T12:00:00.000000000 2023-07-23 00:00:00 z_pt_cor
2025-09-30 09:28:55,257 [DEBUG] ---> flagging 2023-09-11 00:00:00 2025-09-28T12:00:00.000000000 z_pt_cor
2025-09-30 09:28:55,259 [DEBUG] ---> flagging 2023-08-28 00:00:00 2023-11-30 00:00:00 z_boom_u
2025-09-30 09:28:55,263 [INFO] Using file: ../PROMICE-AWS-data-issues/adjustments/WEG_L.csv
2025-09-30 09:28:55,272 [DEBUG] ---> None 2024-01-01 12:00:00 z_boom_u max_filter 2.26
2025-09-30 09:28:55,273 [INFO] could not adjust z_surf_2 not in dataset
2025-09-30 09:28:55,280 [DEBUG] Running persistence_qc using {'t_i': {'max_diff': 0.0001, 'period': 2}, 't_u': {'max_diff': 0.0001, 'period': 2}, 't_l': {'max_diff': 0.0001, 'period': 2}, 'p_i': {'max_diff': 0.0001, 'period': 3}, 'p_u': {'max_diff': 0.0001, 'period': 150}, 'p_l': {'max_diff': 0.0001, 'period': 150}, 'gps_lat_lon': {'max_diff': 1e-06, 'period': 6}, 'gps_alt': {'max_diff': 0.0001, 'period': 6}, 't_rad': {'max_diff': 0.0001, 'period': 2}, 'rh_i': {'max_diff': 0.0001, 'period': 2}, 'rh_u': {'max_diff': 0.0001, 'period': 2}, 'rh_l': {'max_diff': 0.0001, 'period': 2}, 'wspd_i': {'max_diff': 0.0001, 'period': 6}, 'wspd_u': {'max_diff': 0.0001, 'period': 6}, 'wspd_l': {'max_diff': 0.0001, 'period': 6}}
2025-09-30 09:28:55,285 [DEBUG] Applying persistent QC in t_i. Filtering 286/21518 samples
2025-09-30 09:28:55,289 [DEBUG] Applying persistent QC in t_u. Filtering 13/21518 samples
2025-09-30 09:28:55,293 [DEBUG] Applying persistent QC in p_i. Filtering 162/21518 samples
2025-09-30 09:28:55,365 [DEBUG] Applying persistent QC in p_u. Filtering 0/21518 samples
2025-09-30 09:28:55,375 [DEBUG] Applying persistent QC in gps_lat_lon. Filtering 0/21518 samples
2025-09-30 09:28:55,381 [DEBUG] Applying persistent QC in gps_alt. Filtering 0/21518 samples
2025-09-30 09:28:55,384 [DEBUG] Applying persistent QC in t_rad. Filtering 5/21518 samples
2025-09-30 09:28:55,387 [DEBUG] Applying persistent QC in rh_i. Filtering 53/21518 samples
2025-09-30 09:28:55,392 [DEBUG] Applying persistent QC in rh_u. Filtering 55/21518 samples
2025-09-30 09:28:55,398 [DEBUG] Applying persistent QC in wspd_i. Filtering 56/21518 samples
2025-09-30 09:28:55,405 [DEBUG] Applying persistent QC in wspd_u. Filtering 47/21518 samples
2025-09-30 09:28:55,802 [INFO] Resampling to 60min
2025-09-30 09:28:55,889 [INFO] Writing to files...
2025-09-30 09:28:56,813 [INFO] Written to L2_test/tx/WEG_L/WEG_L_hour.csv
2025-09-30 09:28:56,813 [INFO] Written to L2_test/tx/WEG_L/WEG_L_hour.nc
2025-09-30 09:28:56,815 [INFO] AWS(config_file=../aws-l0//raw/config/WEG_L.toml, inpath=../aws-l0//raw/WEG_L/, data_issues_repository=../PROMICE-AWS-data-issues, var_file=None, meta_file=None)
2025-09-30 09:28:57,164 [DEBUG] Source information: {'pypromice': '1.5.1', 'l0_config_file': 'WEG_L.toml:016a28db7b1c6dc223642f5fa4e0a0249a3cdac3', 'l0_data_root': '016a28db7b1c6dc223642f5fa4e0a0249a3cdac3', 'data_issues': 'd1389d62adb1864056bb11f559d4785105b56943'}
2025-09-30 09:28:57,459 [INFO] Detected L0 file type 'toa5' for ../aws-l0/raw/WEG_L/WEG_L_2024_raw.txt
2025-09-30 09:28:57,757 [INFO] Detected L0 file type 'toa5' for ../aws-l0/raw/WEG_L/WEG_L_2024_raw.txt
2025-09-30 09:28:57,800 [INFO] L0 data successfully loaded from WEG_L_2024_raw.txt
2025-09-30 09:28:57,812 [INFO] Level 1 processing...
2025-09-30 09:28:57,892 [WARNING] bedrock attribute is not set
2025-09-30 09:28:57,991 [INFO] Level 2 processing...
2025-09-30 09:28:57,992 [INFO] Using file: ../PROMICE-AWS-data-issues/adjustments/WEG_L.csv
2025-09-30 09:28:57,994 [INFO] Using file: ../PROMICE-AWS-data-issues/flags/WEG_L.csv
2025-09-30 09:28:57,998 [DEBUG] ---> flagging 2022-08-14T16:40:00.000000000 2023-07-23 00:00:00 z_pt_cor
2025-09-30 09:28:58,000 [DEBUG] ---> flagging 2023-09-11 00:00:00 2023-04-15T15:00:00.000000000 z_pt_cor
2025-09-30 09:28:58,002 [DEBUG] ---> flagging 2023-08-28 00:00:00 2023-11-30 00:00:00 z_boom_u
2025-09-30 09:28:58,004 [INFO] Using file: ../PROMICE-AWS-data-issues/adjustments/WEG_L.csv
2025-09-30 09:28:58,010 [DEBUG] ---> None 2024-01-01 12:00:00 z_boom_u max_filter 2.26
2025-09-30 09:28:58,011 [INFO] could not adjust z_surf_2 not in dataset
2025-09-30 09:28:58,014 [DEBUG] Running persistence_qc using {'t_i': {'max_diff': 0.0001, 'period': 2}, 't_u': {'max_diff': 0.0001, 'period': 2}, 't_l': {'max_diff': 0.0001, 'period': 2}, 'p_i': {'max_diff': 0.0001, 'period': 3}, 'p_u': {'max_diff': 0.0001, 'period': 150}, 'p_l': {'max_diff': 0.0001, 'period': 150}, 'gps_lat_lon': {'max_diff': 1e-06, 'period': 6}, 'gps_alt': {'max_diff': 0.0001, 'period': 6}, 't_rad': {'max_diff': 0.0001, 'period': 2}, 'rh_i': {'max_diff': 0.0001, 'period': 2}, 'rh_u': {'max_diff': 0.0001, 'period': 2}, 'rh_l': {'max_diff': 0.0001, 'period': 2}, 'wspd_i': {'max_diff': 0.0001, 'period': 6}, 'wspd_u': {'max_diff': 0.0001, 'period': 6}, 'wspd_l': {'max_diff': 0.0001, 'period': 6}}
2025-09-30 09:28:58,016 [DEBUG] Applying persistent QC in t_i. Filtering 0/6092 samples
2025-09-30 09:28:58,019 [DEBUG] Applying persistent QC in t_u. Filtering 0/6092 samples
2025-09-30 09:28:58,022 [DEBUG] Applying persistent QC in p_i. Filtering 0/6092 samples
2025-09-30 09:28:58,079 [DEBUG] Applying persistent QC in p_u. Filtering 0/6092 samples
2025-09-30 09:28:58,087 [DEBUG] Applying persistent QC in gps_lat_lon. Filtering 0/6092 samples
2025-09-30 09:28:58,091 [DEBUG] Applying persistent QC in gps_alt. Filtering 0/6092 samples
2025-09-30 09:28:58,093 [DEBUG] Applying persistent QC in t_rad. Filtering 2/6092 samples
2025-09-30 09:28:58,096 [DEBUG] Applying persistent QC in rh_i. Filtering 0/6092 samples
2025-09-30 09:28:58,098 [DEBUG] Applying persistent QC in rh_u. Filtering 0/6092 samples
2025-09-30 09:28:58,103 [DEBUG] Applying persistent QC in wspd_i. Filtering 0/6092 samples
2025-09-30 09:28:58,107 [DEBUG] Applying persistent QC in wspd_u. Filtering 774/6092 samples
2025-09-30 09:28:58,381 [INFO] Resampling to 10min
2025-09-30 09:28:58,454 [INFO] Writing to files...
2025-09-30 09:28:59,071 [INFO] Written to L2_test/raw/WEG_L/WEG_L_10min.csv
2025-09-30 09:28:59,072 [INFO] Written to L2_test/raw/WEG_L/WEG_L_10min.nc
2025-09-30 09:28:59,136 [INFO] Resampling to 60min
2025-09-30 09:28:59,196 [INFO] Writing to files...
2025-09-30 09:28:59,384 [INFO] Written to L2_test/raw/WEG_L/WEG_L_hour.csv
2025-09-30 09:28:59,384 [INFO] Written to L2_test/raw/WEG_L/WEG_L_hour.nc
2025-09-30 09:28:59,427 [DEBUG] Could not import boto3, continuing with reduced functionality.
2025-09-30 09:28:59,428 [DEBUG] GDAL data found in package: path='/home/bav/miniforge3/lib/python3.12/site-packages/rasterio/gdal_data'.
2025-09-30 09:28:59,428 [DEBUG] PROJ data found in package: path='/home/bav/miniforge3/lib/python3.12/site-packages/rasterio/proj_data'.
2025-09-30 09:28:59,517 [INFO] WEG_L array loaded from L2_test/raw/WEG_L/WEG_L_hour.nc
2025-09-30 09:28:59,549 [INFO] WEG_L array loaded from L2_test/tx/WEG_L/WEG_L_hour.nc
2025-09-30 09:28:59,549 [INFO] Combining L2_test/raw/WEG_L/WEG_L_hour.nc with L2_test/tx/WEG_L/WEG_L_hour.nc...
2025-09-30 09:28:59,675 [INFO] Writing to files...
2025-09-30 09:29:00,486 [INFO] Written to L2_test/level_2/WEG_L/WEG_L_hour.csv
2025-09-30 09:29:00,486 [INFO] Written to L2_test/level_2/WEG_L/WEG_L_hour.nc
2025-09-30 09:29:00,487 [INFO] Files saved to L2_test/level_2/WEG_L...
2025-09-30 09:29:00,527 [WARNING] data_issues_path is missing. Using default data issues path: ../PROMICE-AWS-data-issues
2025-09-30 09:29:02,337 [INFO] processing gps_lat without relocation
2025-09-30 09:29:02,342 [INFO] processing gps_lon without relocation
2025-09-30 09:29:02,345 [INFO] processing gps_alt without relocation
2025-09-30 09:29:02,360 [INFO] Using file: ../PROMICE-AWS-data-issues/adjustments/WEG_L.csv
2025-09-30 09:29:02,370 [DEBUG] ---> 2023-07-01 00:00:00 2023-09-01 00:00:00 z_surf_2 add 0.3
2025-09-30 09:29:02,371 [DEBUG] ---> 2023-07-18 00:00:00 None z_surf_2 add -0.3
2025-09-30 09:29:02,373 [INFO] Combining surface height
2025-09-30 09:29:02,373 [INFO] -> ablation site
2025-09-30 09:29:02,490 [DEBUG] -> estimating ablation period for each year
2025-09-30 09:29:02,492 [DEBUG] 2022 no z_ice_surf, just using JJA
2025-09-30 09:29:02,494 [DEBUG] 2023 derived from z_ice_surf
2025-09-30 09:29:02,496 [DEBUG] 2024 no z_ice_surf, just using JJA
2025-09-30 09:29:02,498 [DEBUG] 2025 no z_ice_surf, just using JJA
2025-09-30 09:29:02,498 [DEBUG] 2022: Ablation from 2022-08-14 16:00:00 to 2022-08-31 23:00:00
2025-09-30 09:29:02,505 [DEBUG] 2023: Ablation from 2023-07-26 08:00:00 to 2023-09-04 06:00:00
2025-09-30 09:29:02,512 [DEBUG] adjusting hs1
2025-09-30 09:29:02,512 [DEBUG] to hs2, minimizing winter difference
2025-09-30 09:29:02,514 [DEBUG] 2024: Ablation from 2024-06-01 00:00:00 to 2024-08-31 23:00:00
2025-09-30 09:29:02,521 [DEBUG] adjusting hs1
2025-09-30 09:29:02,521 [DEBUG] to hs2, minimizing winter difference
2025-09-30 09:29:02,523 [DEBUG] 2025: Ablation from 2025-06-01 00:00:00 to 2025-08-31 23:00:00
2025-09-30 09:29:02,530 [DEBUG] adjusting hs1
2025-09-30 09:29:02,531 [DEBUG] to hs2, minimizing winter difference
2025-09-30 09:29:02,546 [INFO] surface height combination finished
2025-09-30 09:29:02,578 [INFO] Calculating thermistor depth
2025-09-30 09:29:02,584 [INFO] No maintenance at WEG_L
2025-09-30 09:29:02,596 [INFO] interpolating 10 m firn/ice temperature (on hourly values)
2025-09-30 09:29:03,916 [INFO] Resampling to 60min
2025-09-30 09:29:04,016 [INFO] Writing to files...
2025-09-30 09:29:04,949 [INFO] Written to L3_test/stations/WEG_L/WEG_L_hour.csv
2025-09-30 09:29:04,949 [INFO] Written to L3_test/stations/WEG_L/WEG_L_hour.nc
2025-09-30 09:29:04,998 [INFO] Resampling to 1D
2025-09-30 09:29:05,086 [INFO] Writing to files...
2025-09-30 09:29:05,220 [INFO] Written to L3_test/stations/WEG_L/WEG_L_day.csv
2025-09-30 09:29:05,221 [INFO] Written to L3_test/stations/WEG_L/WEG_L_day.nc
2025-09-30 09:29:05,270 [INFO] Resampling to ME
2025-09-30 09:29:05,348 [INFO] Writing to files...
2025-09-30 09:29:05,421 [INFO] Written to L3_test/stations/WEG_L/WEG_L_month.csv
2025-09-30 09:29:05,422 [INFO] Written to L3_test/stations/WEG_L/WEG_L_month.nc
/n ======== test join_l3 ========= 

WEG_L

 ======== test get_l2 ========= 


 ======== test join_l2 ========= 


 ======== test l2tol3 ========= 

