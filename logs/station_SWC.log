2025-09-30 09:26:54,579 [INFO] AWS(config_file=../aws-l0//tx/config/SWC.toml, inpath=../aws-l0//tx/, data_issues_repository=../PROMICE-AWS-data-issues, var_file=None, meta_file=None)
2025-09-30 09:26:54,906 [DEBUG] Source information: {'pypromice': '1.5.1', 'l0_config_file': 'SWC.toml:016a28db7b1c6dc223642f5fa4e0a0249a3cdac3', 'l0_data_root': '016a28db7b1c6dc223642f5fa4e0a0249a3cdac3', 'data_issues': 'd1389d62adb1864056bb11f559d4785105b56943'}
2025-09-30 09:26:54,914 [INFO] Detected L0 file type 'csv_default' for ../aws-l0/tx/SWC_300534060524310_1.txt
2025-09-30 09:26:55,015 [INFO] L0 data successfully loaded from SWC_300534060524310_1.txt
2025-09-30 09:26:55,020 [INFO] Level 1 processing...
2025-09-30 09:26:55,160 [WARNING] bedrock attribute is not set
2025-09-30 09:26:55,271 [INFO] Level 2 processing...
2025-09-30 09:26:55,272 [INFO] Using file: ../PROMICE-AWS-data-issues/adjustments/SWC.csv
2025-09-30 09:26:55,281 [INFO] Using file: ../PROMICE-AWS-data-issues/flags/SWC.csv
2025-09-30 09:26:55,281 [INFO] No ../PROMICE-AWS-data-issues/flags/SWC.csv file to read.
2025-09-30 09:26:55,282 [INFO] Using file: ../PROMICE-AWS-data-issues/adjustments/SWC.csv
2025-09-30 09:26:55,294 [DEBUG] ---> None None p_u max_filter 925.0
2025-09-30 09:26:55,298 [DEBUG] ---> None 2022-08-02 23:00:00 wdir_u rotate -150.0
2025-09-30 09:26:55,302 [DEBUG] ---> None None z_boom_u max_filter 2.8
2025-09-30 09:26:55,304 [DEBUG] ---> None None z_pt_cor min_filter 13.3
2025-09-30 09:26:55,312 [DEBUG] Running persistence_qc using {'t_i': {'max_diff': 0.0001, 'period': 2}, 't_u': {'max_diff': 0.0001, 'period': 2}, 't_l': {'max_diff': 0.0001, 'period': 2}, 'p_i': {'max_diff': 0.0001, 'period': 3}, 'p_u': {'max_diff': 0.0001, 'period': 150}, 'p_l': {'max_diff': 0.0001, 'period': 150}, 'gps_lat_lon': {'max_diff': 1e-06, 'period': 6}, 'gps_alt': {'max_diff': 0.0001, 'period': 6}, 't_rad': {'max_diff': 0.0001, 'period': 2}, 'rh_i': {'max_diff': 0.0001, 'period': 2}, 'rh_u': {'max_diff': 0.0001, 'period': 2}, 'rh_l': {'max_diff': 0.0001, 'period': 2}, 'wspd_i': {'max_diff': 0.0001, 'period': 6}, 'wspd_u': {'max_diff': 0.0001, 'period': 6}, 'wspd_l': {'max_diff': 0.0001, 'period': 6}}
2025-09-30 09:26:55,318 [DEBUG] Applying persistent QC in t_i. Filtering 541/21527 samples
2025-09-30 09:26:55,323 [DEBUG] Applying persistent QC in t_u. Filtering 32/21527 samples
2025-09-30 09:26:55,327 [DEBUG] Applying persistent QC in p_i. Filtering 254/21527 samples
2025-09-30 09:26:55,431 [DEBUG] Applying persistent QC in p_u. Filtering 0/21527 samples
2025-09-30 09:26:55,440 [DEBUG] Applying persistent QC in gps_lat_lon. Filtering 61/21527 samples
2025-09-30 09:26:55,447 [DEBUG] Applying persistent QC in gps_alt. Filtering 62/21527 samples
2025-09-30 09:26:55,451 [DEBUG] Applying persistent QC in t_rad. Filtering 0/21527 samples
2025-09-30 09:26:55,454 [DEBUG] Applying persistent QC in rh_i. Filtering 295/21527 samples
2025-09-30 09:26:55,458 [DEBUG] Applying persistent QC in rh_u. Filtering 241/21527 samples
2025-09-30 09:26:55,464 [DEBUG] Applying persistent QC in wspd_i. Filtering 188/21527 samples
2025-09-30 09:26:55,468 [DEBUG] Applying persistent QC in wspd_u. Filtering 114/21527 samples
2025-09-30 09:26:55,814 [INFO] Resampling to 60min
2025-09-30 09:26:55,887 [INFO] Writing to files...
2025-09-30 09:26:56,825 [INFO] Written to L2_test/tx/SWC/SWC_hour.csv
2025-09-30 09:26:56,825 [INFO] Written to L2_test/tx/SWC/SWC_hour.nc
2025-09-30 09:26:56,826 [INFO] AWS(config_file=../aws-l0//raw/config/SWC.toml, inpath=../aws-l0//raw/SWC/, data_issues_repository=../PROMICE-AWS-data-issues, var_file=None, meta_file=None)
2025-09-30 09:26:57,170 [DEBUG] Source information: {'pypromice': '1.5.1', 'l0_config_file': 'SWC.toml:016a28db7b1c6dc223642f5fa4e0a0249a3cdac3', 'l0_data_root': '016a28db7b1c6dc223642f5fa4e0a0249a3cdac3', 'data_issues': 'd1389d62adb1864056bb11f559d4785105b56943'}
2025-09-30 09:26:57,180 [INFO] Detected L0 file type 'toa5' for ../aws-l0/raw/SWC/SWC_2022_raw.dat
2025-09-30 09:26:57,391 [INFO] Detected L0 file type 'toa5' for ../aws-l0/raw/SWC/SWC_2022_raw.dat
2025-09-30 09:26:57,996 [INFO] L0 data successfully loaded from SWC_2022_raw.dat
2025-09-30 09:26:58,004 [INFO] Level 1 processing...
2025-09-30 09:26:58,132 [WARNING] bedrock attribute is not set
2025-09-30 09:26:58,289 [INFO] Level 2 processing...
2025-09-30 09:26:58,293 [INFO] Using file: ../PROMICE-AWS-data-issues/adjustments/SWC.csv
2025-09-30 09:26:58,318 [INFO] Using file: ../PROMICE-AWS-data-issues/flags/SWC.csv
2025-09-30 09:26:58,318 [INFO] No ../PROMICE-AWS-data-issues/flags/SWC.csv file to read.
2025-09-30 09:26:58,324 [INFO] Using file: ../PROMICE-AWS-data-issues/adjustments/SWC.csv
2025-09-30 09:26:58,331 [DEBUG] ---> None None p_u max_filter 925.0
2025-09-30 09:26:58,337 [DEBUG] ---> None 2022-08-02 23:00:00 wdir_u rotate -150.0
2025-09-30 09:26:58,341 [DEBUG] ---> None None z_boom_u max_filter 2.8
2025-09-30 09:26:58,343 [DEBUG] ---> None None z_pt_cor min_filter 13.3
2025-09-30 09:26:58,372 [DEBUG] Running persistence_qc using {'t_i': {'max_diff': 0.0001, 'period': 2}, 't_u': {'max_diff': 0.0001, 'period': 2}, 't_l': {'max_diff': 0.0001, 'period': 2}, 'p_i': {'max_diff': 0.0001, 'period': 3}, 'p_u': {'max_diff': 0.0001, 'period': 150}, 'p_l': {'max_diff': 0.0001, 'period': 150}, 'gps_lat_lon': {'max_diff': 1e-06, 'period': 6}, 'gps_alt': {'max_diff': 0.0001, 'period': 6}, 't_rad': {'max_diff': 0.0001, 'period': 2}, 'rh_i': {'max_diff': 0.0001, 'period': 2}, 'rh_u': {'max_diff': 0.0001, 'period': 2}, 'rh_l': {'max_diff': 0.0001, 'period': 2}, 'wspd_i': {'max_diff': 0.0001, 'period': 6}, 'wspd_u': {'max_diff': 0.0001, 'period': 6}, 'wspd_l': {'max_diff': 0.0001, 'period': 6}}
2025-09-30 09:26:58,384 [DEBUG] Applying persistent QC in t_i. Filtering 0/104290 samples
2025-09-30 09:26:58,398 [DEBUG] Applying persistent QC in t_u. Filtering 90/104290 samples
2025-09-30 09:26:58,405 [DEBUG] Applying persistent QC in p_i. Filtering 0/104290 samples
2025-09-30 09:26:58,488 [DEBUG] Applying persistent QC in p_u. Filtering 0/104290 samples
2025-09-30 09:26:58,503 [DEBUG] Applying persistent QC in gps_lat_lon. Filtering 5/104290 samples
2025-09-30 09:26:58,511 [DEBUG] Applying persistent QC in gps_alt. Filtering 5/104290 samples
2025-09-30 09:26:58,516 [DEBUG] Applying persistent QC in t_rad. Filtering 0/104290 samples
2025-09-30 09:26:58,522 [DEBUG] Applying persistent QC in rh_i. Filtering 0/104290 samples
2025-09-30 09:26:58,527 [DEBUG] Applying persistent QC in rh_u. Filtering 1576/104290 samples
2025-09-30 09:26:58,536 [DEBUG] Applying persistent QC in wspd_i. Filtering 0/104290 samples
2025-09-30 09:26:58,543 [DEBUG] Applying persistent QC in wspd_u. Filtering 3511/104290 samples
2025-09-30 09:26:59,109 [INFO] Resampling to 10min
2025-09-30 09:26:59,228 [INFO] Writing to files...
2025-09-30 09:27:02,023 [INFO] Written to L2_test/raw/SWC/SWC_10min.csv
2025-09-30 09:27:02,023 [INFO] Written to L2_test/raw/SWC/SWC_10min.nc
2025-09-30 09:27:02,212 [INFO] Resampling to 60min
2025-09-30 09:27:02,279 [INFO] Writing to files...
2025-09-30 09:27:03,194 [INFO] Written to L2_test/raw/SWC/SWC_hour.csv
2025-09-30 09:27:03,194 [INFO] Written to L2_test/raw/SWC/SWC_hour.nc
2025-09-30 09:27:03,272 [DEBUG] Could not import boto3, continuing with reduced functionality.
2025-09-30 09:27:03,274 [DEBUG] GDAL data found in package: path='/home/bav/miniforge3/lib/python3.12/site-packages/rasterio/gdal_data'.
2025-09-30 09:27:03,274 [DEBUG] PROJ data found in package: path='/home/bav/miniforge3/lib/python3.12/site-packages/rasterio/proj_data'.
2025-09-30 09:27:03,429 [INFO] SWC array loaded from L2_test/raw/SWC/SWC_hour.nc
2025-09-30 09:27:03,510 [INFO] SWC array loaded from L2_test/tx/SWC/SWC_hour.nc
2025-09-30 09:27:03,511 [INFO] Combining L2_test/raw/SWC/SWC_hour.nc with L2_test/tx/SWC/SWC_hour.nc...
2025-09-30 09:27:03,730 [INFO] Writing to files...
2025-09-30 09:27:04,735 [INFO] Written to L2_test/level_2/SWC/SWC_hour.csv
2025-09-30 09:27:04,735 [INFO] Written to L2_test/level_2/SWC/SWC_hour.nc
2025-09-30 09:27:04,735 [INFO] Files saved to L2_test/level_2/SWC...
2025-09-30 09:27:04,778 [WARNING] data_issues_path is missing. Using default data issues path: ../PROMICE-AWS-data-issues
2025-09-30 09:27:06,696 [INFO] processing gps_lat without relocation
2025-09-30 09:27:06,700 [INFO] processing gps_lon without relocation
2025-09-30 09:27:06,703 [INFO] processing gps_alt without relocation
2025-09-30 09:27:06,716 [INFO] Using file: ../PROMICE-AWS-data-issues/adjustments/SWC.csv
2025-09-30 09:27:06,722 [INFO] Combining surface height
2025-09-30 09:27:06,722 [INFO] -> ablation site
2025-09-30 09:27:06,812 [DEBUG] -> estimating ablation period for each year
2025-09-30 09:27:06,813 [DEBUG] 2020 derived from z_ice_surf
2025-09-30 09:27:06,813 [DEBUG] 2020 could not estimate ablation season
2025-09-30 09:27:06,814 [DEBUG] 2021 derived from z_ice_surf
2025-09-30 09:27:06,814 [DEBUG] 2021 could not estimate ablation season
2025-09-30 09:27:06,815 [DEBUG] 2022 derived from z_ice_surf
2025-09-30 09:27:06,816 [DEBUG] 2022 could not estimate ablation season
2025-09-30 09:27:06,817 [DEBUG] 2023 no z_ice_surf, just using JJA
2025-09-30 09:27:06,817 [DEBUG] 2023 could not estimate ablation season
2025-09-30 09:27:06,817 [DEBUG] 2020: Ablation from 2023-01-04 06:00:00 to 2023-01-04 06:00:00
2025-09-30 09:27:06,824 [DEBUG] no ablation data
2025-09-30 09:27:06,827 [DEBUG] adjusting hs1
2025-09-30 09:27:06,827 [DEBUG] to hs2
2025-09-30 09:27:06,829 [DEBUG] 2021: Ablation from 2023-01-04 06:00:00 to 2023-01-04 06:00:00
2025-09-30 09:27:06,834 [DEBUG] no ablation data
2025-09-30 09:27:06,837 [DEBUG] adjusting hs1
2025-09-30 09:27:06,837 [DEBUG] to hs2
2025-09-30 09:27:06,840 [DEBUG] 2022: Ablation from 2023-01-04 06:00:00 to 2023-01-04 06:00:00
2025-09-30 09:27:06,844 [DEBUG] no ablation data
2025-09-30 09:27:06,847 [DEBUG] adjusting hs1
2025-09-30 09:27:06,847 [DEBUG] to hs2
2025-09-30 09:27:06,850 [DEBUG] 2023: Ablation from 2023-01-04 06:00:00 to 2023-01-04 06:00:00
2025-09-30 09:27:06,863 [INFO] surface height combination finished
2025-09-30 09:27:06,890 [INFO] Calculating thermistor depth
2025-09-30 09:27:06,915 [INFO] interpolating 10 m firn/ice temperature (on hourly values)
2025-09-30 09:27:09,190 [INFO] Resampling to 60min
2025-09-30 09:27:09,285 [INFO] Writing to files...
2025-09-30 09:27:10,107 [INFO] Written to L3_test/stations/SWC/SWC_hour.csv
2025-09-30 09:27:10,107 [INFO] Written to L3_test/stations/SWC/SWC_hour.nc
2025-09-30 09:27:10,159 [INFO] Resampling to 1D
2025-09-30 09:27:10,237 [INFO] Writing to files...
2025-09-30 09:27:10,322 [INFO] Written to L3_test/stations/SWC/SWC_day.csv
2025-09-30 09:27:10,322 [INFO] Written to L3_test/stations/SWC/SWC_day.nc
2025-09-30 09:27:10,365 [INFO] Resampling to ME
2025-09-30 09:27:10,442 [INFO] Writing to files...
2025-09-30 09:27:10,499 [INFO] Written to L3_test/stations/SWC/SWC_month.csv
2025-09-30 09:27:10,499 [INFO] Written to L3_test/stations/SWC/SWC_month.nc
/n ======== test join_l3 ========= 

SWC

 ======== test get_l2 ========= 


 ======== test join_l2 ========= 


 ======== test l2tol3 ========= 

