2025-09-30 09:19:19,779 [INFO] AWS(config_file=../aws-l0//tx/config/KAN_Lv3.toml, inpath=../aws-l0//tx/, data_issues_repository=../PROMICE-AWS-data-issues, var_file=None, meta_file=None)
2025-09-30 09:19:20,150 [DEBUG] Source information: {'pypromice': '1.5.1', 'l0_config_file': 'KAN_Lv3.toml:016a28db7b1c6dc223642f5fa4e0a0249a3cdac3', 'l0_data_root': '016a28db7b1c6dc223642f5fa4e0a0249a3cdac3', 'data_issues': 'd1389d62adb1864056bb11f559d4785105b56943'}
2025-09-30 09:19:20,174 [INFO] Detected L0 file type 'csv_default' for ../aws-l0/tx/KAN_Lv3_300534062581000_1.txt
2025-09-30 09:19:20,264 [INFO] L0 data successfully loaded from KAN_Lv3_300534062581000_1.txt
2025-09-30 09:19:20,271 [INFO] Detected L0 file type 'csv_default' for ../aws-l0/tx/KAN_Lv3_300534062581000_2.txt
2025-09-30 09:19:20,334 [INFO] L0 data successfully loaded from KAN_Lv3_300534062581000_2.txt
2025-09-30 09:19:20,338 [INFO] Detected L0 file type 'csv_default' for ../aws-l0/tx/KAN_Lv3_300534062581000_3.txt
2025-09-30 09:19:20,361 [INFO] L0 data successfully loaded from KAN_Lv3_300534062581000_3.txt
2025-09-30 09:19:20,376 [INFO] Level 1 processing...
2025-09-30 09:19:20,504 [WARNING] bedrock attribute is not set
2025-09-30 09:19:20,690 [WARNING] bedrock attribute is not set
2025-09-30 09:19:20,839 [WARNING] bedrock attribute is not set
2025-09-30 09:19:20,981 [INFO] Level 2 processing...
2025-09-30 09:19:20,982 [INFO] Using file: ../PROMICE-AWS-data-issues/adjustments/KAN_Lv3.csv
2025-09-30 09:19:20,985 [INFO] Using file: ../PROMICE-AWS-data-issues/flags/KAN_Lv3.csv
2025-09-30 09:19:20,989 [DEBUG] ---> flagging 2023-08-22T13:00:00.000000000 2025-05-01 16:00:00 z_pt_cor
2025-09-30 09:19:20,992 [INFO] Using file: ../PROMICE-AWS-data-issues/adjustments/KAN_Lv3.csv
2025-09-30 09:19:20,998 [DEBUG] ---> None None gps_alt min_filter 600.0
2025-09-30 09:19:20,999 [DEBUG] ---> None None z_boom_u max_filter 2.635
2025-09-30 09:19:21,001 [DEBUG] ---> None 2024-02-01 00:00:00 z_boom_u min_filter 2.46
2025-09-30 09:19:21,001 [INFO] could not adjust z_ice_surf not in dataset
2025-09-30 09:19:21,001 [INFO] could not adjust z_surf_2 not in dataset
2025-09-30 09:19:21,010 [DEBUG] Running persistence_qc using {'t_i': {'max_diff': 0.0001, 'period': 2}, 't_u': {'max_diff': 0.0001, 'period': 2}, 't_l': {'max_diff': 0.0001, 'period': 2}, 'p_i': {'max_diff': 0.0001, 'period': 3}, 'p_u': {'max_diff': 0.0001, 'period': 150}, 'p_l': {'max_diff': 0.0001, 'period': 150}, 'gps_lat_lon': {'max_diff': 1e-06, 'period': 6}, 'gps_alt': {'max_diff': 0.0001, 'period': 6}, 't_rad': {'max_diff': 0.0001, 'period': 2}, 'rh_i': {'max_diff': 0.0001, 'period': 2}, 'rh_u': {'max_diff': 0.0001, 'period': 2}, 'rh_l': {'max_diff': 0.0001, 'period': 2}, 'wspd_i': {'max_diff': 0.0001, 'period': 6}, 'wspd_u': {'max_diff': 0.0001, 'period': 6}, 'wspd_l': {'max_diff': 0.0001, 'period': 6}}
2025-09-30 09:19:21,014 [DEBUG] Applying persistent QC in t_i. Filtering 366/18423 samples
2025-09-30 09:19:21,016 [DEBUG] Applying persistent QC in t_u. Filtering 30/18423 samples
2025-09-30 09:19:21,020 [DEBUG] Applying persistent QC in p_i. Filtering 157/18423 samples
2025-09-30 09:19:21,126 [DEBUG] Applying persistent QC in p_u. Filtering 0/18423 samples
2025-09-30 09:19:21,136 [DEBUG] Applying persistent QC in gps_lat_lon. Filtering 0/18423 samples
2025-09-30 09:19:21,140 [DEBUG] Applying persistent QC in gps_alt. Filtering 0/18423 samples
2025-09-30 09:19:21,143 [DEBUG] Applying persistent QC in t_rad. Filtering 6/18423 samples
2025-09-30 09:19:21,146 [DEBUG] Applying persistent QC in rh_i. Filtering 78/18423 samples
2025-09-30 09:19:21,154 [DEBUG] Applying persistent QC in rh_u. Filtering 72/18423 samples
2025-09-30 09:19:21,160 [DEBUG] Applying persistent QC in wspd_i. Filtering 68/18423 samples
2025-09-30 09:19:21,167 [DEBUG] Applying persistent QC in wspd_u. Filtering 66/18423 samples
2025-09-30 09:19:21,582 [INFO] Resampling to 60min
2025-09-30 09:19:21,676 [INFO] Writing to files...
2025-09-30 09:19:22,412 [INFO] Written to L2_test/tx/KAN_Lv3/KAN_Lv3_hour.csv
2025-09-30 09:19:22,413 [INFO] Written to L2_test/tx/KAN_Lv3/KAN_Lv3_hour.nc
2025-09-30 09:19:22,413 [INFO] AWS(config_file=../aws-l0//raw/config/KAN_Lv3.toml, inpath=../aws-l0//raw/KAN_Lv3/, data_issues_repository=../PROMICE-AWS-data-issues, var_file=None, meta_file=None)
2025-09-30 09:19:22,804 [DEBUG] Source information: {'pypromice': '1.5.1', 'l0_config_file': 'KAN_Lv3.toml:016a28db7b1c6dc223642f5fa4e0a0249a3cdac3', 'l0_data_root': '016a28db7b1c6dc223642f5fa4e0a0249a3cdac3', 'data_issues': 'd1389d62adb1864056bb11f559d4785105b56943'}
2025-09-30 09:19:22,817 [INFO] Detected L0 file type 'toa5' for ../aws-l0/raw/KAN_Lv3/KAN_Lv3_2024_raw.txt
2025-09-30 09:19:22,951 [INFO] Detected L0 file type 'toa5' for ../aws-l0/raw/KAN_Lv3/KAN_Lv3_2024_raw.txt
2025-09-30 09:19:23,155 [INFO] L0 data successfully loaded from KAN_Lv3_2024_raw.txt
2025-09-30 09:19:23,160 [INFO] Level 1 processing...
2025-09-30 09:19:23,289 [WARNING] bedrock attribute is not set
2025-09-30 09:19:23,389 [INFO] Level 2 processing...
2025-09-30 09:19:23,392 [INFO] Using file: ../PROMICE-AWS-data-issues/adjustments/KAN_Lv3.csv
2025-09-30 09:19:23,396 [INFO] Using file: ../PROMICE-AWS-data-issues/flags/KAN_Lv3.csv
2025-09-30 09:19:23,400 [DEBUG] ---> flagging 2023-08-22T13:40:00.000000000 2025-05-01 16:00:00 z_pt_cor
2025-09-30 09:19:23,404 [INFO] Using file: ../PROMICE-AWS-data-issues/adjustments/KAN_Lv3.csv
2025-09-30 09:19:23,411 [DEBUG] ---> None None gps_alt min_filter 600.0
2025-09-30 09:19:23,412 [DEBUG] ---> None None z_boom_u max_filter 2.635
2025-09-30 09:19:23,415 [DEBUG] ---> None 2024-02-01 00:00:00 z_boom_u min_filter 2.46
2025-09-30 09:19:23,415 [INFO] could not adjust z_ice_surf not in dataset
2025-09-30 09:19:23,416 [INFO] could not adjust z_surf_2 not in dataset
2025-09-30 09:19:23,422 [DEBUG] Running persistence_qc using {'t_i': {'max_diff': 0.0001, 'period': 2}, 't_u': {'max_diff': 0.0001, 'period': 2}, 't_l': {'max_diff': 0.0001, 'period': 2}, 'p_i': {'max_diff': 0.0001, 'period': 3}, 'p_u': {'max_diff': 0.0001, 'period': 150}, 'p_l': {'max_diff': 0.0001, 'period': 150}, 'gps_lat_lon': {'max_diff': 1e-06, 'period': 6}, 'gps_alt': {'max_diff': 0.0001, 'period': 6}, 't_rad': {'max_diff': 0.0001, 'period': 2}, 'rh_i': {'max_diff': 0.0001, 'period': 2}, 'rh_u': {'max_diff': 0.0001, 'period': 2}, 'rh_l': {'max_diff': 0.0001, 'period': 2}, 'wspd_i': {'max_diff': 0.0001, 'period': 6}, 'wspd_u': {'max_diff': 0.0001, 'period': 6}, 'wspd_l': {'max_diff': 0.0001, 'period': 6}}
2025-09-30 09:19:23,427 [DEBUG] Applying persistent QC in t_i. Filtering 0/53281 samples
2025-09-30 09:19:23,431 [DEBUG] Applying persistent QC in t_u. Filtering 72/53281 samples
2025-09-30 09:19:23,435 [DEBUG] Applying persistent QC in p_i. Filtering 0/53281 samples
2025-09-30 09:19:23,514 [DEBUG] Applying persistent QC in p_u. Filtering 0/53281 samples
2025-09-30 09:19:23,525 [DEBUG] Applying persistent QC in gps_lat_lon. Filtering 0/53281 samples
2025-09-30 09:19:23,531 [DEBUG] Applying persistent QC in gps_alt. Filtering 0/53281 samples
2025-09-30 09:19:23,535 [DEBUG] Applying persistent QC in t_rad. Filtering 0/53281 samples
2025-09-30 09:19:23,539 [DEBUG] Applying persistent QC in rh_i. Filtering 0/53281 samples
2025-09-30 09:19:23,542 [DEBUG] Applying persistent QC in rh_u. Filtering 6/53281 samples
2025-09-30 09:19:23,548 [DEBUG] Applying persistent QC in wspd_i. Filtering 0/53281 samples
2025-09-30 09:19:23,553 [DEBUG] Applying persistent QC in wspd_u. Filtering 184/53281 samples
2025-09-30 09:19:23,974 [INFO] Resampling to 10min
2025-09-30 09:19:24,061 [INFO] Writing to files...
2025-09-30 09:19:25,661 [INFO] Written to L2_test/raw/KAN_Lv3/KAN_Lv3_10min.csv
2025-09-30 09:19:25,661 [INFO] Written to L2_test/raw/KAN_Lv3/KAN_Lv3_10min.nc
2025-09-30 09:19:25,786 [INFO] Resampling to 60min
2025-09-30 09:19:25,848 [INFO] Writing to files...
2025-09-30 09:19:26,209 [INFO] Written to L2_test/raw/KAN_Lv3/KAN_Lv3_hour.csv
2025-09-30 09:19:26,210 [INFO] Written to L2_test/raw/KAN_Lv3/KAN_Lv3_hour.nc
2025-09-30 09:19:26,254 [DEBUG] Could not import boto3, continuing with reduced functionality.
2025-09-30 09:19:26,254 [DEBUG] GDAL data found in package: path='/home/bav/miniforge3/lib/python3.12/site-packages/rasterio/gdal_data'.
2025-09-30 09:19:26,254 [DEBUG] PROJ data found in package: path='/home/bav/miniforge3/lib/python3.12/site-packages/rasterio/proj_data'.
2025-09-30 09:19:26,340 [INFO] KAN_Lv3 array loaded from L2_test/raw/KAN_Lv3/KAN_Lv3_hour.nc
2025-09-30 09:19:26,369 [INFO] KAN_Lv3 array loaded from L2_test/tx/KAN_Lv3/KAN_Lv3_hour.nc
2025-09-30 09:19:26,369 [INFO] Combining L2_test/raw/KAN_Lv3/KAN_Lv3_hour.nc with L2_test/tx/KAN_Lv3/KAN_Lv3_hour.nc...
2025-09-30 09:19:26,456 [INFO] Writing to files...
2025-09-30 09:19:27,070 [INFO] Written to L2_test/level_2/KAN_Lv3/KAN_Lv3_hour.csv
2025-09-30 09:19:27,070 [INFO] Written to L2_test/level_2/KAN_Lv3/KAN_Lv3_hour.nc
2025-09-30 09:19:27,070 [INFO] Files saved to L2_test/level_2/KAN_Lv3...
2025-09-30 09:19:27,110 [WARNING] data_issues_path is missing. Using default data issues path: ../PROMICE-AWS-data-issues
2025-09-30 09:19:28,768 [INFO] processing gps_lat without relocation
2025-09-30 09:19:28,771 [INFO] processing gps_lon without relocation
2025-09-30 09:19:28,774 [INFO] processing gps_alt without relocation
2025-09-30 09:19:28,787 [INFO] Using file: ../PROMICE-AWS-data-issues/adjustments/KAN_Lv3.csv
2025-09-30 09:19:28,796 [DEBUG] ---> 2023-08-25 15:00:00 None z_ice_surf add 14.0
2025-09-30 09:19:28,798 [DEBUG] ---> 2025-08-25 15:00:00 None z_ice_surf add -2.7
2025-09-30 09:19:28,799 [DEBUG] ---> 2024-08-23 13:00:00 None z_surf_2 add -2.16
2025-09-30 09:19:28,801 [DEBUG] ---> 2025-08-25 15:00:00 None z_surf_2 add -3.0
2025-09-30 09:19:28,802 [INFO] Combining surface height
2025-09-30 09:19:28,802 [INFO] -> ablation site
2025-09-30 09:19:28,876 [DEBUG] -> estimating ablation period for each year
2025-09-30 09:19:28,877 [DEBUG] 2023 no z_ice_surf, just using JJA
2025-09-30 09:19:28,879 [DEBUG] 2024 no z_ice_surf, just using JJA
2025-09-30 09:19:28,880 [DEBUG] 2025 derived from z_ice_surf
2025-09-30 09:19:28,880 [DEBUG] 2023: Ablation from 2023-08-22 13:00:00 to 2023-08-31 23:00:00
2025-09-30 09:19:28,887 [DEBUG] adjusting hs1
2025-09-30 09:19:28,888 [DEBUG] to hs2, minimizing winter difference
2025-09-30 09:19:28,889 [DEBUG] 2024: Ablation from 2024-06-01 00:00:00 to 2024-08-31 23:00:00
2025-09-30 09:19:28,896 [DEBUG] adjusting hs1
2025-09-30 09:19:28,896 [DEBUG] to hs2, minimizing winter difference
2025-09-30 09:19:28,897 [DEBUG] 2025: Ablation from 2025-06-04 00:00:00 to 2025-09-20 18:00:00
2025-09-30 09:19:28,902 [DEBUG] adjusting z to hs1
2025-09-30 09:19:28,902 [DEBUG] adjusting hs2 to z
2025-09-30 09:19:28,903 [DEBUG] using end of melt season
2025-09-30 09:19:28,905 [DEBUG] adjusting hs1
2025-09-30 09:19:28,905 [DEBUG] to hs2, minimizing winter difference
2025-09-30 09:19:28,919 [INFO] surface height combination finished
2025-09-30 09:19:28,946 [INFO] Calculating thermistor depth
2025-09-30 09:19:28,951 [INFO] No maintenance at KAN_Lv3
2025-09-30 09:19:28,960 [INFO] interpolating 10 m firn/ice temperature (on hourly values)
2025-09-30 09:19:30,626 [INFO] Resampling to 60min
2025-09-30 09:19:30,717 [INFO] Writing to files...
2025-09-30 09:19:31,374 [INFO] Written to L3_test/stations/KAN_Lv3/KAN_Lv3_hour.csv
2025-09-30 09:19:31,374 [INFO] Written to L3_test/stations/KAN_Lv3/KAN_Lv3_hour.nc
2025-09-30 09:19:31,427 [INFO] Resampling to 1D
2025-09-30 09:19:31,508 [INFO] Writing to files...
2025-09-30 09:19:31,592 [INFO] Written to L3_test/stations/KAN_Lv3/KAN_Lv3_day.csv
2025-09-30 09:19:31,592 [INFO] Written to L3_test/stations/KAN_Lv3/KAN_Lv3_day.nc
2025-09-30 09:19:31,638 [INFO] Resampling to ME
2025-09-30 09:19:31,716 [INFO] Writing to files...
2025-09-30 09:19:31,772 [INFO] Written to L3_test/stations/KAN_Lv3/KAN_Lv3_month.csv
2025-09-30 09:19:31,772 [INFO] Written to L3_test/stations/KAN_Lv3/KAN_Lv3_month.nc
/n ======== test join_l3 ========= 

KAN_Lv3

 ======== test get_l2 ========= 


 ======== test join_l2 ========= 


 ======== test l2tol3 ========= 

